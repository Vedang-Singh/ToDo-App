(window.webpackJsonp=window.webpackJsonp||[]).push([[101],{"./bundles/treemap.js":function(e,t,i){"use strict";i.r(t);var r=i("../node_modules/@babel/runtime/helpers/typeof.js"),o=i.n(r);window.sf=window.sf||{};sfBlazor.modules.treemap="treemap.TreeMap",sfBlazor.loadDependencies(sfBlazor.dependencyJson.treemap,(function(){sf.treemap=sf.base.extend({},sf.treemap,function(e){var t,i="Roboto, Segoe UI, Noto, Sans-serif",r=(t=function(e,i){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,i)},function(e,i){function r(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}),l=function(e,t,i,r){var l,n=arguments.length,a=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"===("undefined"==typeof Reflect?"undefined":o()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,r);else for(var s=e.length-1;s>=0;s--)(l=e[s])&&(a=(n<3?l(a):n>3?l(t,i,a):l(t,i))||a);return n>3&&a&&Object.defineProperty(t,i,a),a},n=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),l([sf.base.Property("#808080")],t.prototype,"color",void 0),l([sf.base.Property(0)],t.prototype,"width",void 0),t}(sf.base.ChildProperty),a=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),l([sf.base.Property(10)],t.prototype,"left",void 0),l([sf.base.Property(10)],t.prototype,"right",void 0),l([sf.base.Property(10)],t.prototype,"top",void 0),l([sf.base.Property(10)],t.prototype,"bottom",void 0),t}(sf.base.ChildProperty),s=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),l([sf.base.Property(null)],t.prototype,"size",void 0),l([sf.base.Property(null)],t.prototype,"color",void 0),l([sf.base.Property(i)],t.prototype,"fontFamily",void 0),l([sf.base.Property("Normal")],t.prototype,"fontWeight",void 0),l([sf.base.Property("Normal")],t.prototype,"fontStyle",void 0),l([sf.base.Property(1)],t.prototype,"opacity",void 0),t}(sf.base.ChildProperty),h=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),l([sf.base.Property("")],t.prototype,"text",void 0),l([sf.base.Property("")],t.prototype,"description",void 0),t}(sf.base.ChildProperty),d=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),l([sf.base.Complex({size:"14px"},s)],t.prototype,"textStyle",void 0),l([sf.base.Property("Center")],t.prototype,"alignment",void 0),t}(h),p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),l([sf.base.Complex({size:"15px"},s)],t.prototype,"textStyle",void 0),l([sf.base.Property("Center")],t.prototype,"alignment",void 0),l([sf.base.Complex({},d)],t.prototype,"subtitleSettings",void 0),t}(h),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),l([sf.base.Property(null)],t.prototype,"from",void 0),l([sf.base.Property(null)],t.prototype,"to",void 0),l([sf.base.Property(null)],t.prototype,"color",void 0),l([sf.base.Property(null)],t.prototype,"label",void 0),l([sf.base.Property(null)],t.prototype,"value",void 0),l([sf.base.Property(null)],t.prototype,"minOpacity",void 0),l([sf.base.Property(null)],t.prototype,"maxOpacity",void 0),l([sf.base.Property(!0)],t.prototype,"showLegend",void 0),t}(sf.base.ChildProperty),g=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),l([sf.base.Property(!1)],t.prototype,"visible",void 0),l([sf.base.Property("Default")],t.prototype,"mode",void 0),l([sf.base.Property("transparent")],t.prototype,"background",void 0),l([sf.base.Property("Circle")],t.prototype,"shape",void 0),l([sf.base.Property("")],t.prototype,"width",void 0),l([sf.base.Property("")],t.prototype,"height",void 0),l([sf.base.Complex({size:"13px"},s)],t.prototype,"textStyle",void 0),l([sf.base.Property(null)],t.prototype,"fill",void 0),l([sf.base.Property(1)],t.prototype,"opacity",void 0),l([sf.base.Property(15)],t.prototype,"shapeWidth",void 0),l([sf.base.Property(15)],t.prototype,"shapeHeight",void 0),l([sf.base.Property(10)],t.prototype,"shapePadding",void 0),l([sf.base.Property(null)],t.prototype,"imageUrl",void 0),l([sf.base.Complex({color:"#000000",width:0},n)],t.prototype,"border",void 0),l([sf.base.Complex({color:"#000000",width:0},n)],t.prototype,"shapeBorder",void 0),l([sf.base.Complex({},h)],t.prototype,"title",void 0),l([sf.base.Complex({size:"14px"},s)],t.prototype,"titleStyle",void 0),l([sf.base.Property("Bottom")],t.prototype,"position",void 0),l([sf.base.Property("None")],t.prototype,"orientation",void 0),l([sf.base.Property(!1)],t.prototype,"invertedPointer",void 0),l([sf.base.Property("After")],t.prototype,"labelPosition",void 0),l([sf.base.Property("None")],t.prototype,"labelDisplayMode",void 0),l([sf.base.Property("Center")],t.prototype,"alignment",void 0),l([sf.base.Property({x:0,y:0})],t.prototype,"location",void 0),l([sf.base.Property(null)],t.prototype,"showLegendPath",void 0),l([sf.base.Property(null)],t.prototype,"valuePath",void 0),l([sf.base.Property(!1)],t.prototype,"removeDuplicateLegend",void 0),t}(sf.base.ChildProperty),m=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),l([sf.base.Property(null)],t.prototype,"groupIndex",void 0),l([sf.base.Property(null)],t.prototype,"groupName",void 0),t}(sf.base.ChildProperty),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),l([sf.base.Property(null)],t.prototype,"fill",void 0),l([sf.base.Property(!1)],t.prototype,"autoFill",void 0),l([sf.base.Complex({},n)],t.prototype,"border",void 0),l([sf.base.Property(0)],t.prototype,"gap",void 0),l([sf.base.Property(10)],t.prototype,"padding",void 0),l([sf.base.Property(1)],t.prototype,"opacity",void 0),l([sf.base.Property(!0)],t.prototype,"showLabels",void 0),l([sf.base.Property(null)],t.prototype,"labelPath",void 0),l([sf.base.Property(null)],t.prototype,"labelFormat",void 0),l([sf.base.Property("TopLeft")],t.prototype,"labelPosition",void 0),l([sf.base.Complex({color:null,size:"12px"},s)],t.prototype,"labelStyle",void 0),l([sf.base.Property(null)],t.prototype,"labelTemplate",void 0),l([sf.base.Property("Center")],t.prototype,"templatePosition",void 0),l([sf.base.Property("Trim")],t.prototype,"interSectAction",void 0),l([sf.base.Collection([],c)],t.prototype,"colorMapping",void 0),t}(sf.base.ChildProperty),f=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),l([sf.base.Property(!1)],t.prototype,"visible",void 0),l([sf.base.Property("")],t.prototype,"template",void 0),l([sf.base.Property(null)],t.prototype,"format",void 0),l([sf.base.Property("#000816")],t.prototype,"fill",void 0),l([sf.base.Property(.75)],t.prototype,"opacity",void 0),l([sf.base.Property(["Circle"])],t.prototype,"markerShapes",void 0),l([sf.base.Complex({},n)],t.prototype,"border",void 0),l([sf.base.Complex({fontFamily:i,size:"13px"},s)],t.prototype,"textStyle",void 0),t}(sf.base.ChildProperty),y=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),l([sf.base.Property(!1)],t.prototype,"enable",void 0),l([sf.base.Property(null)],t.prototype,"fill",void 0),l([sf.base.Property("0.5")],t.prototype,"opacity",void 0),l([sf.base.Complex({},n)],t.prototype,"border",void 0),l([sf.base.Property("Item")],t.prototype,"mode",void 0),t}(sf.base.ChildProperty),v=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),l([sf.base.Property(!1)],t.prototype,"enable",void 0),l([sf.base.Property("#808080")],t.prototype,"fill",void 0),l([sf.base.Property("0.5")],t.prototype,"opacity",void 0),l([sf.base.Complex({},n)],t.prototype,"border",void 0),l([sf.base.Property("Item")],t.prototype,"mode",void 0),t}(sf.base.ChildProperty),b=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return r(t,e),l([sf.base.Property(null)],t.prototype,"groupPath",void 0),l([sf.base.Property(0)],t.prototype,"groupGap",void 0),l([sf.base.Property(10)],t.prototype,"groupPadding",void 0),l([sf.base.Complex({},n)],t.prototype,"border",void 0),l([sf.base.Property(null)],t.prototype,"fill",void 0),l([sf.base.Property(!1)],t.prototype,"autoFill",void 0),l([sf.base.Property(1)],t.prototype,"opacity",void 0),l([sf.base.Property(!0)],t.prototype,"showHeader",void 0),l([sf.base.Property(20)],t.prototype,"headerHeight",void 0),l([sf.base.Property(null)],t.prototype,"headerTemplate",void 0),l([sf.base.Property(null)],t.prototype,"headerFormat",void 0),l([sf.base.Property("Near")],t.prototype,"headerAlignment",void 0),l([sf.base.Complex({color:null,size:"13px"},s)],t.prototype,"headerStyle",void 0),l([sf.base.Property("TopLeft")],t.prototype,"templatePosition",void 0),l([sf.base.Collection([],c)],t.prototype,"colorMapping",void 0),t}(sf.base.ChildProperty),x=function(e,t){this.width=e,this.height=t};function w(e,t){return null!=e?-1!==e.indexOf("%")?t/100*parseInt(e,10):parseInt(e,10):null}var S=function(e,t,i,r){this.x=e,this.y=t,this.width=i,this.height=r},I=function(e,t,i,r,o,l){this.y=o.y,this.x=o.x,this.height=o.height,this.width=o.width,this.id=e,this.fill=t,this.opacity=r,this.stroke=i.color,this["stroke-width"]=i.width,this["stroke-dasharray"]=l},O=function(e,t,i,r,o,l,n){this.id=e,this.opacity=o,this.fill=t,this.stroke=r,this["stroke-width"]=i,this["stroke-dasharray"]=l,this.d=n};function C(e,t){var i=document.getElementById("treeMapMeasureText");return null===i&&(i=sf.base.createElement("text",{id:"treeMapMeasureText"}),document.body.appendChild(i)),i.innerHTML=e,i.style.position="absolute",i.style.fontSize=t.size,i.style.fontWeight=t.fontWeight,i.style.fontStyle=t.fontStyle,i.style.fontFamily=t.fontFamily,i.style.visibility="hidden",i.style.top="-100",i.style.left="0",i.style.whiteSpace="nowrap",i.style.lineHeight="normal",new x(i.clientWidth,i.clientHeight)}var L=function(e,t,i,r,o,l,n,a){void 0===l&&(l=""),this.transform="",this.baseLine="auto",this.id=e,this.text=o,this.transform=l,this.anchor=r,this.x=t,this.y=i,this.baseLine=n,this.connectorText=a};function P(e,t,i){var r=t,o=C(t,i).width;if(o>e)for(var l=t.length-1;l>=0;--l)if((o=C(r=t.substring(0,l)+"...",i).width)<=e||r.length<4)return r.length<4&&(r=" "),r;return r}var M=function(e,t){this.x=e,this.y=t};function N(e,t,i,r){var o,l;switch(t){case"Near":o=e.x;break;case"Center":o="title"===r?e.width/2-i.width/2:e.x+e.width/2-i.width/2;break;case"Far":o="title"===r?e.width-e.y-i.width:e.x+e.width-i.width}return l="title"===r?e.y+i.height/2:e.y+e.height/2+i.height/2,new M(o,l)}function T(e,t,i){var r;return(r=e.createText(t,i)).setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve"),r.style["user-select"]="none",r.style["-moz-user-select"]="none",r.style["-webkit-touch-callout"]="none",r.style["-webkit-user-select"]="none",r.style["-khtml-user-select"]="none",r.style["-ms-user-select"]="none",r.style["-o-user-select"]="none",r}function E(e,t,i,r,o){void 0===o&&(o=!1);var l,n,a,s={"font-size":t.size,"font-style":t.fontStyle,"font-family":t.fontFamily,"font-weight":t.fontWeight,"text-anchor":e.anchor,transform:e.transform,opacity:t.opacity,"dominant-baseline":e.baseLine,id:e.id,x:e.x,y:e.y,fill:i},h="string"==typeof e.text?e.text:o?e.text[e.text.length-1]:e.text[0],d=new sf.svgbase.SvgRenderer("");if(!sf.base.isNullOrUndefined(h)&&!sf.base.isNullOrUndefined(e.connectorText)&&h.search(e.connectorText[1])>=0){var p=void 0;p=h.split("#");for(var c=0;c<p.length;c++){var g=-1===p[c].search(e.connectorText)||sf.base.isNullOrUndefined(e.connectorText)?p[c]:e.connectorText;if(s.id=e.id+"_"+c,a=T(d,s,g),c%2==0&&0!==c){g=g.replace(/\s+/g,"&nbsp")}var m=C(g,t);s.x=0!==c?s.x+m.width:s.x+m.width+5,r.appendChild(a)}}else a=T(d,s,h),r.appendChild(a);if("string"!=typeof e.text&&e.text.length>1){for(var u=1,f=e.text.length;u<f;u++)n=C(e.text[u],t).height,l=d.createTSpan({x:e.x,id:e.id,y:e.y+u*n},e.text[u]),a.appendChild(l);r.appendChild(a)}return a}function D(e){return document.getElementById(e)}function _(e,t){return e.weight===t.weight?0:e.weight<t.weight?1:-1}function B(e,t,i,r){for(var o,l=!1,n="",a=r.leafItemSettings,s=0;s<e.length;s++)if(o=r.levels[s]?r.levels[s].groupPath:a.labelPath?a.labelPath:r.weightValuePath,e[s]===i[o]&&(n+=i[o]+(s===e.length-1?"":"#"))===t){l=!0;break}return l}function R(e){var t;if(e){var i=Object.keys(e);t=new Object;for(var r=0;r<i.length;r++)if(e[i[r]]instanceof Array){t.values=e[i[r]],t.key=i[r];break}}return t}function F(e,t,i,r){if("Child"===i){t.push(e.levelOrderName);var o=R(e).values;if(o&&o.length>0){for(var l=0;l<o.length;l++)-1===t.indexOf(o[l].levelOrderName)&&t.push(o[l].levelOrderName);for(var n=0;n<o.length;n++)F(o[n],t,i,r)}}else if("Parent"===i)"string"==typeof e.levelOrderName&&-1===t.indexOf(e.levelOrderName)&&(t.push(e.levelOrderName),F(e.parent,t,i,r));else if("All"===i){var a=e.levelOrderName.split("#")[0],s=void 0;for(l=0;l<r.layout.renderItems.length;l++)(s=r.layout.renderItems[l]).levelOrderName.indexOf(a)>-1&&-1===t.indexOf(s.levelOrderName)&&t.push(s.levelOrderName)}else t.push(e.levelOrderName);return t}function H(e){var t=null;try{document.querySelectorAll(e).length&&(t=sf.base.compile(document.querySelector(e).innerHTML.trim()))}catch(i){t=sf.base.compile(e)}return t}function z(e,t,i){for(var r=sf.base.createElement("div",{id:t,styles:"position: absolute;pointer-events: auto;"}),o=e.length;o>0;)r.appendChild(e[0]),o--;for(var l=r.innerHTML,n=Object.keys(i),a=0;a<n.length;a++)l=l.replace(new RegExp("{{:"+n[a]+"}}","g"),i[n[a].toString()]);return r.innerHTML=l,r}function U(e,t,i,r,o){var l=new M(0,0),n=(o.element.getBoundingClientRect(),"Template"===r?o.areaRect.x:0),a="Template"===r?o.areaRect.y:0;return l.x=Math.abs(n-(t.indexOf("Left")>-1?e.x+5:t.indexOf("Right")>-1?e.x+e.width-i.width:e.x+(e.width/2-i.width/2)))-2,!o.enableDrillDown||"BottomLeftTopRight"!==o.renderDirection&&"BottomRightTopLeft"!==o.renderDirection?l.y=Math.abs(a-(t.indexOf("Top")>-1?"Template"===r?e.y:e.y+i.height:t.indexOf("Bottom")>-1?e.y+e.height-i.height:"Template"===r?e.y+(e.height/2-i.height/2):e.y+e.height/2+i.height/4)):l.y=Math.abs(e.y+e.height-i.height+5),l}function A(e,t){var i=new x(0,0);t.appendChild(e),i.height=e.offsetHeight,i.width=e.offsetWidth;var r=document.getElementById(e.id);return r.parentNode.removeChild(r),i}function k(e){return(e.width-e.x)*(e.height-e.y)}function j(e){var t=G(e),i=t.width,r=t.height;return Math.min(i,r)}function G(e){var t=e.x,i=e.y;return{x:t,y:i,width:e.width-t,height:e.height-i}}function V(e){var t=e.x,i=e.y;return{x:t,y:i,width:t+e.width,height:i+e.height}}function W(e,t,i){var r=i.getBoundingClientRect(),o=i.ownerDocument.defaultView.pageXOffset,l=i.ownerDocument.defaultView.pageYOffset,n=i.ownerDocument.documentElement.clientTop,a=i.ownerDocument.documentElement.clientLeft,s=r.left+o-a,h=r.top+l-n;return new M(e-s,t-h)}function q(e,t,i,r){var o,l,n=[];if(sf.base.isNullOrUndefined(t)&&sf.base.isNullOrUndefined(i)&&isNaN(i))return null;for(var a=0;a<e.length;a++){var s=!1,h=i;sf.base.isNullOrUndefined(e[a].from)||sf.base.isNullOrUndefined(e[a].to)||sf.base.isNullOrUndefined(e[a].value)?(sf.base.isNullOrUndefined(e[a].from)||sf.base.isNullOrUndefined(e[a].to))&&sf.base.isNullOrUndefined(e[a].value)||(i>=e[a].from&&e[a].to>=i||e[a].value===t)&&(e[a].value===t&&(s=!0),o="[object Array]"===Object.prototype.toString.call(e[a].color)?s?e[a].color[0]:X(e[a],h):e[a].color):i>=e[a].from&&e[a].to>=i&&e[a].value===t&&(s=!0,o="[object Array]"===Object.prototype.toString.call(e[a].color)?s?e[a].color[0]:X(e[a],h):e[a].color),(i>=e[a].from&&i<=e[a].to||e[a].value===t)&&!sf.base.isNullOrUndefined(e[a].minOpacity)&&!sf.base.isNullOrUndefined(e[a].maxOpacity)&&o&&(l=J(r,e[a],o,i)),(""===o||sf.base.isNullOrUndefined(o))&&sf.base.isNullOrUndefined(e[a].from)&&sf.base.isNullOrUndefined(e[a].to)&&sf.base.isNullOrUndefined(e[a].minOpacity)&&sf.base.isNullOrUndefined(e[a].maxOpacity)&&sf.base.isNullOrUndefined(e[a].value)&&(o="[object Array]"===Object.prototype.toString.call(e[a].color)?e[a].color[0]:e[a].color),l=sf.base.isNullOrUndefined(l)?"1":l,n.push(o)}for(var d=n.length-1;d>=0;d--)d=(o=n[d])?-1:d;return{fill:o,opacity:l}}function J(e,t,i,r){var o=1;r>=t.from&&r<=t.to&&(o=(r-t.from)/(t.to-t.from)*(t.maxOpacity-t.minOpacity)+t.minOpacity);return o.toString()}function X(e,t){return Z(e,t)}function Y(e,t,i){return"#"+ce(e)+ce(t)+ce(i)}function Z(e,t){var i;return Number(t)===e.from?e.color[0]:Number(t)===e.to?e.color[e.color.length-1]:Y((i=Q(Number(t),e)).r,i.g,i.b)}function Q(e,t){var i,r,o=t.from,l=t.to,n=0,a=l-o;if(n=(e-o)/a,t.color.length<=2)i="#"===t.color[0].charAt(0)?t.color[0]:me(t.color[0]),r="#"===t.color[t.color.length-1].charAt(0)?t.color[t.color.length-1]:me(t.color[t.color.length-1]);else{i="#"===t.color[0].charAt(0)?t.color[0]:me(t.color[0]),r="#"===t.color[t.color.length-1].charAt(0)?t.color[t.color.length-1]:me(t.color[t.color.length-1]);for(var s=a/(t.color.length-1),h=t.color.length-1,d=[],p={},c=1;c<h;c++)p={b:o+c*s,color:t.color[c]},d.push(p);for(var g=0;g<d.length;g++)o<=e&&e<=d[g].b&&0===g?(r="#"===d[g].color.charAt(0)?d[g].color:me(d[g].color),n=e<d[g].b?1-Math.abs((e-d[g].b)/s):(e-d[g].b)/s):d[g].b<=e&&e<=l&&g===d.length-1&&(i="#"===d[g].color.charAt(0)?d[g].color:me(d[g].color),n=e<d[g].b?1-Math.abs((e-d[g].b)/s):(e-d[g].b)/s),g!==d.length-1&&g<d.length&&d[g].b<=e&&e<=d[g+1].b&&(i="#"===d[g].color.charAt(0)?d[g].color:me(d[g].color),r="#"===d[g+1].color.charAt(0)?d[g+1].color:me(d[g+1].color),n=Math.abs(e-d[g+1].b)/s)}return $(n,i,r)}function $(e,t,i){var r=i.split("#")[1],o=t.split("#")[1],l=K(e,parseInt(o.substr(0,2),16),parseInt(r.substr(0,2),16)),n=K(e,parseInt(o.substr(2,2),16),parseInt(r.substr(2,2),16)),a=K(e,parseInt(o.substr(4,2),16),parseInt(r.substr(4,2),16));return new de(l,n,a)}function K(e,t,i){var r=i-t;return Math.round(t+r*e)}function ee(e,t,i){for(var r,o=t.split(" "),l="",n=[],a=0,s=o.length;a<s;a++)r=o[a],C(l.concat(r),i).width<e?l=l.concat((""===l?"":" ")+r):""!==l?(n.push(P(e,l,i)),l=r):(n.push(P(e,r,i)),r=""),l&&a===s-1&&n.push(P(e,l,i));return n}function te(e,t,i){var r=[],o=0,l=C(t,i).width,n=t.length;if(e>=l)return r.push(t),r;for(var a=t.length;a>o;a--){var s=t.slice(o,a);if((l=C(s,i).width)<=e){if(r.push(s),n===(o+=s.length))return r;a=n+1}}return r}function ie(e,t,i,r){var o=C(i,r);return o.width>e||o.height>t?" ":i}function re(e,t){return e.itemArea===t.itemArea?0:e.itemArea<t.itemArea?1:-1}function oe(e,t,i){var r=e.levelSelection;if(r)for(var o=0;o<r.length;o++)t.getAttribute("id")===r[o]?t.childElementCount>0&&(t.children[0].setAttribute("class",i),ae(t.childNodes[0],{border:e.selectionSettings.border,fill:e.selectionSettings.fill,opacity:e.selectionSettings.opacity})):t.setAttribute("class","")}function le(e,t){var i=e.legendId;if(i)for(var r=0;r<i.length;r++)for(var o=0;o<t.childElementCount;o++)t.childNodes[o].id===i[r]&&(t.childNodes[o].setAttribute("fill",e.selectionSettings.fill),t.childNodes[o].setAttribute("stroke",e.selectionSettings.border.color),t.childNodes[o].setAttribute("stroke-width",e.selectionSettings.border.width.toString()),t.childNodes[o].setAttribute("opacity",e.selectionSettings.opacity))}function ne(e,t,i){for(var r,o={},l=0;l<e.length;l++)r=sf.base.isNullOrUndefined(e[l].childNodes[0])?e[l]:e[l].childNodes[0],o=i.layout.renderItems[r.id.split("_")[6]].options,ae(r,o),e[l].classList.remove(t),l-=1}function ae(e,t){e.setAttribute("opacity",t.opacity),sf.base.isNullOrUndefined(t.fill)||e.setAttribute("fill",t.fill),e.setAttribute("stroke",t.border.color),e.setAttribute("stroke-width",t.border.width)}function se(e,t,i){if(sf.base.isNullOrUndefined(e))return null;for(var r=0,o=Object.keys(t);r<o.length;r++){var l=o[r];e=e.split("${"+l+"}").join(he(t[l],i).toString())}return e}function he(e,t){return(t.format&&!isNaN(Number(e))?t.intl.getNumberFormat({format:t.format,useGrouping:t.useGroupingSeparator})(Number(e)):e)||""}var de=function(e,t,i){this.r=e,this.g=t,this.b=i};function pe(e){return"#"+ce(e.r)+ce(e.g)+ce(e.b)}function ce(e){var t=e.toString(16);return 1===t.length?"0"+t:t}function ge(e){var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?new de(parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)):new de(255,255,255)}function me(e){var t;e="transparent"===e?"white":e,(t=document.getElementById("treeMapMeasureText")).style.color=e,e=window.getComputedStyle(t).color;var i=/^(rgb|hsl)(a?)[(]\s*([\d.]+\s*%?)\s*,\s*([\d.]+\s*%?)\s*,\s*([\d.]+\s*%?)\s*(?:,\s*([\d.]+)\s*)?[)]$/.exec(e);return pe(new de(parseInt(i[3],10),parseInt(i[4],10),parseInt(i[5],10)))}function ue(e,t,i,r,o,l){var n=new sf.svgbase.SvgRenderer(""),a=fe(e,i,t,o,r),s=n["draw"+a.functionName](a.renderOption);return s.setAttribute("aria-label",l),s}function fe(e,t,i,r,o){var l,n="Path",a=t.width,s=t.height,h=e.x,d=e.y,p=e.x+-a/2,c=e.y+-s/2;switch(i){case"Circle":case"Bubble":n="Ellipse",sf.base.merge(r,{rx:a/2,ry:s/2,cx:h,cy:d});break;case"VerticalLine":l="M "+h+" "+(d+s/2)+" L "+h+" "+(d+-s/2),sf.base.merge(r,{d:l});break;case"Diamond":l="M "+p+" "+d+" L "+h+" "+(d+-s/2)+" L "+(h+a/2)+" "+d+" L "+h+" "+(d+s/2)+" L "+p+" "+d+" z",sf.base.merge(r,{d:l});break;case"Rectangle":l="M "+p+" "+(d+-s/2)+" L "+(h+a/2)+" "+(d+-s/2)+" L "+(h+a/2)+" "+(d+s/2)+" L "+p+" "+(d+s/2)+" L "+p+" "+(d+-s/2)+" z",sf.base.merge(r,{d:l});break;case"Triangle":l="M "+p+" "+(d+s/2)+" L "+h+" "+(d+-s/2)+" L "+(h+a/2)+" "+(d+s/2)+" L "+p+" "+(d+s/2)+" z",sf.base.merge(r,{d:l});break;case"InvertedTriangle":l="M "+(h+a/2)+" "+(d-s/2)+" L "+h+" "+(d+s/2)+" L "+(h-a/2)+" "+(d-s/2)+" L "+(h+a/2)+" "+(d-s/2)+" z",sf.base.merge(r,{d:l});break;case"Pentagon":for(var g=void 0,m=void 0,u=0;u<=5;u++)g=a/2*Math.cos(Math.PI/180*(72*u)),m=a/2*Math.sin(Math.PI/180*(72*u)),l=0===u?"M "+(h+g)+" "+(d+m)+" ":l.concat("L "+(h+g)+" "+(d+m)+" ");l=l.concat("Z"),sf.base.merge(r,{d:l});break;case"Star":l="M "+(e.x+t.width/3)+" "+(e.y-t.height/2)+" L "+(e.x-t.width/2)+" "+(e.y+t.height/6)+" L "+(e.x+t.width/2)+" "+(e.y+t.height/6)+" L "+(e.x-t.width/3)+" "+(e.y-t.height/2)+" L "+e.x+" "+(e.y+t.height/2)+" L "+(e.x+t.width/3)+" "+(e.y-t.height/2)+" Z",sf.base.merge(r,{d:l});break;case"Cross":l="M "+p+" "+d+" L "+(h+a/2)+" "+d+" M "+h+" "+(d+s/2)+" L "+h+" "+(d+-s/2),sf.base.merge(r,{d:l});break;case"Image":n="Image",sf.base.merge(r,{href:o,height:s,width:a,x:p,y:c})}return{renderOption:r,functionName:n}}function ye(e,t){for(var i=!1,r=0;r<e.length;r++)if(t.levelOrderName===e[r].levelOrderName){i=!0;break}return i}var ve=function(e,t,i,r,o){this.dataOptions=e,this.type=t||"GET",this.async=i||!0,this.contentType=r,this.sendData=o};function be(e,t){if(e.length>0)for(var i=0;i<e.length;i++){var r=e[i];we(r.legendEle,r.oldFill,r.oldOpacity,r.oldBorderColor,r.oldBorderWidth)}}function xe(e,t){if(e.length>0)for(var i=0;i<e.length;i++){var r=e[i];we(r.legendEle,r.oldFill,r.oldOpacity,r.oldBorderColor,r.oldBorderWidth);for(var o=r.ShapeCollection.Elements.length,l=0;l<o;l++)we(r.ShapeCollection.Elements[l],r.shapeOldFill,r.shapeOldOpacity,r.shapeOldBorderColor,r.shapeOldBorderWidth)}}function we(e,t,i,r,o){e.setAttribute("fill",t),e.setAttribute("opacity",i),e.setAttribute("stroke",r),e.setAttribute("stroke-width",o)}function Se(e,t,i){be(e),ne(document.getElementsByClassName("treeMapHighLight"),"treeMapHighLight",i)}function Ie(e,t,i){for(var r,o=0;o<e;o++)for(var l=i.treeMapLegendModule.legendCollections[o].legendData.length,n=0;n<l;n++)if(i.treeMapLegendModule.legendCollections[o].legendData[n].levelOrderName===t.levelOrderName){r=o;break}return r}function Oe(e,t,i,r,o,l,n){e.push({legendEle:r,oldFill:n[t].legendFill,oldOpacity:n[t].opacity,oldBorderColor:n[t].borderColor,oldBorderWidth:n[t].borderWidth,shapeElement:o,shapeOldFill:l[i].options.fill,shapeOldOpacity:l[i].options.opacity,shapeOldBorderColor:l[i].options.border.color,shapeOldBorderWidth:l[i].options.border.width})}function Ce(e,t,i,r){sf.base.createElement("a",{attrs:{download:e+"."+t.toLocaleLowerCase(),href:i}}).dispatchEvent(new MouseEvent(r?"click":"move",{view:window,bubbles:!1,cancelable:!0}))}function Le(e){var t=document.getElementById(e);return t?sf.base.remove(t):null}var Pe=function(e,t){var i={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(i[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&(i[r[o]]=e[r[o]])}return i},Me=function(){function e(e){this.treemap=e}return e.prototype.processLayoutPanel=function(){var e,t;if(ze.levelsData&&ze.levelsData.length>0)if(e=sf.base.isNullOrUndefined(this.treemap.initialDrillDown.groupIndex)||sf.base.isNullOrUndefined(this.treemap.initialDrillDown.groupName)||!(sf.base.isNullOrUndefined(this.treemap.drilledItems)?sf.base.isNullOrUndefined(this.treemap.drilledItems):0===this.treemap.drilledItems.length)?ze.levelsData[0]:this.getDrilldownData(ze.levelsData[0],[])[0],t=sf.base.extend({},this.treemap.areaRect,t,!1),sf.base.isNullOrUndefined(this.treemap.treeMapLegendModule)||sf.base.isNullOrUndefined(this.treemap.totalRect)||"Float"!==this.treemap.legendSettings.position&&(t=this.treemap.totalRect),sf.base.isNullOrUndefined(this.treemap.currentLevel)||(sf.base.isNullOrUndefined(this.treemap.drilledItems)?sf.base.isNullOrUndefined(this.treemap.drilledItems):0===this.treemap.drilledItems.length))!sf.base.isNullOrUndefined(this.treemap.initialDrillDown.groupIndex)&&(sf.base.isNullOrUndefined(this.treemap.drilledItems)?sf.base.isNullOrUndefined(this.treemap.drilledItems):0===this.treemap.drilledItems.length)&&(this.treemap.currentLevel=this.treemap.initialDrillDown.groupIndex),this.calculateLayoutItems(e||ze.levelsData[0],t),this.renderLayoutItems(e||ze.levelsData[0]);else{var i=this.treemap.drilledItems.length-1,r=this.treemap.drilledItems[i].data,o=new Object;o[this.treemap.drilledItems[i].data.groupName]=[r],sf.base.isNullOrUndefined(this.treemap.initialDrillDown.groupIndex)||this.treemap.enableBreadcrumb||(this.treemap.currentLevel=this.treemap.drilledItems[i].data.groupIndex),this.calculateLayoutItems(o||ze.levelsData[0],t),this.renderLayoutItems(o||ze.levelsData[0])}},e.prototype.getDrilldownData=function(e,t){var i=this.treemap,r={},o=R(e).values;if(o&&o.length>0&&0===t.length){for(var l=0;l<o.length;l++)o[l].groupIndex===i.initialDrillDown.groupIndex&&o[l].name===i.initialDrillDown.groupName&&(o[l].isDrilled=!0,r[o[l].groupName]=[o[l]],t.push(r));for(var n=0;n<o.length;n++)this.getDrilldownData(o[n],t)}return t},e.prototype.calculateLayoutItems=function(e,t){this.renderItems=[],this.parentData=[],sf.base.isNullOrUndefined(this.treemap.weightValuePath)||(this.treemap.layoutType.indexOf("SliceAndDice")>-1?this.computeSliceAndDiceDimensional(e,t):(t.height=t.height+t.y,t.width=t.width+t.x,this.computeSquarifyDimensional(e,t)))},e.prototype.computeSliceAndDiceDimensional=function(e,t){var i,r,o,l,n=this.treemap.leafItemSettings,a=this.treemap.levels,s=R(e).values;if(s&&s.length>0&&(this.sliceAndDiceProcess(s,t),this.treemap.levels.length>0))for(var h=0;h<s.length;h++)r=s[h].groupIndex,o=0===a.length||r===a.length?n.gap:a[r].groupGap,l=0===a.length?0:a[r]?a[r].showHeader?a[r].headerHeight:0:a[r-1].showHeader?a[r-1].headerHeight:0,i=s[h].rect,i=new S(i.x+o/2,i.y+(l+o/2),i.width-o,Math.abs(i.height-(o+l))),this.computeSliceAndDiceDimensional(s[h],i);return e},e.prototype.sliceAndDiceProcess=function(e,t){var i,r=t.height*t.width,o=this.treemap.levels,l=0,n=0;e.forEach((function(e){n+=e.weight})),e.forEach((function(e){e.weightArea=r*e.weight/n}));var a="SliceAndDiceAuto"===this.treemap.layoutType?t.width>t.height:"SliceAndDiceHorizontal"===this.treemap.layoutType;e.sort(_);for(var s=0;s<e.length;s++){var h=e[s];h.isLeafItem=0===o.length||(this.treemap.isHierarchicalData||sf.base.isNullOrUndefined(this.treemap.leafItemSettings.labelPath)?h.groupIndex===o.length-1:h.groupIndex===this.treemap.levels.length),a?(i=r/n*e[s].weight/t.height,l<=t.width&&(e[s].rect=new S(l+t.x,t.y,i,t.height))):(i=r/n*e[s].weight/t.width,l<=t.height&&(e[s].rect=new S(t.x,l+t.y,t.width,i))),l+=i,this.renderItems.push(e[s])}},e.prototype.computeSquarifyDimensional=function(e,t){var i,r,o,l,n,a=this.treemap.leafItemSettings,s=this.treemap.levels,h=R(e).values;if(h&&h.length>0&&(0===this.parentData.length&&(this.parentData=[],this.parentData.push(h)),this.calculateChildrenLayout(e,h,t),this.treemap.levels.length>0))for(var d=0;d<h.length;d++)o=(r=h[d]).groupIndex,i=r.rect,(r.isLeafItem?a.gap:s[o].groupGap)/2,l=(r.isLeafItem?a.padding:s[o].groupPadding)/2,n=this.treemap.isHierarchicalData?0===o&&r.isLeafItem?0:s[o]&&s[o].showHeader?s[o].headerHeight:0:0===s.length?0:s[o]&&s[o].showHeader?s[o].headerHeight:0,i=new S(i.x+l,i.y+(n+l),i.width-l,i.height-l),!r.isLeafItem&&r.weight>0&&this.computeSquarifyDimensional(h[d],i)},e.prototype.calculateChildrenLayout=function(e,t,i){this.computeTotalArea(t,k(i)),t.sort(re),this.performRowsLayout(t,[],i,[])},e.prototype.performRowsLayout=function(e,t,i,r){var o=e.length;if(0===o){var l=this.getCoordinates(t,i);return m=r.concat(l)}var n=j(i),a=e[0],s=e.slice(1,o);if(this.aspectRatio(t,a,n)){var h=t.concat(a);return this.performRowsLayout(s,h,i,r)}for(var d=t.length,p=0,c=0;c<d;c+=1)p+=t[c].itemArea;var g=this.cutArea(i,p),m=(l=this.getCoordinates(t,i),r.concat(l));return this.performRowsLayout(e,[],g,m)},e.prototype.aspectRatio=function(e,t,i){if(0===e.length)return!0;var r=e.concat(t);return this.findMaxAspectRatio(e,i)>=this.findMaxAspectRatio(r,i)},e.prototype.findMaxAspectRatio=function(e,t){for(var i=e.length,r=1/0,o=-1/0,l=0,n=0;n<i;n+=1){var a=e[n].itemArea;a<r&&(r=a),a>o&&(o=a),l+=a}return Math.max(Math.pow(t,2)*o/Math.pow(l,2),Math.pow(l,2)/(Math.pow(t,2)*r))},e.prototype.cutArea=function(e,t){var i=G(e),r=i.width,o=i.height,l=i.x,n=i.y;if(r>=o){var a=t/o;return V({x:l+a,y:n,width:r-a,height:o})}var s=t/r;return V({x:l,y:n+s,width:r,height:o-s})},e.prototype.getCoordinates=function(e,t){for(var i,r=G(t),o=r.width,l=r.height,n=r.x,a=r.y,s=e.length,h=this.treemap.levels,d=this.treemap.leafItemSettings,p=0,c=0;c<s;c+=1)p+=e[c].itemArea;var g,m,u,f=p/l,y=p/o,v=n,b=a,x=[];for(c=0;c<s;c+=1){var w=e[c];if(i=w.groupIndex,w.isLeafItem=0===h.length||(this.treemap.isHierarchicalData||!sf.base.isNullOrUndefined(d.labelPath))&&i===h.length,u=(m=ye(this.parentData[0],w))?this.treemap.areaRect:w.parent.rect,g=w.isLeafItem?d.padding:h[i].groupPadding,o>=l){var S=b+w.itemArea/f;w.rect={x:v,y:b,width:v+f,height:S},b=S}else{var I=v+w.itemArea/y;w.rect={x:v,y:b,width:I,height:b+y},v=I}w.weight>0&&(m||Math.round(t.y+g/2)<=Math.round(u.y+(u.height-u.y))&&Math.round(t.x+g/2)<=Math.round(u.x+(u.width-u.x)))&&(this.renderItems.push(w),x.push(w))}return x},e.prototype.computeTotalArea=function(e,t){for(var i=e.length,r=[],o=0;o<i;o+=1){for(var l=e.length,n=0,a=0;a<l;a+=1)n+=e[a].weight;for(var s=t/n,h=void 0,d=0;d<l;d++)(h=e[d]).itemArea=h.weight*s,r.push(h)}return r},e.prototype.onDemandProcess=function(e){var t,i=new Object;i=e[0].parent,this.treemap.currentLevel=i.isDrilled?i.groupIndex:null;var r=new Object;sf.base.isNullOrUndefined(i.groupName)?r=i:r[i.groupName]=[i],t=sf.base.extend({},this.treemap.areaRect,t,!1),sf.base.isNullOrUndefined(this.treemap.treeMapLegendModule)||sf.base.isNullOrUndefined(this.treemap.totalRect)||(t=this.treemap.totalRect);for(var o=this.treemap.levels.length,l=0;l<o;l++){o===e[0].groupIndex?this.treemap.levels[o]=this.treemap.levels[l]:this.treemap.levels.splice(o-1,1)}this.calculateLayoutItems(r,t),this.renderLayoutItems(r)},e.prototype.renderLayoutItems=function(e){var t,i,r,o,l,n=this,a=this.treemap;this.renderer=a.renderer;var s,h,d,p,c,g,m,u,f,y,v,b,x,w,S,I=a.element.id,C=a.layoutType,L=this.treemap.leafItemSettings.interSectAction,P="",M=document.getElementById(a.element.id+"_Secondary_Element"),N=a.levels;this.layoutGroup=this.renderer.createGroup({id:I+"_TreeMap_"+C+"_Layout"});for(var T,E,D=sf.base.createElement("div",{id:a.element.id+"_Label_Template_Group",className:"template",styles:"overflow: hidden; position: absolute;pointer-events: none;top:"+a.areaRect.y+"px;left:"+a.areaRect.x+"px;height:"+a.areaRect.height+"px;width:"+a.areaRect.width+"px;"}),_=!1,B=a.leafItemSettings,F=function(e){if(g=H.renderItems[e],s=g.groupIndex,H.treemap.drillDownView&&sf.base.isNullOrUndefined(H.treemap.currentLevel)&&s>0||H.treemap.drillDownView&&s>H.treemap.currentLevel+1)return"continue";d=g.rect,_=g.isLeafItem,f=I+"_Level_Index_"+s+"_Item_Index_"+e,x=H.renderer.createGroup({id:f+"_Group"}),v=(_?B.gap:N[s].groupGap)/2;var C,F=H.treemap.totalRect?G(H.treemap.totalRect):H.treemap.areaRect;if("Squarified"===a.layoutType&&(d.width=Math.abs(d.x-d.width)-v,d.height=Math.abs(d.y-d.height)-v),"TopRightBottomLeft"===a.renderDirection?d.x=F.x+F.width-d.width-Math.abs(F.x-d.x):"BottomLeftTopRight"===a.renderDirection?d.y=F.y+F.height-d.height-Math.abs(F.y-d.y):"BottomRightTopLeft"===a.renderDirection&&(d.x=F.x+F.width-d.width-Math.abs(F.x-d.x),d.y=F.y+F.height-d.height-Math.abs(F.y-d.y)),_?B.colorMapping:N[s].colorMapping,r=H.getItemColor(_,g),c=r.fill,u=r.opacity,p=_?B.labelFormat:N[s].headerFormat,i=_?B.showLabels:N[s].showHeader,s===H.treemap.currentLevel)if(H.treemap.enableBreadcrumb){E="#"+H.treemap.breadcrumbConnector+"#",C=g.levelOrderName.replace(/#/gi,E),C=0!==s?"#"+C:C}else C=g.name;else H.treemap.enableBreadcrumb&&(g.isDrilled=!1),C=g.name;if(m=se(p,g.data,H.treemap)||C,T=R(g).values,m=!_&&T&&T.length>0&&H.treemap.enableDrillDown?g.isDrilled?a.enableRtl?m+" [-]":"[-] "+m:a.enableRtl?m+" [+]":"[+] "+m:m,(b=_?B.labelStyle:N[s].headerStyle).fontFamily=H.treemap.themeStyle.labelFontFamily||b.fontFamily,S=_?B.border:N[s].border,t=_?B.labelPosition:"Near"===N[s].headerAlignment?"TopLeft":"Center"===N[s].headerAlignment?"TopCenter":"TopRight",h=_?B.templatePosition:N[s].templatePosition,w=_?B.labelTemplate:N[s].headerTemplate,g.options={border:S,opacity:u,fill:c},o={cancel:!1,name:"itemRendering",treemap:H.treemap,text:m,currentItem:g,RenderItems:H.renderItems,options:g.options},H.treemap.isBlazor){o.treemap,o.RenderItems;var z=Pe(o,["treemap","RenderItems"]);o=z}H.treemap.trigger("itemRendering",o,(function(r){if(!r.cancel){P=" M "+d.x+" "+d.y+" L "+(d.x+d.width)+" "+d.y+" L "+(d.x+d.width)+" "+(d.y+d.height)+" L "+d.x+" "+(d.y+d.height)+"z",l=new O(f+"_RectPath",c,S.width,S.color,u,null,P);var a=n.renderer.drawPath(l);x.appendChild(a),i&&(o.text!==m&&(o.text=se(o.text,g.data,n.treemap)||C),n.renderItemText(o.text.toString(),x,b,d,L,f,c,t,E)),w&&(y=n.renderTemplate(M,f,d,h,w,g,_),D.appendChild(y)),x.setAttribute("aria-label",g.name),x.setAttribute("tabindex",(n.treemap.tabIndex+e+2).toString()),oe(n.treemap,x,"treeMapSelection"),n.layoutGroup.appendChild(x)}}))},H=this,z=0;z<this.renderItems.length;z++)F(z);D.childNodes.length>0&&(M.appendChild(D),sf.base.updateBlazorTemplate(this.treemap.element.id+"_HeaderTemplate","HeaderTemplate",N[N.length-1]),sf.base.updateBlazorTemplate(this.treemap.element.id+"_LabelTemplate","LabelTemplate",B)),this.treemap.svgObject.appendChild(this.layoutGroup)},e.prototype.renderItemText=function(e,t,i,r,o,l,n,a,s){document.getElementById(this.treemap.element.id+"_Secondary_Element"),this.treemap.leafItemSettings;var h,d,p,c,g,m=[],u=0;if(p=-1!==e.indexOf("<br>")?e.split("<br>"):null,c=this.labelInterSectAction(r,e,i,o),h=C(p&&p[0]||c[0],i),this.treemap.enableRtl){var f=C(e,i),y=e.search("[+]")||e.search("[-]");if(r.width<f.width&&y>0){var v=e.substring(y-1,e.length),b=C("[+]",i);c[0]=P(r.width-b.width-5,c[0],i)+v}}if(d=U(r,a,h,"Text",this.treemap),!sf.base.isNullOrUndefined(p)){for(var x=[],w=null,S=[],I=0;I<p.length;I++)u+=(h=C(w=P(r.width-5,p[I],i),i)).height,S.push(h.width),x.push(w);c=x,h.width=Math.max.apply(null,S),h.height=u}if("WrapByWord"===o||"Wrap"===o||"Trim"===o){for(var O=0;O<c.length;O++)u+=(h=C(c[O],i)).height,r.height-5>u&&m.push(c[O]);if("Wrap"===o&&c.length!==m.length&&m.length){var M=m.length-1,N=m[M];N=N.substring(0,N.length-1)+"...",m.splice(M),"..."!==N&&m.push(N)}}else g=c,m.push(g);E(new L(l+"_Text",d.x,d.y,"start",m,"","",s),i,i.color||this.getSaturatedColor(n),t)},e.prototype.getItemColor=function(e,t){var i=this.treemap,r=e?i.leafItemSettings.fill:i.levels[t.groupIndex].fill,o=e?i.leafItemSettings.opacity:i.levels[t.groupIndex].opacity;sf.base.isNullOrUndefined(ze.defaultLevelsData)||ze.defaultLevelsData.length>0&&(ze.levelsData=ze.defaultLevelsData);var l=R(ze.levelsData[0]).values,n=e?i.leafItemSettings.colorMapping:i.levels[t.groupIndex].colorMapping;if(n.length>0){var a=q(n,t.data[this.treemap.equalColorValuePath],t.data[this.treemap.rangeColorValuePath],t.data[this.treemap.weightValuePath]);r=sf.base.isNullOrUndefined(a.fill)?i.leafItemSettings.fill:a.fill,o=a.opacity}else for(var s=0;s<l.length;s++)l[s].levelOrderName===t.levelOrderName.split("#")[0]&&(r=sf.base.isNullOrUndefined(r)?sf.base.isNullOrUndefined(i.colorValuePath)?i.palette.length>0?i.palette[s%i.palette.length]:"#808080":l[s].data[i.colorValuePath]:r);return{fill:r,opacity:o}},e.prototype.getSaturatedColor=function(e){var t=e,i=ge(me(t="transparent"===t?window.getComputedStyle(document.body,null).backgroundColor:t));return Math.round((299*i.r+587*i.g+114*i.b)/1e3)>=128?"black":"white"},e.prototype.renderTemplate=function(e,t,i,r,o,l,n){var a,s,h=n?t+"_LabelTemplate":t+"_HeaderTemplate",d=n?"_LabelTemplate":"_HeaderTemplate";if(sf.base.isNullOrUndefined(o.prototype))for(var p=Object.keys(l.data),c=0;c<p.length;c++)o=o.replace(new RegExp("{{:"+p[c]+"}}","g"),l.data[p[c].toString()]);return s=U(i,r,A(a=z(H(o)(l.data,null,null,this.treemap.element.id+d,!1),h,l.data),e),"Template",this.treemap),a.style.left=s.x+"px",a.style.top=s.y+"px",a},e.prototype.labelInterSectAction=function(e,t,i,r){var o,l=e.width-10;switch(r){case"Hide":o=[ie(l,e.height,t,i)];break;case"Trim":o=[P(l+3,t,i)];break;case"WrapByWord":o=ee(l,t,i);break;case"Wrap":o=te(l,t,i)}return o},e}();function Ne(e){var t,i;switch(e.toLowerCase()){case"materialdark":i="#303030";break;case"fabricdark":i="#201F1F";break;case"bootstrapdark":i="#1A1A1A"}switch(e.toLowerCase()){case"bootstrapdark":case"fabricdark":case"materialdark":t={backgroundColor:i,titleFontColor:"#FFFFFF",subTitleFontColor:"#FFFFFF",tooltipFillColor:"#363F4C",tooltipFontColor:"#ffffff",legendTitleColor:"#DADADA",legendTextColor:"#DADADA",fontFamily:"Roboto, Noto, Sans-serif"};break;case"highcontrast":t={backgroundColor:"#000000",titleFontColor:"#FFFFFF",subTitleFontColor:"#FFFFFF",tooltipFillColor:"#363F4C",tooltipFontColor:"#ffffff",legendTitleColor:"#FFFFFF",legendTextColor:"#FFFFFF",fontFamily:"Roboto, Noto, Sans-serif"};break;case"bootstrap4":t={backgroundColor:"#FFFFFF",titleFontColor:"#212529",subTitleFontColor:"#212529",tooltipFillColor:"#000000",tooltipFontColor:"#FFFFFF",tooltipFillOpacity:1,tooltipTextOpacity:.9,legendTitleColor:"#212529",legendTextColor:"#212529",fontFamily:"HelveticaNeue-Medium",fontSize:"16px",legendFontSize:"14px",labelFontFamily:"HelveticaNeue"};break;default:t={backgroundColor:"#FFFFFF",titleFontColor:"#424242",subTitleFontColor:"#424242",tooltipFillColor:"#363F4C",tooltipFontColor:"#ffffff",legendTitleColor:"#353535",legendTextColor:"#353535",fontFamily:"Roboto, Noto, Sans-serif"}}return t}(e.Theme||(e.Theme={})).mapsTitleFont={size:"14px",fontWeight:"Medium",color:"#424242",fontStyle:"Medium",fontFamily:"Roboto, Noto, Sans-serif"};var Te,Ee=function(){function e(e){this.control=e}return e.prototype.print=function(e){var t=this;this.printWindow=window.open("","print","height="+window.outerHeight+",width="+window.outerWidth+",tabbar=no"),this.printWindow.moveTo(0,0),this.printWindow.resizeTo(screen.availWidth,screen.availHeight);var i={cancel:!1,htmlContent:this.getHTMLContent(e),name:"beforePrint"};this.control.trigger("beforePrint",i,(function(){i.cancel||sf.base.print(i.htmlContent,t.printWindow)}))},e.prototype.getHTMLContent=function(e){var t=sf.base.createElement("div");return e?e instanceof Array?e.forEach((function(e){t.appendChild(D(e).cloneNode(!0))})):e instanceof Element?t.appendChild(e.cloneNode(!0)):t.appendChild(D(e).cloneNode(!0)):t.appendChild(this.control.element.cloneNode(!0)),t},e.prototype.getModuleName=function(){return"Print"},e.prototype.destroy=function(e){},e}(),De=function(){function e(e){this.control=e}return e.prototype.export=function(e,t,i){var r=this;return new Promise((function(o,l){var n=sf.base.createElement("canvas",{id:"ej2-canvas",attrs:{height:r.control.availableSize.height.toString(),width:r.control.availableSize.width.toString()}}),a=!(sf.base.Browser.userAgent.toString().indexOf("HeadlessChrome")>-1),s='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">'+r.control.svgObject.outerHTML+"</svg>",h=window.URL.createObjectURL(new Blob("SVG"===e?[s]:[(new XMLSerializer).serializeToString(r.control.svgObject)],{type:"image/svg+xml"}));if("SVG"===e)i?Ce(t,e,h,a):o(null);else{var d=new Image,p=n.getContext("2d");d.onload=function(){p.drawImage(d,0,0),window.URL.revokeObjectURL(h),i?Ce(t,e,n.toDataURL("image/png").replace("image/png","image/octet-stream"),a):"JPEG"===e?o(n.toDataURL("image/jpeg")):"PNG"===e&&o(n.toDataURL("image/png"))},d.src=h}}))},e.prototype.getModuleName=function(){return"ImageExport"},e.prototype.destroy=function(e){},e}(),_e=function(){function e(e){this.control=e}return e.prototype.export=function(e,t,i,r){var o=this;return new Promise((function(e,l){var n=sf.base.createElement("canvas",{id:"ej2-canvas",attrs:{width:o.control.availableSize.width.toString(),height:o.control.availableSize.height.toString()}});sf.base.Browser.userAgent.toString().indexOf("HeadlessChrome");i=sf.base.isNullOrUndefined(i)?sf.pdfexport.PdfPageOrientation.Landscape:i;var a=window.URL.createObjectURL(new Blob([(new XMLSerializer).serializeToString(o.control.svgObject)],{type:"image/svg+xml"})),s=new Image,h=n.getContext("2d");s.onload=function(){h.drawImage(s,0,0),window.URL.revokeObjectURL(a);var l=new sf.pdfexport.PdfDocument,d=n.toDataURL("image/jpeg").replace("image/jpeg","image/octet-stream");l.pageSettings.orientation=i,d=d.slice(d.indexOf(",")+1),l.pages.add().graphics.drawImage(new sf.pdfexport.PdfBitmap(d),0,0,o.control.availableSize.width-60,o.control.availableSize.height),r?(l.save(t+".pdf"),l.destroy()):e(null)},s.src=a}))},e.prototype.getModuleName=function(){return"PdfExport"},e.prototype.destroy=function(e){},e}(),Be=(Te=function(e,t){return(Te=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])})(e,t)},function(e,t){function i(){this.constructor=e}Te(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),Re=function(e,t,i,r){var l,n=arguments.length,a=n<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r;if("object"===("undefined"==typeof Reflect?"undefined":o()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,i,r);else for(var s=e.length-1;s>=0;s--)(l=e[s])&&(a=(n<3?l(a):n>3?l(t,i,a):l(t,i))||a);return n>3&&a&&Object.defineProperty(t,i,a),a},Fe=function(e,t){var i={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(i[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&(i[r[o]]=e[r[o]])}return i},He=function(e){function t(t,i){var r=e.call(this,t,i)||this;return r.isResize=!1,r.orientation="Horizontal",r.drilledItems=[],r.isHierarchicalData=!1,r.levelSelection=[],r.legendId=[],r}return Be(t,e),t.prototype.preRender=function(){var e=this;this.isBlazor=sf.base.isBlazor(),this.trigger("load",{treemap:this.isBlazor?null:this},(function(){e.initPrivateVariable(),e.unWireEVents(),e.createSvg(),e.wireEVents(),e.setCulture()}))},t.prototype.render=function(){ze.levelsData=null,ze.defaultLevelsData=null,ze.hierarchyData=null,this.createSecondaryElement(),this.addTabIndex(),this.themeStyle=Ne(this.theme),this.renderBorder(),this.renderTitle(this.titleSettings,"title",null,null),sf.base.isNullOrUndefined(ze.levelsData)||(ze.defaultLevelsData=ze.levelsData),this.processDataManager()},t.prototype.processDataManager=function(){var e,t,i,r,o=this;this.dataSource instanceof sf.data.DataManager?(e=this.dataSource,t=this.query instanceof sf.data.Query?this.query:new sf.data.Query,e.executeQuery(t).then((function(e){o.dataSource=e.result,o.renderTreeMapElements()}))):this.dataSource instanceof ve?(r=this.dataSource,(i=new sf.base.Ajax(r.dataOptions,r.type,r.async,r.contentType)).onSuccess=function(e){o.dataSource=JSON.parse("["+e+"]")[0],o.renderTreeMapElements()},i.send(r.sendData)):this.renderTreeMapElements()},t.prototype.renderTreeMapElements=function(){this.processingData(),this.treeMapLegendModule&&this.legendSettings.visible&&this.treeMapLegendModule.renderLegend(),this.layout.processLayoutPanel(),this.element.appendChild(this.svgObject),this.elementChange(),this.trigger("loaded",this.isBlazor?{isResized:this.isResize}:{treemap:this,isResized:this.isResize}),this.isResize=!1,this.renderComplete()},t.prototype.createSvg=function(){if(this.svgObject){for(;this.svgObject.childNodes.length>0;)this.svgObject.removeChild(this.svgObject.firstChild);!this.svgObject.hasChildNodes()&&this.svgObject.parentNode&&sf.base.remove(this.svgObject)}this.leafItemSettings.labelTemplate&&sf.base.resetBlazorTemplate(this.element.id+"_LabelTemplate","LabelTemplate");for(var e=0;e<this.levels.length;e++)this.levels[e].headerTemplate&&sf.base.resetBlazorTemplate(this.element.id+"_HeaderTemplate","HeaderTemplate");var t=this.element.clientWidth,i=this.element.clientHeight;this.availableSize=new x(w(this.width,t)||t||600,w(this.height,i)||i||450),this.svgObject=this.renderer.createSvg({id:this.element.id+"_svg",width:this.availableSize.width,height:this.availableSize.height})},t.prototype.initPrivateVariable=function(){if(""===this.element.id){var e=document.getElementsByClassName("e-treemap").length;this.element.id="treemap_control_"+e}this.renderer=new sf.svgbase.SvgRenderer(this.element.id),this.layout=new Me(this)},t.prototype.createSecondaryElement=function(){var e=document.getElementById(this.element.id+"_Secondary_Element");if(e&&e.childElementCount>0&&e.parentNode.removeChild(e),sf.base.isNullOrUndefined(document.getElementById(this.element.id+"_Secondary_Element"))){var t=sf.base.createElement("div",{id:this.element.id+"_Secondary_Element",styles:"position: absolute;z-index:1;"});this.element.appendChild(t)}},t.prototype.elementChange=function(){this.treeMapLegendModule&&this.legendSettings.visible&&this.treeMapLegendModule.legendGroup&&this.layout.layoutGroup&&this.svgObject.insertBefore(this.layout.layoutGroup,this.treeMapLegendModule.legendGroup)},t.prototype.renderBorder=function(){var e=this.border.width,t=this.svgObject.querySelector("#"+this.element.id+"_TreeMap_Border");if((this.border.width>0||this.background||this.themeStyle.backgroundColor)&&sf.base.isNullOrUndefined(t)){var i=new I(this.element.id+"_TreeMap_Border",this.background||this.themeStyle.backgroundColor,this.border,1,new S(e/2,e/2,this.availableSize.width-e,this.availableSize.height-e));this.svgObject.appendChild(this.renderer.drawRectangle(i))}else t&&t.setAttribute("fill",this.background||this.themeStyle.backgroundColor)},t.prototype.renderTitle=function(e,t,i,r){var o,l=e.textStyle,n=this.availableSize.width-this.margin.right-this.margin.left;if(e.textStyle.fontFamily=this.themeStyle.fontFamily||e.textStyle.fontFamily,e.textStyle.size=this.themeStyle.fontSize||e.textStyle.size,e.text){sf.base.isNullOrUndefined(r)&&(r=this.renderer.createGroup({id:this.element.id+"_Title_Group"}));var a=P(n,e.text,l),s=C(a,l),h=N(sf.base.isNullOrUndefined(i)?new S(this.margin.left,this.margin.top,this.availableSize.width,this.availableSize.height):i,e.alignment,s,t),d=new L(this.element.id+"_TreeMap_"+t,h.x,h.y,"start",a),p=new S(h.x,h.y,s.width,s.height),c=E(d,l,l.color||("title"===t?this.themeStyle.titleFontColor:this.themeStyle.subTitleFontColor),r);c.setAttribute("aria-label",e.description||e.text),c.setAttribute("tabindex",(this.tabIndex+("title"===t?1:2)).toString()),("title"===t&&!e.subtitleSettings.text||"subtitle"===t)&&(o=this.availableSize.height-p.y-10-this.margin.bottom,this.areaRect=new S(this.margin.left,p.y+10,n,o)),"subtitle"!==t&&e.subtitleSettings.text?this.renderTitle(e.subtitleSettings,"subtitle",p,r):this.svgObject.appendChild(r)}else o=this.availableSize.height-this.margin.top-this.margin.bottom,this.areaRect=new S(this.margin.left,this.margin.top,n,o)},t.prototype.processingData=function(){var e,t=this;if(this.dataSource=this.dataSource,!sf.base.isNullOrUndefined(this.dataSource)&&this.dataSource.length>0&&this.weightValuePath){if(ze.levelsData=[],this.dataSource.map((function(e){e[t.weightValuePath]=e[t.weightValuePath]?e[t.weightValuePath].toString():e[t.weightValuePath]})),this.leafItemSettings.labelPath=this.leafItemSettings.labelPath||this.weightValuePath,this.checkIsHierarchicalData(),0===this.levels.length){var i=new Object;i.level=0,e=this.leafItemSettings.labelPath,i[e]=[];for(var r=0;r<this.dataSource.length;r++){var o=R(this.dataSource[r]).values;this.isHierarchicalData&&o&&o.length>0?o.forEach((function(r,o){r[e]&&i[e].push({groupIndex:0,name:r[e],levelOrderName:r[e].toString(),data:r,weight:r[t.weightValuePath]})})):this.dataSource[r][e]&&i[e].push({groupIndex:0,name:this.dataSource[r][e],levelOrderName:this.dataSource[r][e].toString(),data:this.dataSource[r],weight:this.dataSource[r][this.weightValuePath]})}ze.levelsData.push(i)}else{if(this.isHierarchicalData){ze.hierarchyData=[],ze.hierarchyData=sf.base.extend([],this.dataSource,ze.hierarchyData,!0);for(r=0;r<ze.hierarchyData.length;r++)this.processHierarchicalData(ze.hierarchyData[r],r);ze.levelsData=ze.hierarchyData}else this.processFlatJsonData(),ze.levelsData.length>1&&this.reOrderLevelData(ze.levelsData.length-1);e=this.levels[0].groupPath}this.isHierarchicalData||this.findTotalWeight(ze.levelsData[0][e],"Parent")}},t.prototype.checkIsHierarchicalData=function(){var e;this.dataSource=this.dataSource;for(var t=0;t<this.dataSource.length;t++){if((e=R(this.dataSource[t]).values)&&e.length){this.isHierarchicalData=!0;break}t===this.dataSource.length-1&&(this.isHierarchicalData=!1)}},t.prototype.processHierarchicalData=function(e,t){var i,r,o,l=this,n=new Object,a=this.leafItemSettings.labelPath?this.leafItemSettings.labelPath:this.weightValuePath;if((i=(n=R(e))?n.values:null)&&i.length>0){o=n.key;for(var s=0;s<this.levels.length;s++)o===this.levels[s].groupPath&&(this.levels[s],r=s);for(var h=0;h<i.length;h++){i[h].name=i[h][a],i[h].levelOrderName=(0===r?i[h].name:e.levelOrderName+"#"+i[h].name)+"";var d=i[h].levelOrderName,p=void 0;d.search("#")>0&&(p=d.split("#").length-1),i[h].groupIndex=sf.base.isNullOrUndefined(r)?p===this.levels.length?this.levels.length:p:r,0!==r&&(i[h].parent=e),i[h].groupName=o,i[h].data=i[h],i[h].isDrilled=!1,i[h].weight=i[h][this.weightValuePath]}i.forEach((function(e){l.processHierarchicalData(e,t)}))}if(t===ze.hierarchyData.length-1){for(var c=ze.hierarchyData[0][this.levels[0].groupPath],g=0;g<ze.hierarchyData.length;g++)i=R(ze.hierarchyData[g]).values,0!==g&&i&&(i.forEach((function(e){c.push(e)})),ze.hierarchyData.splice(g,1),g-=1);c=ze.hierarchyData[0][this.levels[0].groupPath];for(var m=0;m<c.length;m++)n[this.levels[0].groupPath]=c,c[m].parent=n}},t.prototype.print=function(e){this.allowPrint&&this.printModule&&this.printModule.print(e)},t.prototype.export=function(e,t,i,r){var o=this;return sf.base.isNullOrUndefined(r)&&(r=!0),"PDF"===e&&this.allowPdfExport&&this.pdfExportModule?new Promise((function(l,n){l(o.pdfExportModule.export(e,t,i,r))})):this.allowImageExport&&"PDF"!==e&&this.imageExportModule?new Promise((function(i,l){i(o.imageExportModule.export(e,t,r))})):null},t.prototype.processFlatJsonData=function(){var e;this.dataSource=this.dataSource;for(var t=[],i=0;i<this.levels.length+1;i++){e=this.levels[i]?this.levels[i].groupPath:this.leafItemSettings.labelPath;var r=new Object;r.level=i,r[e]=[],ze.levelsData.push(r);for(var o=0;o<this.dataSource.length;o++){var l={},n="";if(this.dataSource[o][e]){var a=this.dataSource[o][e];if(0!==i)for(var s=0;s<=i;s++){var h=this.levels[s]?this.levels[s].groupPath:e;n+=this.dataSource[o][h]+(s===i?"":"#")}t.length>0&&-1!==t.indexOf(n||a)||(l.name=a,l.levelOrderName=(n||a)+"",l.groupIndex=i,l.isDrilled=!1,l.groupName=e,l.data=this.dataSource[o],ze.levelsData[ze.levelsData.length-1][e].push(l),t.push(n||a))}}}},t.prototype.reOrderLevelData=function(e){for(var t,i=this.levels[e]?this.levels[e].groupPath:this.leafItemSettings.labelPath,r=this.levels[e-1].groupPath,o=ze.levelsData[e][i],l=ze.levelsData[e-1][r],n=0;n<o.length;n++){t=o[n].levelOrderName;for(var a=0;a<l.length;a++)if(l[a][i]=sf.base.isNullOrUndefined(l[a][i])?[]:l[a][i],-1!==t.indexOf(l[a].levelOrderName)){sf.base.isNullOrUndefined(o[n].parent)&&(o[n].parent=l[a]),l[a][i].push(o[n]);break}}this.findTotalWeight(ze.levelsData[ze.levelsData.length-1][i],"Child"),ze.levelsData.splice(e,1),e-1>0&&this.reOrderLevelData(e-1)},t.prototype.findTotalWeight=function(e,t){for(var i,r,o,l=this,n=new Object,a=function(a){i=0,o=e[a].groupName,r=e[a].levelOrderName.split("#"),s.dataSource.forEach((function(t){B(r,e[a].levelOrderName,t,l)&&(i+=parseFloat(t[l.weightValuePath]))})),"Parent"===t&&(n[o]=e,e[a].parent=n),e[a].weight=i},s=this,h=0;h<e.length;h++)a(h)},t.prototype.unWireEVents=function(){sf.base.EventHandler.remove(this.element,"click",this.clickOnTreeMap),sf.base.EventHandler.remove(this.element,"dblclick",this.doubleClickOnTreeMap),sf.base.EventHandler.remove(this.element,"contextmenu",this.rightClickOnTreeMap),sf.base.EventHandler.remove(this.element,sf.base.Browser.touchStartEvent,this.mouseDownOnTreeMap),sf.base.EventHandler.remove(this.element,sf.base.Browser.touchMoveEvent,this.mouseMoveOnTreeMap),sf.base.EventHandler.remove(this.element,sf.base.Browser.touchEndEvent,this.mouseEndOnTreeMap),sf.base.EventHandler.remove(this.element,"pointerleave mouseleave",this.mouseLeaveOnTreeMap),window.removeEventListener("resize",this.resizeOnTreeMap)},t.prototype.wireEVents=function(){sf.base.EventHandler.add(this.element,"click",this.clickOnTreeMap,this),sf.base.EventHandler.add(this.element,"dblclick",this.doubleClickOnTreeMap,this),sf.base.EventHandler.add(this.element,"contextmenu",this.rightClickOnTreeMap,this),sf.base.EventHandler.add(this.element,sf.base.Browser.touchStartEvent,this.mouseDownOnTreeMap,this),sf.base.EventHandler.add(this.element,sf.base.Browser.touchMoveEvent,this.mouseMoveOnTreeMap,this),sf.base.EventHandler.add(this.element,sf.base.Browser.touchEndEvent,this.mouseEndOnTreeMap,this),sf.base.EventHandler.add(this.element,"pointerleave mouseleave",this.mouseLeaveOnTreeMap,this),window.addEventListener("resize",this.resizeOnTreeMap.bind(this))},t.prototype.setCulture=function(){this.intl=new sf.base.Internationalization},t.prototype.addTabIndex=function(){this.element.setAttribute("aria-label",this.description||"TreeMap Element"),this.element.setAttribute("tabindex",this.tabIndex.toString())},t.prototype.resizeOnTreeMap=function(e){var t=this;this.isResize=!0;var i={name:"resize",cancel:!1,previousSize:this.availableSize,currentSize:new x(0,0),treemap:this.isBlazor?null:this};if(this.isBlazor){i.treemap;var r=Fe(i,["treemap"]);i=r}this.resizeTo&&clearTimeout(this.resizeTo),this.element.classList.contains("e-treemap")&&(this.resizeTo=setTimeout((function(){t.unWireEVents(),t.createSvg(),t.refreshing=!0,t.wireEVents(),i.currentSize=t.availableSize,t.trigger("resize",i,(function(e){t.render()}))}),500))},t.prototype.clickOnTreeMap=function(e){var t,i,r=this,o=e.target,l=o.id,n=o.innerHTML,a={cancel:!1,name:"click",treemap:this,mouseEvent:e},s={cancel:!1,name:"click",mouseEvent:e};if(this.trigger("click",this.isBlazor?s:a),l.indexOf("_Item_Index")>-1){if(e.preventDefault(),i=parseFloat(l.split("_")[6]),t={cancel:!1,name:"itemClick",treemap:this,item:this.layout.renderItems[i],mouseEvent:e,groupIndex:this.layout.renderItems[i].groupIndex,groupName:this.layout.renderItems[i].name,text:n,contentItemTemplate:n},this.isBlazor){t.item.groupIndex,t.item.groupName,t.item.isDrilled,t.item.isLeafItem,t.item.itemArea,t.item.levelOrderName,t.item.name,t.item.options,t.item.rect;t.item=this.layout.renderItems[i].data;t.treemap;t=Fe(t,["treemap"])}this.trigger("itemClick",t,(function(e){if(e.text!==n||e.contentItemTemplate!==n)if(sf.base.isNullOrUndefined(r.leafItemSettings.labelTemplate))e.text=se(e.text,e.item.data,e.treemap),o.innerHTML=e.text;else{var t=l.split("_RectPath")[0],i=void 0;if(i=l.indexOf("_LabelTemplate")>-1?o:document.querySelector("#"+t+"_LabelTemplate"),!sf.base.isNullOrUndefined(i)){if(r.isBlazor){var a=sf.base.createElement("div");a.innerHTML=e.contentItemTemplate;var s=a.children[0].firstElementChild;i.style.left=Number(i.style.left.split("px")[0])-s.style.width.split("px")[0]/2+"px",i.style.top=Number(i.style.top.split("px")[0])-s.style.height.split("px")[0]/2+"px"}i.innerHTML=e.contentItemTemplate}}}))}var h,d=(new Date).getMilliseconds();sf.base.isNullOrUndefined(this.doubleClick)||(!sf.base.isNullOrUndefined(h)&&d-h<500&&this.doubleClickOnTreeMap(e),h=d)},t.prototype.doubleClickOnTreeMap=function(e){var t={cancel:!1,name:"doubleClick",treemap:this,mouseEvent:e},i={cancel:!1,name:"doubleClick",mouseEvent:e};this.trigger("doubleClick",this.isBlazor?i:t)},t.prototype.rightClickOnTreeMap=function(e){var t={cancel:!1,name:"rightClick",treemap:this,mouseEvent:e},i={cancel:!1,name:"rightClick",mouseEvent:e};this.trigger("rightClick",this.isBlazor?i:t)},t.prototype.mouseDownOnTreeMap=function(e){e.target.id.indexOf("_Item_Index")>-1&&(this.mouseDown=!0),this.notify(sf.base.Browser.touchStartEvent,e)},t.prototype.mouseMoveOnTreeMap=function(e){var t,i,r,o=e.target.id,l={cancel:!1,name:"mouseMove",treemap:this,mouseEvent:e},n={cancel:!1,name:"mouseMove",mouseEvent:e};if(this.trigger("mouseMove",this.isBlazor?n:l),o.indexOf("_Item_Index")>-1){if(r=R(i=this.layout.renderItems[parseFloat(o.split("_")[6])]).values,this.element.style.cursor=!i.isLeafItem&&r&&r.length>0&&this.enableDrillDown?"pointer":"auto",t={cancel:!1,name:"itemMove",treemap:this,item:i,mouseEvent:e},this.isBlazor){var a={isLeafItem:t.item.isLeafItem,groupIndex:t.item.groupIndex,groupName:t.item.groupName,isDrilled:t.item.isDrilled,itemArea:t.item.itemArea,levelOrderName:t.item.levelOrderName,name:t.item.name,rect:t.item.rect,options:t.item.options};t.item=a;t.treemap;t=Fe(t,["treemap"])}this.trigger("itemMove",t)}this.notify(sf.base.Browser.touchMoveEvent,e)},t.prototype.calculateSelectedTextLevels=function(e,t){for(var i,r,o,l=t.levelOrderName.split("#"),n=0,a=Object.keys(l);n<a.length;n++)l[r=a[n]]===e&&(i=parseInt(r,10),o=e);return{drillLevel:i,currentLevelLabel:o,levelText:l}},t.prototype.calculatePreviousLevelChildItems=function(e,t,i,r){for(var o,l,n,a=0,s=this.layout.renderItems[0].levelOrderName.split("#").length,h=0;h<s;h++)n=0===h?t.levelText[h]:n+"#"+t.levelText[h];a=s>1?s:a;for(var d=0,p=Object.values(this.layout.renderItems);d<p.length;d++){(l=p[d]).levelOrderName.split("#")[0]===t.levelText[0]&&(o=0===a?sf.base.isNullOrUndefined(n)?n:t.levelText[a]:r?n:n+"#"+t.levelText[a])===l.levelOrderName&&(this.drilledItems.push({name:l.levelOrderName,data:l}),r=!0,++a<=i.groupIndex&&(n=o=o+"#"+t.levelText[a]))}return r},t.prototype.compareSelectedLabelWithDrillDownItems=function(e,t,i){var r,o=new Object;return e.drillLevel+1===this.drilledItems[i].data.groupIndex?((r=this.drilledItems[i].data.parent).isDrilled=!0,o[r[this.drilledItems[i].data.groupName]]=[r],this.drilledItems.splice(i,this.drilledItems.length)):e.drillLevel!==this.drilledItems.length-1&&e.drillLevel!==t.groupIndex||(o[t.groupName]=[t]),o},t.prototype.mouseEndOnTreeMap=function(e){var t,i,r,o,l,n,a,s,h=this,d=e.target,p=d.id,c=!1,g=new Object,m=this.element.id+"_TreeMap_"+this.layoutType+"_Layout",u=this.element.id+"_Label_Template_Group";if(p.indexOf("_Item_Index")>-1&&this.enableDrillDown&&!this.drillMouseMove){e.preventDefault(),o=parseFloat(p.split("_")[6]),l=this.layout.renderItems[o];var f=d.innerHTML;if(this.enableBreadcrumb&&(a=this.calculateSelectedTextLevels(f,l),n=a.drillLevel,this.drillDownView||-1===f.search("[+]")||(c=this.calculatePreviousLevelChildItems(f,a,l,c))),0!==this.levels.length&&!l.isLeafItem&&R(l).values&&R(l).values.length>0){if(this.drilledItems.length>0){l=c?this.drilledItems[this.drilledItems.length-1].data:l;for(var y=0;y<this.drilledItems.length;y++){if(!sf.base.isNullOrUndefined(n)){var v=this.drilledItems.length;if(g=this.compareSelectedLabelWithDrillDownItems(a,l,y),v!==this.drilledItems.length){y-=1;break}}if(l.levelOrderName===this.drilledItems[y].name&&!c&&sf.base.isNullOrUndefined(n)){0===l.groupIndex&&l.parent[l.groupName]instanceof Array?(l.isDrilled=!l.isDrilled,l.isDrilled?g[l.groupName]=[l]:g=l.parent):(l.isDrilled=!1,l.parent.isDrilled=!0,l=l.parent,g[l.groupName]=[l]),this.drilledItems.splice(y,1),y-=1;break}y===this.drilledItems.length-1&&sf.base.isNullOrUndefined(n)&&(l.isDrilled=!0,g[l.groupName]=[l])}}else l.isDrilled=!0,g[l.groupName]=[l];if(i={cancel:!1,name:"drillStart",treemap:this.isBlazor?null:this,element:d,groupIndex:this.enableBreadcrumb&&0!==this.drilledItems.length&&!sf.base.isNullOrUndefined(n)?this.drilledItems[this.drilledItems.length-1].data.groupIndex:l.groupIndex,groupName:this.enableBreadcrumb&&0!==this.drilledItems.length&&!sf.base.isNullOrUndefined(n)?this.drilledItems[this.drilledItems.length-1].data.name:l.name,rightClick:3===e.which,childItems:null,item:this.isBlazor?null:g},this.isBlazor){i.treemap;i=Fe(i,["treemap"])}this.trigger("drillStart",i,(function(e){if(h.currentLevel=l.isDrilled&&sf.base.isNullOrUndefined(n)?l.groupIndex:!sf.base.isNullOrUndefined(n)&&h.enableBreadcrumb&&l.isDrilled?n:null,!e.cancel){if(document.getElementById(m)){var i=document.getElementById(m);i.parentNode.removeChild(i)}if(t=sf.base.extend({},h.areaRect,t,!0),h.legendSettings.visible&&!sf.base.isNullOrUndefined(h.treeMapLegendModule)&&(sf.base.isNullOrUndefined(g)||(h.treeMapLegendModule.legendGroup.textContent="",h.treeMapLegendModule.legendGroup=null,h.treeMapLegendModule.widthIncrement=0,h.treeMapLegendModule.heightIncrement=0,h.enableBreadcrumb&&!sf.base.isNullOrUndefined(n)?h.drilledLegendItems={name:h.drilledItems[h.drilledItems.length-1].data.levelOrderName,data:h.drilledItems[h.drilledItems.length-1].data}:h.drilledLegendItems={name:l.levelOrderName,data:l},h.treeMapLegendModule.renderLegend()),t=sf.base.isNullOrUndefined(h.totalRect)?t:h.totalRect),document.getElementById(u)){var r=document.getElementById(u);r.parentNode.removeChild(r)}sf.base.isNullOrUndefined(e.childItems)||e.cancel?(h.layout.calculateLayoutItems(g,t),h.layout.renderLayoutItems(g)):h.layout.onDemandProcess(e.childItems)}})),r={cancel:!1,name:"drillEnd",treemap:this,renderItems:this.layout.renderItems},s={cancel:!1,name:"drillEnd",renderItems:this.isBlazor?null:this.layout.renderItems},this.trigger("drillEnd",this.isBlazor?s:r),!c&&sf.base.isNullOrUndefined(n)&&this.drilledItems.push({name:l.levelOrderName,data:l})}}this.mouseDown=!1,this.notify(sf.base.Browser.touchEndEvent,e)},t.prototype.mouseLeaveOnTreeMap=function(e){this.treeMapTooltipModule&&this.treeMapTooltipModule.removeTooltip(),this.treeMapLegendModule&&this.treeMapLegendModule.removeInteractivePointer(),ne(document.getElementsByClassName("treeMapHighLight"),"treeMapHighLight",this),this.treeMapHighlightModule&&(be(this.treeMapHighlightModule.shapeHighlightCollection),this.treeMapHighlightModule.highLightId="")},t.prototype.selectItem=function(e,t){sf.base.isNullOrUndefined(t)&&(t=!0);for(var i="",r=0;r<e.length;r++)r!==e.length-1?i+=e[r]+"#":i+=e[r];this.treeMapSelectionModule&&this.selectionSettings.enable&&this.treeMapSelectionModule.selectTreemapItem(i,t)},t.prototype.requiredModules=function(){var e=[];return this.tooltipSettings.visible&&e.push({member:"treeMapTooltip",args:[this]}),this.highlightSettings.enable&&e.push({member:"treeMapHighlight",args:[this]}),this.selectionSettings.enable&&e.push({member:"treeMapSelection",args:[this]}),this.legendSettings.visible&&e.push({member:"treeMapLegend",args:[this]}),this.allowPrint&&e.push({member:"Print",args:[this,Ee]}),this.allowImageExport&&e.push({member:"ImageExport",args:[this,De]}),this.allowPdfExport&&e.push({member:"PdfExport",args:[this,_e]}),e},t.prototype.onPropertyChanged=function(e,t){for(var i=!1,r=0,o=Object.keys(e);r<o.length;r++){switch(o[r]){case"background":this.renderBorder();break;case"height":case"width":case"layoutType":case"levels":case"drillDownView":case"renderDirection":case"leafItemSettings":case"legendSettings":case"dataSource":i=!0}}i&&(this.createSvg(),this.render())},t.prototype.getModuleName=function(){return"treemap"},t.prototype.destroy=function(){this.unWireEVents(),this.drilledItems=[],this.levelSelection=[],this.legendId=[],this.removeSvg(),e.prototype.destroy.call(this)},t.prototype.removeSvg=function(){if(Le(this.element.id+"_Secondary_Element"),this.svgObject){for(;this.svgObject.childNodes.length>0;)this.svgObject.removeChild(this.svgObject.firstChild);!this.svgObject.hasChildNodes()&&this.svgObject.parentNode&&sf.base.remove(this.svgObject)}},t.prototype.getPersistData=function(){return""},Re([sf.base.Property(!1)],t.prototype,"allowPrint",void 0),Re([sf.base.Property(!1)],t.prototype,"allowImageExport",void 0),Re([sf.base.Property(!1)],t.prototype,"allowPdfExport",void 0),Re([sf.base.Property(null)],t.prototype,"width",void 0),Re([sf.base.Property(null)],t.prototype,"height",void 0),Re([sf.base.Complex({},n)],t.prototype,"border",void 0),Re([sf.base.Complex({},a)],t.prototype,"margin",void 0),Re([sf.base.Property(null)],t.prototype,"background",void 0),Re([sf.base.Property("Material")],t.prototype,"theme",void 0),Re([sf.base.Complex({},p)],t.prototype,"titleSettings",void 0),Re([sf.base.Property("Squarified")],t.prototype,"layoutType",void 0),Re([sf.base.Property(null)],t.prototype,"dataSource",void 0),Re([sf.base.Property(null)],t.prototype,"query",void 0),Re([sf.base.Property(null)],t.prototype,"weightValuePath",void 0),Re([sf.base.Property("")],t.prototype,"rangeColorValuePath",void 0),Re([sf.base.Property("")],t.prototype,"equalColorValuePath",void 0),Re([sf.base.Property(null)],t.prototype,"colorValuePath",void 0),Re([sf.base.Property([])],t.prototype,"palette",void 0),Re([sf.base.Property("TopLeftBottomRight")],t.prototype,"renderDirection",void 0),Re([sf.base.Property(!1)],t.prototype,"enableDrillDown",void 0),Re([sf.base.Property(!1)],t.prototype,"enableBreadcrumb",void 0),Re([sf.base.Property(" - ")],t.prototype,"breadcrumbConnector",void 0),Re([sf.base.Property(!1)],t.prototype,"drillDownView",void 0),Re([sf.base.Complex({},m)],t.prototype,"initialDrillDown",void 0),Re([sf.base.Complex({},u)],t.prototype,"leafItemSettings",void 0),Re([sf.base.Collection([],b)],t.prototype,"levels",void 0),Re([sf.base.Complex({},v)],t.prototype,"highlightSettings",void 0),Re([sf.base.Complex({},y)],t.prototype,"selectionSettings",void 0),Re([sf.base.Complex({},f)],t.prototype,"tooltipSettings",void 0),Re([sf.base.Complex({},g)],t.prototype,"legendSettings",void 0),Re([sf.base.Property(!1)],t.prototype,"useGroupingSeparator",void 0),Re([sf.base.Property(null)],t.prototype,"description",void 0),Re([sf.base.Property(1)],t.prototype,"tabIndex",void 0),Re([sf.base.Property(null)],t.prototype,"format",void 0),Re([sf.base.Event()],t.prototype,"load",void 0),Re([sf.base.Event()],t.prototype,"beforePrint",void 0),Re([sf.base.Event()],t.prototype,"loaded",void 0),Re([sf.base.Event()],t.prototype,"itemRendering",void 0),Re([sf.base.Event()],t.prototype,"drillStart",void 0),Re([sf.base.Event()],t.prototype,"drillEnd",void 0),Re([sf.base.Event()],t.prototype,"itemSelected",void 0),Re([sf.base.Event()],t.prototype,"itemHighlight",void 0),Re([sf.base.Event()],t.prototype,"tooltipRendering",void 0),Re([sf.base.Event()],t.prototype,"itemClick",void 0),Re([sf.base.Event()],t.prototype,"itemMove",void 0),Re([sf.base.Event()],t.prototype,"click",void 0),Re([sf.base.Event()],t.prototype,"doubleClick",void 0),Re([sf.base.Event()],t.prototype,"rightClick",void 0),Re([sf.base.Event()],t.prototype,"mouseMove",void 0),Re([sf.base.Event()],t.prototype,"resize",void 0),Re([sf.base.Event()],t.prototype,"legendItemRendering",void 0),Re([sf.base.Event()],t.prototype,"legendRendering",void 0),t=Re([sf.base.NotifyPropertyChanges],t)}(sf.base.Component),ze=function(){},Ue=function(e,t){var i={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(i[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&(i[r[o]]=e[r[o]])}return i},Ae=function(){function e(e){this.page=0,this.legendBorderRect=new S(0,0,0,0),this.currentPage=0,this.heightIncrement=0,this.widthIncrement=0,this.textMaxWidth=0,this.legendInteractiveGradient=[],this.legendItemRect=new S(0,0,0,0),this.treemap=e,this.addEventListener()}return e.prototype.renderLegend=function(){var e,t=this;if(this.legendRenderingCollections=[],this.legendCollections=[],this.legendNames=[],this.totalPages=[],this.gradientCount=1,this.widthIncrement=0,this.heightIncrement=0,this.defsElement=this.treemap.renderer.createDefs(),this.treemap.svgObject.appendChild(this.defsElement),e={cancel:!1,name:"legendRendering",treemap:this.treemap,_changePosition:this.treemap.legendSettings.position,position:this.treemap.legendSettings.position},this.treemap.isBlazor){e.treemap;e=Ue(e,["treemap"])}this.treemap.trigger("legendRendering",e,(function(e){e.cancel||e._changePosition===t.treemap.legendSettings.position||(t.treemap.legendSettings.position=e._changePosition),t.calculateLegendBounds(),t.legendCollections.length>0&&t.drawLegend()}))},e.prototype.calculateLegendBounds=function(){var e=this,t=this.treemap,i=t.legendSettings;if(this.findColorMappingLegendItems(ze.levelsData[0]),(this.treemap.palette.length>0||!sf.base.isNullOrUndefined(this.treemap.colorValuePath))&&0===this.legendCollections.length&&this.findPaletteLegendItems(ze.levelsData[0],"Parent"),this.legendCollections.length>0){var r=i.position,o=i.title.text,l=i.titleStyle,n=i.mode,a=0,s=0,h=0,d=0,p=i.shapeHeight,c=i.shapeWidth,g=[],m=[],u="None"===i.orientation?"Top"===r||"Bottom"===r||"Auto"===r&&t.availableSize.width<=t.availableSize.height?"Horizontal":"Vertical":i.orientation,f=i.width.length>1?i.width.indexOf("%")>-1?t.availableSize.width/100*parseFloat(i.width):parseFloat(i.width):null,y=i.height.length>1?i.height.indexOf("%")>-1?t.availableSize.height/100*parseFloat(i.height):parseFloat(i.height):null;l.fontFamily=t.themeStyle.fontFamily||l.fontFamily,l.size=t.themeStyle.legendFontSize||l.size;var v=C(o,l),b=0,w=0,I=i.shapePadding;i.textStyle,this.legendCollections.length;if(i.textStyle.size=t.themeStyle.legendFontSize||i.textStyle.size,i.textStyle.fontFamily=t.themeStyle.fontFamily||i.textStyle.fontFamily,"Default"===n){f=sf.base.isNullOrUndefined(f)?t.areaRect.width:f,y=sf.base.isNullOrUndefined(y)?t.areaRect.height:y;for(var O=0,L=0;L<this.legendCollections.length;L++){var M=this.legendCollections[L];sf.base.isNullOrUndefined(this.totalPages[this.page])&&(this.totalPages[this.page]={Page:this.page+1,Collection:[]});var N=C(M.legendName,i.textStyle);if(this.textMaxWidth=Math.max(this.textMaxWidth,N.width),0===L)b=a=10+c/2,w=s=10+v.height+(p>N.height?p/2:N.height/4);else{var T=N.height>p?N.height:p;if("Horizontal"===u){var E=m[O-1].x+m[O-1].width+10+c;if(E+I+N.width>f){var D=(m[O-1].y>g[O-1].y+p/2?m[O-1].y:g[O-1].y+p/2)+10;D+T>y?(this.getPageChanged(),O=0,g=[],m=[],a=b,s=w):(a=g[0].x,s=D+T/2)}else a=E-c/2,s=g[O-1].y}else{var _=m[O-1].y>g[O-1].y+p/2?m[O-1].y:g[O-1].y+p/2;if(_+10+T>y){var B=m[O-1].x+this.textMaxWidth+10;B+I+N.width>f?(a=b,s=w,m=[],g=[],this.getPageChanged(),O=0):(a=B+c/2,s=g[0].y)}else a=g[O-1].x,s=_+10+p/2}}h=a+c/2+I,d=s+N.height/4,g.push({x:a,y:s}),m.push({x:h,y:d,width:N.width,height:N.height/2}),this.totalPages[this.page].Collection.push({DisplayText:M.legendName,element:M.gradientElement,Shape:{x:a,y:s},Text:{x:h,y:d},Fill:M.legendFill,Data:M.legendData,Rect:{x:g[O].x-c/2,y:g[O].y-p/2<d-N.height?g[O].y-p/2:d-N.height,width:Math.abs(g[O].x-c/2-(h+N.width)),height:p>N.height?p:N.height}}),O++}var R=this.totalPages[0].Collection;R.forEach((function(t,i){var r=new S(t.Rect.x,t.Rect.y,t.Rect.width,t.Rect.height);0===i&&(b=r.x,w=r.y),e.widthIncrement=Math.max(e.widthIncrement,Math.abs(b-(r.x+r.width))),e.heightIncrement=Math.max(e.heightIncrement,Math.abs(w-(r.y+r.height)))})),f=this.widthIncrement<f?this.widthIncrement:f,y=this.heightIncrement<y?this.heightIncrement:y,this.legendItemRect={x:R[0].Rect.x,y:R[0].Rect.y,width:f,height:y}}else{var F,H,z=i.textStyle,U=this.legendCollections.length;F="Horizontal"===u?sf.base.isNullOrUndefined(f)?t.areaRect.width/U:f/U:sf.base.isNullOrUndefined(f)?25:f,H="Horizontal"===u?sf.base.isNullOrUndefined(y)?25:y:sf.base.isNullOrUndefined(y)?t.areaRect.height/U:y/U,b=0,w=v.height+10;var A=i.labelPosition,k=0,j=0,G=i.labelDisplayMode,V=0,W=0;for(L=0;L<this.legendCollections.length;L++){b="Horizontal"===u?b+F:b,w="Horizontal"===u?w:w+H;var q=this.legendCollections[L].legendName,J=new x(0,0);"None"===G?J=C(q,z):"Trim"===G?J=C(q=P("Horizontal"===u?F:H,q,z),z):q="",V=Math.max(V,J.height),W=Math.max(W,J.width),J.width>0&&J.height>0&&("Horizontal"===u?(h=b+F/2,d="After"===A?w+H+J.height/2+10:w-10):(h="After"===A?b-J.width/2-10:b+F+J.width/2+10,d=w+H/2+J.height/4)),0===L&&(k="Horizontal"===u?b:"After"===A?h-J.width/2:b,j="Horizontal"===u?"After"===A?w:d-J.height/2:w),L===U-1&&(f="Horizontal"===u?Math.abs(b+F-k):F+W+10,y="Horizontal"===u?H+V/2+10:Math.abs(w+H-j)),this.legendRenderingCollections.push({fill:this.legendCollections[L].legendFill,x:b,y:w,width:F,height:H,element:this.legendCollections[L].gradientElement,text:q,textX:h,textY:d,textWidth:J.width,textHeight:J.height,data:this.legendCollections[L].legendData})}this.legendItemRect={x:k,y:j,width:f,height:y}}}},e.prototype.getPageChanged=function(){this.page++,sf.base.isNullOrUndefined(this.totalPages[this.page])&&(this.totalPages[this.page]={Page:this.page+1,Collection:[]})},e.prototype.findColorMappingLegendItems=function(e){var t=R(e).values;if(t&&t.length>0&&(this.calculateLegendItems(t),this.treemap.levels.length>0))for(var i=0;i<t.length;i++)this.findColorMappingLegendItems(t[i])},e.prototype.findPaletteLegendItems=function(e,t){var i,r,o;if(!sf.base.isNullOrUndefined(this.treemap.drilledItems)&&0===this.treemap.drilledItems.length&&!sf.base.isNullOrUndefined(this.treemap.initialDrillDown.groupName)&&sf.base.isNullOrUndefined(this.treemap.drilledLegendItems))for(var l=R(e).values,n=0;n<l.length;n++)if(l[n].Name===this.treemap.initialDrillDown.groupName){l[n].isDrilled=!l[n].isDrilled,e=l[n],this.treemap.currentLevel=this.treemap.initialDrillDown.groupIndex,r=this.treemap.palette.length>0?this.treemap.palette[n%this.treemap.palette.length]:l[n].data[this.treemap.colorValuePath];break}if(this.treemap.enableDrillDown&&!sf.base.isNullOrUndefined(this.treemap.drilledLegendItems)){var a=this.treemap.drilledLegendItems;if(r=a.data.options.fill,a.data.isDrilled)i=R(a.data).values;else i=R(a.data.parent).values}else i=R(e).values;if(i&&i.length>0){for(var s=0;s<i.length;s++)(sf.base.isNullOrUndefined(i[s].data[this.treemap.legendSettings.showLegendPath])||i[s].data[this.treemap.legendSettings.showLegendPath])&&(o=i[s].data[this.treemap.legendSettings.valuePath]?i[s].data[this.treemap.legendSettings.valuePath]:i[s].name,!!this.treemap.legendSettings.removeDuplicateLegend&&this.removeDuplicates(this.legendCollections,o)||this.legendCollections.push({legendName:o,legendFill:this.treemap.palette.length>0?sf.base.isNullOrUndefined(this.treemap.currentLevel)?this.treemap.palette[s%this.treemap.palette.length]:r:i[s].data[this.treemap.colorValuePath],legendData:[],itemArea:i[s].weight}));if(this.legendCollections.sort(re),this.treemap.palette.length>0)for(var h=0;h<this.legendCollections.length;h++)this.legendCollections[h].legendFill=sf.base.isNullOrUndefined(this.treemap.currentLevel)?this.treemap.palette[h%this.treemap.palette.length]:r}},e.prototype.calculateLegendItems=function(e){var t,i,r,o,l,n,a,s,h,d,p,c,g,m,u,f,y,v=!1,b=this.treemap.leafItemSettings,x=this.treemap.levels,w=this.treemap.legendSettings.position,S=!1,I=0;this.outOfRangeLegend=null;for(var O=0;O<e.length;O++){i="",g=!1,m=!1,S=!1,o=e[O].data,n=e[O].groupIndex;for(var C=0,L=0===this.treemap.levels.length||n===this.treemap.levels.length?b.colorMapping:x[n].colorMapping;C<L.length;C++){var P=L[C];if(s=null,r=Number(o[this.treemap.rangeColorValuePath]),a=o[this.treemap.equalColorValuePath],P.value=sf.base.isNullOrUndefined(P.value)?P.value:P.value.toString(),!sf.base.isNullOrUndefined(P.from)&&!sf.base.isNullOrUndefined(P.to)&&r>=P.from&&r<=P.to&&P.showLegend?(v=!0,m=!0,p=P.from+" - "+P.to,l=sf.base.isNullOrUndefined(P.label)?P.from+" - "+P.to:P.label,i=sf.base.isNullOrUndefined(P.color)?i:P.color,t=this.isAddNewLegendData(p)):!sf.base.isNullOrUndefined(P.value)&&a===P.value&&P.showLegend&&(v=!0,g=!0,p=P.value.toString(),l=sf.base.isNullOrUndefined(P.label)?P.value.toString():P.label,i=sf.base.isNullOrUndefined(P.color)?i:"[object Array]"===Object.prototype.toString.call(P.color)?P.color[0]:P.color,t=this.isAddNewLegendData(p)),v&&sf.base.isNullOrUndefined(P.value)&&P.maxOpacity&&P.minOpacity&&"Interactive"===this.treemap.legendSettings.mode){var M,N=[];if(S=!0,"[object Array]"===Object.prototype.toString.call(P.color))for(var T=0;T<P.color.length;T++){var E={colorStop:(T*(100/(P.color.length-1))+"%").toString(),color:P.color[T]};N.push(E)}else{E={colorStop:"0%",color:i};var D={colorStop:"100%",color:i};N.push(E),N.push(D)}h="Top"===w||"Bottom"===w?"100%":"0%",d="Top"===w||"Bottom"===w?"0%":"100%",M={id:"groupIndex_"+n+"_colorIndex_"+this.gradientCount,x1:"0%",y1:"0%",x2:h,y2:d},s=this.treemap.renderer.drawGradient("linearGradient",M,N).childNodes[0],"[object Array]"!==Object.prototype.toString.call(P.color)&&(s.childNodes[0].setAttribute("stop-opacity",P.minOpacity.toString()),s.childNodes[1].setAttribute("stop-opacity",P.maxOpacity.toString())),this.defsElement.appendChild(s),this.gradientCount++}c=!!this.treemap.legendSettings.removeDuplicateLegend&&this.removeDuplicates(this.legendCollections,l),t&&t.process&&v&&!c?(v=!1,i="[object Array]"===Object.prototype.toString.call(P.color)&&sf.base.isNullOrUndefined(s)&&sf.base.isNullOrUndefined(P.value)?this.legendGradientColor(P,I):i,this.legendCollections.push({actualValue:p,legendName:l,legendFill:i,legendData:[],gradientElement:sf.base.isNullOrUndefined(s)?sf.base.isNullOrUndefined(P.value)?this.legendLinearGradient:null:s,name:e[O].name,opacity:this.treemap.legendSettings.opacity,borderColor:this.treemap.legendSettings.border.color,borderWidth:this.treemap.legendSettings.border.width}),this.legendCollections[this.legendCollections.length-1].legendData.push(e[O]),I++):v&&!c&&(v=!1,this.legendCollections[t.value].legendData.push(e[O])),m||S||g||sf.base.isNullOrUndefined(P.from)&&sf.base.isNullOrUndefined(P.to)&&sf.base.isNullOrUndefined(P.minOpacity)&&sf.base.isNullOrUndefined(P.maxOpacity)&&sf.base.isNullOrUndefined(P.value)&&!sf.base.isNullOrUndefined(P.color)&&(u="[object Array]"===Object.prototype.toString.call(P.color)?P.color[0]:P.color,f=sf.base.isNullOrUndefined(P.label)?"Others":P.label,sf.base.isNullOrUndefined(this.outOfRangeLegend)&&(this.legendCollections.push({actualValue:f,legendData:[],legendName:f,legendFill:u}),y=this.legendCollections.length,this.outOfRangeLegend=this.legendCollections[y-1],I++),this.legendCollections[y-1].legendData.push(e[O]))}}},e.prototype.removeDuplicates=function(e,t){for(var i=!1,r=0;r<e.length;r++)if(e[r].legendName===t){i=!0;break}return i},e.prototype.isAddNewLegendData=function(e){var t,i;if(0===this.legendCollections.length)t=!0;else for(var r=0;r<this.legendCollections.length;r++){if(e===this.legendCollections[r].actualValue){t=!1,i=r;break}r===this.legendCollections.length-1&&(t=!0)}return{process:t,value:i}},e.prototype.drawLegend=function(){var e,t,i=this.treemap,r=i.legendSettings,o=i.renderer,l=r.textStyle;if(this.legendGroup=o.createGroup({id:i.element.id+"_Legend_Group"}),this.renderLegendBorder(),this.renderLegendTitle(),"Default"===r.mode)this.drawLegendItem(this.currentPage);else for(var n=0;n<this.legendRenderingCollections.length;n++){var a=i.element.id+"_Legend_Index_"+n,s=i.element.id+"_Legend_Index_"+n+"_Text",h=this.legendRenderingCollections[n];e=(t=h.element)?"url(#"+t.id+")":h.fill;var d=new S(h.x,h.y,h.width,h.height),p=new M(h.textX,h.textY),c=new I(a,e,r.shapeBorder,r.opacity,d);this.treemap.enableRtl&&("Left"===i.legendSettings.position||"Right"===i.legendSettings.position||"Auto"===i.legendSettings.position&&this.treemap.availableSize.width>=this.treemap.availableSize.height?(c.y=this.translate.y+this.legendBorderRect.y+this.legendBorderRect.height-(this.translate.y+c.height)-Math.abs(this.legendBorderRect.y-c.y),p.y=this.translate.y+this.legendBorderRect.y+this.legendBorderRect.height-this.translate.y+h.textHeight/2-Math.abs(this.legendBorderRect.y-p.y)):(c.x=this.translate.x+this.legendBorderRect.x+this.legendBorderRect.width-(this.translate.x+c.width)-Math.abs(this.legendBorderRect.x-c.x),p.x=this.translate.x+this.legendBorderRect.x+this.legendBorderRect.width-this.translate.x-Math.abs(this.legendBorderRect.x-p.x))),E(new L(s,p.x,p.y,"middle",h.text,"",""),l,l.color||this.treemap.themeStyle.legendTextColor,this.legendGroup),this.legendGroup.appendChild(o.drawRectangle(c))}le(this.treemap,this.legendGroup)},e.prototype.defaultLegendRtlLocation=function(e,t,i,r){var o=e.Shape,l=e.Text,n=C(e.DisplayText,r.textStyle);return o.x=this.translate.x+this.legendBorderRect.x+this.legendBorderRect.width-(this.translate.x+t)-Math.abs(this.legendBorderRect.x-o.x),l.x=this.translate.x+this.legendBorderRect.x+this.legendBorderRect.width-(this.translate.x+n.width+t)-Math.abs(this.legendBorderRect.x-l.x),("Left"===i.legendSettings.position||"Right"===i.legendSettings.position||"Auto"===i.legendSettings.position&&this.treemap.availableSize.width>=this.treemap.availableSize.height)&&(o.y=this.translate.y+this.legendBorderRect.y+this.legendBorderRect.height-this.translate.y-Math.abs(Math.abs(this.legendBorderRect.y)-o.y)-r.shapeHeight/2,l.y=this.translate.y+this.legendBorderRect.y+this.legendBorderRect.height-this.translate.y-Math.abs(Math.abs(this.legendBorderRect.y)-l.y)),{shapeLocation:o,textLocation:l}},e.prototype.drawLegendItem=function(e){var t,i,r=this,o=this.treemap,l=o.legendSettings,n=new x(l.shapeWidth,l.shapeHeight),a=o.renderer,s=l.shapeBorder;if(e>=0&&e<this.totalPages.length){document.getElementById(this.legendGroup.id)&&document.getElementById(this.legendGroup.id).remove();for(var h="HorizontalLine"===l.shape||"VerticalLine"===l.shape||"Cross"===l.shape,d=h?sf.base.isNullOrUndefined(l.fill)?"#000000":l.fill:s.color,p=h&&0===s.width?1:s.width,c=function(s){var c=g.totalPages[e].Collection[s],m=a.createGroup({id:o.element.id+"_Legend_Index_"+s}),u=c.DisplayText,f=o.element.id+"_Legend_Shape_Index_"+s,y=o.element.id+"_Legend_Text_Index_"+s,v=c.Shape,b=c.Text;if(o.enableRtl&&(t=g.defaultLegendRtlLocation(c,10,o,l),v=t.shapeLocation,b=t.textLocation),i={cancel:!1,name:"legendItemRendering",treemap:g.treemap.isBlazor?null:o,fill:c.Fill,shape:l.shape,imageUrl:l.imageUrl},g.treemap.isBlazor){i.treemap;var x=Ue(i,["treemap"]);i=x}g.treemap.trigger("legendItemRendering",i,(function(e){var t=new O(f,e.fill,p,h?c.Fill:d,l.opacity,"");m.appendChild(ue(v,e.shape,n,e.imageUrl,t,u)),E(new L(y,b.x,b.y,"start",u,"",""),l.textStyle,l.textStyle.color||r.treemap.themeStyle.legendTextColor,m),r.legendGroup.appendChild(m)}))},g=this,m=0;m<this.totalPages[e].Collection.length;m++)c(m);var u=void 0;if(0!==this.page){var f=e+1+"/"+this.totalPages.length,y=l.textStyle,v=C(f,y),b=this.legendItemRect.x+this.legendItemRect.width-v.width-20-10,w=this.legendItemRect.x+this.legendItemRect.width,P=this.legendItemRect.y+this.legendItemRect.height+2.5+10,M=w-10-v.width/2-5;u=a.createGroup({id:o.element.id+"_Legend_Paging_Group"});var N=a.createGroup({id:o.element.id+"_Legend_Left_Paging_Group"}),T=a.createGroup({id:o.element.id+"_Legend_Right_Paging_Group"}),D=" M "+w+" "+P+" L "+(w-10)+" "+(P-5)+" L "+(w-10)+" "+(P+5)+" z ",_=" M "+b+" "+P+" L "+(b+10)+" "+(P-5)+" L "+(b+10)+" "+(P+5)+" z ",B=new O(o.element.id+"_Left_Page","#a6a6a6",0,"#a6a6a6",1,"",_);N.appendChild(a.drawPath(B));var R=new I(o.element.id+"_Left_Page_Rect","transparent",{},1,new S(b-5,P-10,20,20),"");N.appendChild(a.drawRectangle(R)),this.wireEvents(N);var F=new O(o.element.id+"_Right_Page","#a6a6a6",0,"#a6a6a6",1,"",D);T.appendChild(a.drawPath(F));var H=new I(o.element.id+"_Right_Page_Rect","transparent",{},1,new S(w-10,P-5,10,10),"");T.appendChild(a.drawRectangle(H)),this.wireEvents(T),u.appendChild(N),u.appendChild(T);var z={id:o.element.id+"_Paging_Text",x:M,y:P+v.height/4,fill:"#a6a6a6","font-size":"14px","font-style":y.fontStyle,"font-family":y.fontFamily,"font-weight":y.fontWeight,"text-anchor":"middle",transform:"",opacity:1,"dominant-baseline":""};u.appendChild(a.createText(z,f)),this.legendGroup.appendChild(u)}}},e.prototype.renderLegendBorder=function(){var e=this.treemap,t=e.legendSettings,i=t.title.text,r=t.titleStyle,o=C(P(this.legendItemRect.width+20,i,r),r);this.legendBorderRect=new S(this.legendItemRect.x-10,this.legendItemRect.y-10-o.height,this.legendItemRect.width+20,this.legendItemRect.height+20+o.height+("Interactive"===t.mode?0:0!==this.page?10:0));var l=new I(e.element.id+"_Legend_Border",t.background,t.border,1,this.legendBorderRect,""),n=e.renderer.drawRectangle(l);n.style.pointerEvents="none",this.legendGroup.appendChild(n),this.getLegendAlignment(e,this.legendBorderRect.width,this.legendBorderRect.height,t),this.legendGroup.setAttribute("transform","translate( "+(this.translate.x+-this.legendBorderRect.x)+" "+(this.translate.y+-this.legendBorderRect.y)+" )"),e.svgObject.appendChild(this.legendGroup)},e.prototype.renderLegendTitle=function(){var e=this.treemap,t=e.legendSettings,i=t.titleStyle,r=t.title.text,o=P(this.legendItemRect.width+20,r,i),l=C(o,i);r&&E(new L(e.element.id+"_LegendTitle",this.legendItemRect.x+this.legendItemRect.width/2,this.legendItemRect.y-l.height/2-5,"middle",o,""),i,i.color||this.treemap.themeStyle.legendTitleColor,this.legendGroup)},e.prototype.renderInteractivePointer=function(e){var t,i=this.treemap,r=e.target,o=i.element.id+"_Interactive_Legend";r=e.type.indexOf("touch")>-1?document.elementFromPoint(e.changedTouches[0].clientX,e.changedTouches[0].clientY):r;var l=i.legendSettings;if(r.id.indexOf("_Item_Index")>-1&&l.visible&&this.legendRenderingCollections.length>0){var n=void 0,a=void 0,s=void 0,h=void 0,d=void 0,p=void 0,c=void 0;t=i.layout.renderItems[parseFloat(r.id.split("_")[6])];for(var g=i.svgObject.getBoundingClientRect(),m=0;m<this.legendCollections.length;m++){n=this.legendCollections[m],a=(c=document.getElementById(i.element.id+"_Legend_Index_"+m)).getBoundingClientRect();var u=new S(Math.abs(a.left-g.left),Math.abs(a.top-g.top),a.width,a.height);if(h=c.getAttribute("fill"),d=l.shapeBorder.color,p=l.shapeBorder.width,!sf.base.isNullOrUndefined(n.legendData)){s=n.legendData;for(var f=0;f<s.length;f++)if(s[f].levelOrderName===t.levelOrderName){this.drawInteractivePointer(l,h,d,o,p,u);break}}}}else this.removeInteractivePointer()},e.prototype.drawInteractivePointer=function(e,t,i,r,o,l){var n,a,s,h;n="Horizontal"===("None"===e.orientation?"Top"===e.position||"Bottom"===e.position?"Horizontal":"Vertical":e.orientation)?e.invertedPointer?" M "+(s=l.x+l.width/2)+" "+(h=l.y+l.height)+" L "+(s-10)+" "+(h+10)+" L "+(s+10)+" "+(h+10)+" Z ":" M "+(s=l.x+l.width/2)+" "+(h=l.y)+" L "+(s-10)+" "+(h-10)+" L "+(s+10)+" "+(h-10)+" Z ":e.invertedPointer?" M "+(s=l.x)+" "+(h=l.y+l.height/2)+" L "+(s-10)+" "+(h-10)+" L "+(s-10)+" "+(h+10)+" z ":" M "+(s=l.x+l.width)+" "+(h=l.y+l.height/2)+" L "+(s+10)+" "+(h-10)+" L "+(s+10)+" "+(h+10)+" z ",a=new O(r,t,o,i,1,"",n),this.treemap.svgObject.appendChild(this.treemap.renderer.drawPath(a))},e.prototype.getLegendAlignment=function(e,t,i,r){var o,l,n,a=(n=sf.base.extend({},e.areaRect,n,!0)).x,s=n.y,h=n.height,d=n.width,p=e.availableSize.width,c=e.availableSize.height,g="Auto"===r.position?p>c?"Right":"Bottom":r.position;if("Float"===r.position)this.translate=r.location;else{switch(g){case"Top":case"Bottom":n.height=h-i,o=p/2-t/2,l="Top"===g?s:s+n.height+10,n.y="Top"===g?s+i+10:s;break;case"Left":case"Right":n.width=d-t,o="Left"===g?a:a+n.width,l=c/2-i/2,n.x="Left"===g?a+t:a}switch(r.alignment){case"Near":"Top"===g||"Bottom"===g?o=n.x:l=n.y;break;case"Far":"Top"===g||"Bottom"===g?o=p-t:l=c-i}this.treemap.totalRect=n,this.translate=new M(o,l)}},e.prototype.mouseUpHandler=function(e){this.renderInteractivePointer(e),clearTimeout(this.clearTimeout),this.clearTimeout=setTimeout(this.removeInteractivePointer.bind(this),3e3)},e.prototype.removeInteractivePointer=function(){if(document.getElementById(this.treemap.element.id+"_Interactive_Legend")){var e=document.getElementById(this.treemap.element.id+"_Interactive_Legend");e.parentNode.removeChild(e)}},e.prototype.changeNextPage=function(e){this.currentPage=e.target.id.indexOf("_Left_Page_")>-1?this.currentPage-1:this.currentPage+1,this.drawLegend()},e.prototype.wireEvents=function(e){sf.base.EventHandler.add(e,sf.base.Browser.touchStartEvent,this.changeNextPage,this)},e.prototype.addEventListener=function(){this.treemap.isDestroyed||(this.treemap.on(sf.base.Browser.touchMoveEvent,this.renderInteractivePointer,this),this.treemap.on(sf.base.Browser.touchEndEvent,this.mouseUpHandler,this))},e.prototype.removeEventListener=function(){this.treemap.isDestroyed||(this.treemap.off(sf.base.Browser.touchMoveEvent,this.renderInteractivePointer),this.treemap.off(sf.base.Browser.touchEndEvent,this.mouseUpHandler))},e.prototype.getModuleName=function(){return"treeMapLegend"},e.prototype.destroy=function(e){this.removeEventListener()},e.prototype.legendGradientColor=function(e,t){var i,r="http://www.w3.org/2000/svg";if(!sf.base.isNullOrUndefined(e.color)&&"[object Array]"===Object.prototype.toString.call(e.color)){var o,l,n=this.treemap.renderer.createDefs(),a=document.createElementNS(r,"linearGradient"),s=this.treemap.legendSettings.position;o="Top"===s||"Bottom"===s?"100":"0",l="Top"===s||"Bottom"===s?"0":"100",a.setAttribute("id","linear_"+t),a.setAttribute("x1","0%"),a.setAttribute("y1","0%"),a.setAttribute("x2",o+"%"),a.setAttribute("y2",l+"%");for(var h=0;h<e.color.length;h++){var d=100/(e.color.length-1),p=document.createElementNS(r,"stop");p.setAttribute("offset",h*d+"%"),p.setAttribute("stop-color",e.color[h]),p.setAttribute("stop-opacity",1..toString()),a.appendChild(p)}n.appendChild(a),this.legendLinearGradient=a;var c="url(#linear_"+t+")";this.defsElement.appendChild(a),i=c}return i},e}(),ke=function(e,t){var i={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(i[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&(i[r[o]]=e[r[o]])}return i},je=function(){function e(e){this.target="highlight",this.shapeTarget="highlight",this.shapeHighlightCollection=[],this.legendHighlightCollection=[],this.currentElement=[],this.treemap=e,this.addEventListener()}return e.prototype.mouseMove=function(e){var t,i,r,o,l,n,a,s,h=this.treemap,d=e.target.id,p=[],c=this.treemap.highlightSettings,g=[],m=this.treemap.treeMapSelectionModule;if(d.indexOf("_Item_Index")>-1&&(!m||this.treemap.selectionId!==d)){if(this.highLightId!==d){n=document.getElementById(h.element.id+"_TreeMap_"+h.layoutType+"_Layout");var u=document.getElementsByClassName("treeMapSelection");o=this.treemap.layout.renderItems[parseFloat(d.split("_")[6])];var f=void 0;if(this.treemap.legendSettings.visible){var y=this.treemap.treeMapLegendModule.legendCollections;f=Ie(this.treemap.treeMapLegendModule.legendCollections.length,o,h),this.shapeElement="Default"===this.treemap.legendSettings.mode?document.getElementById("container_Legend_Shape_Index_"+f):document.getElementById("container_Legend_Index_"+f),null===this.shapeElement||m&&this.shapeElement.getAttribute("id")===m.legendSelectId||m&&this.shapeElement===m.shapeElement?this.currentElement.length>0&&this.currentElement[this.currentElement.length-1].currentElement!==this.shapeElement&&(Se(this.shapeHighlightCollection,this.currentElement,h),this.highLightId=""):(this.currentElement.push({currentElement:this.shapeElement}),be(this.shapeHighlightCollection),this.shapeHighlightCollection.push({legendEle:this.shapeElement,oldFill:y[f].legendFill,oldOpacity:y[f].opacity,oldBorderColor:y[f].borderColor,oldBorderWidth:y[f].borderWidth}),we(this.shapeElement,c.fill,c.opacity,c.border.color,c.border.width.toString()),this.target="highlight")}if(s=F(o,[],c.mode,h),!this.treemap.legendSettings.visible||(!m||(!this.shapeElement||this.shapeElement.getAttribute("id")!==m.legendSelectId)))if(this.treemap.legendSettings.visible&&(m&&this.shapeElement===m.shapeElement))t=!1;else{for(var v=0;v<n.childElementCount;v++){a=n.childNodes[v],l=!0,o=h.layout.renderItems[a.id.split("_")[6]];for(var b=0;b<u.length;b++)if(a.id===u[b].id){l=!1;break}s.indexOf(o.levelOrderName)>-1&&l&&(g.push(a),p.push(o))}ne(document.getElementsByClassName("treeMapHighLight"),"treeMapHighLight",h);for(var x=0;x<g.length;x++)ae((a=g[x]).childNodes[0],{border:c.border,fill:c.fill,opacity:c.opacity}),a.classList.add("treeMapHighLight"),this.highLightId=d;i={cancel:!1,name:"itemHighlight",treemap:h,items:p,elements:g},r={cancel:!1,name:"itemHighlight",items:null,elements:g},h.trigger("itemHighlight",h.isBlazor?r:i)}}}else if(d.indexOf("_Legend_Shape")>-1||d.indexOf("_Legend_Index")>-1){if(this.treemap.legendSettings.visible&&(!m||m.legendSelectId!==d)&&(!m||m.shapeSelectId!==d)){f=void 0;var w,S=void 0,I=void 0,O=document.getElementById(d);"highlight"===this.shapeTarget&&xe(this.legendHighlightCollection),this.shapeTarget="highlight",f="Default"===this.treemap.legendSettings.mode?parseFloat(d.split("_")[4]):parseFloat(d.split("_")[3]);var C=this.treemap.treeMapLegendModule.legendCollections[f].legendData.length,L=(y=this.treemap.treeMapLegendModule.legendCollections,parseInt(d[d.length-1],10));for(v=0;v<C;v++)for(b=0;b<this.treemap.layout.renderItems.length;b++)if(this.treemap.treeMapLegendModule.legendCollections[f].legendData[v].levelOrderName===this.treemap.layout.renderItems[b].levelOrderName){S=b,I=this.treemap.layout.renderItems[b].groupIndex;var P=document.getElementById("container_Level_Index_"+I+"_Item_Index_"+S+"_RectPath");0===v&&(this.legendHighlightCollection=[],Oe(this.legendHighlightCollection,L,b,O,P,this.treemap.layout.renderItems,y),w=this.legendHighlightCollection.length,this.legendHighlightCollection[w-1].ShapeCollection={Elements:[]}),we(O,c.fill,c.opacity,c.border.color,c.border.width.toString()),we(P,c.fill,c.opacity,c.border.color,c.border.width.toString()),w=this.legendHighlightCollection.length,this.legendHighlightCollection[w-1].ShapeCollection.Elements.push(P)}}}else m&&this.shapeElement&&this.shapeElement.getAttribute("id")===m.legendSelectId||(m?this.shapeElement!==m.shapeElement:this.treemap.legendSettings.visible)&&ne(document.getElementsByClassName("treeMapHighLight"),"treeMapHighLight",h),"highlight"!==this.shapeTarget&&"highlight"!==this.target||!this.treemap.legendSettings.visible||m&&this.shapeElement&&this.shapeElement.getAttribute("id")===m.legendSelectId||(m?this.shapeElement!==m.shapeElement:!m||m.legendSelect)&&(be(this.shapeHighlightCollection),this.shapeHighlightCollection=[]),"highlight"===this.shapeTarget&&this.treemap.legendSettings.visible&&xe(this.legendHighlightCollection),this.highLightId="",t=!1;return t},e.prototype.addEventListener=function(){this.treemap.isDestroyed||this.treemap.on(sf.base.Browser.touchMoveEvent,this.mouseMove,this)},e.prototype.removeEventListener=function(){this.treemap.isDestroyed||this.treemap.off(sf.base.Browser.touchMoveEvent,this.mouseMove)},e.prototype.getModuleName=function(){return"treeMapHighlight"},e.prototype.destroy=function(e){this.removeEventListener()},e}(),Ge=function(){function e(e){this.shapeSelectionCollection=[],this.legendSelectionCollection=[],this.shapeSelect=!0,this.legendSelect=!0,this.treemap=e,this.addEventListener()}return e.prototype.mouseDown=function(e){var t,i,r=e.target,o=this.treemap;o.levelSelection=[];var l,n,a,s,h=[],d=r.id,p=r.innerHTML,c=[],g=o.selectionSettings,m=this.treemap.treeMapHighlightModule,u=o.element.id+"_TreeMap_"+o.layoutType+"_Layout";if(d.indexOf("_Item_Index")>-1)if(e.preventDefault(),this.treemap.selectionId!==d&&this.legendSelect){n=document.getElementById(u),l=o.layout.renderItems[parseFloat(d.split("_")[6])];var f=void 0;if(this.treemap.legendSettings.visible){this.shapeSelect=!1;var y=this.treemap.treeMapLegendModule.legendCollections.length,v=this.treemap.treeMapLegendModule.legendCollections;this.shapeElement=void 0,be(this.shapeSelectionCollection),m&&(m.shapeTarget="selection",m.shapeHighlightCollection=[]),f=Ie(y,l,o),this.shapeElement="Default"===this.treemap.legendSettings.mode?document.getElementById("container_Legend_Shape_Index_"+f):document.getElementById("container_Legend_Index_"+f),null!==this.shapeElement&&(this.shapeSelectId=this.shapeElement.getAttribute("id"),this.shapeSelectionCollection.push({legendEle:this.shapeElement,oldFill:v[f].legendFill,oldOpacity:v[f].opacity,oldBorderColor:v[f].borderColor,oldBorderWidth:v[f].borderWidth}),we(this.shapeElement,g.fill,g.opacity,g.border.color,g.border.width.toString()))}s=F(l,[],g.mode,o);for(var b=0;b<n.childElementCount;b++)a=n.childNodes[b],l=o.layout.renderItems[a.id.split("_")[6]],s.indexOf(l.levelOrderName)>-1&&(c.push(a),o.levelSelection.push(a.id),h.push(l));ne(document.getElementsByClassName("treeMapSelection"),"treeMapSelection",o),this.treemap.selectionId=d;for(var x=document.getElementsByClassName("treeMapHighLight"),w=0;w<c.length;w++){if(a=c[w],x.length>0)for(var S=0;S<x.length;S++)x[S].id===a.id&&x[S].classList.remove("treeMapHighLight"),ae(a.childNodes[0],{border:g.border,fill:g.fill,opacity:g.opacity}),a.classList.add("treeMapSelection");else ae(a.childNodes[0],{border:g.border,fill:g.fill,opacity:g.opacity}),a.classList.add("treeMapSelection");if(t={cancel:!1,name:"itemSelected",treemap:o,items:h,elements:c,text:p,contentItemTemplate:p},i={cancel:!1,name:"itemSelected",text:p,contentItemTemplate:p},o.isBlazor){i=ke(t,["treemap","items","elements"])}o.trigger("itemSelected",o.isBlazor?i:t,(function(e){if(e.contentItemTemplate!==p){var t=d.split("_RectPath")[0],i=void 0;if(i=d.indexOf("_LabelTemplate")>-1?r:document.querySelector("#"+t+"_LabelTemplate"),!sf.base.isNullOrUndefined(i)){if(o.isBlazor){var l=sf.base.createElement("div");l.innerHTML=e.contentItemTemplate;var n=l.children[0].firstElementChild;i.style.left=Number(i.style.left.split("px")[0])-n.style.width.split("px")[0]/2+"px",i.style.top=Number(i.style.top.split("px")[0])-n.style.height.split("px")[0]/2+"px"}i.innerHTML=e.contentItemTemplate}}}))}}else be(this.shapeSelectionCollection),this.shapeSelectionCollection=[],this.shapeElement=void 0,this.shapeSelect=!0,this.shapeSelectId="",this.treemap.legendId=[],ne(document.getElementsByClassName("treeMapSelection"),"treeMapSelection",o),this.treemap.selectionId="";else if(d.indexOf("_Legend_Shape")>-1||d.indexOf("_Legend_Index")>-1){v=this.treemap.treeMapLegendModule.legendCollections;if(this.treemap.legendSettings.visible&&this.legendSelectId!==d&&this.shapeSelect){f=void 0;var I,O=void 0,C=void 0;this.legendSelectId=d,this.legendSelect=!1;var L=parseInt(d[d.length-1],10),P=document.getElementById(d);xe(this.legendSelectionCollection),m&&(m.shapeTarget="selection"),f="Default"===this.treemap.legendSettings.mode?parseFloat(d.split("_")[4]):parseFloat(d.split("_")[3]);var M=this.treemap.treeMapLegendModule.legendCollections[f].legendData.length;for(w=0;w<M;w++)for(var N=0;N<this.treemap.layout.renderItems.length;N++)if(this.treemap.treeMapLegendModule.legendCollections[f].legendData[w].levelOrderName===this.treemap.layout.renderItems[N].levelOrderName){O=N,C=this.treemap.layout.renderItems[N].groupIndex;var T=document.getElementById("container_Level_Index_"+C+"_Item_Index_"+O+"_RectPath");0===w&&(Oe(this.legendSelectionCollection,L,N,P,T,this.treemap.layout.renderItems,v),I=this.legendSelectionCollection.length,this.legendSelectionCollection[I-1].ShapeCollection={Elements:[]}),we(P,g.fill,g.opacity,g.border.color,g.border.width.toString()),we(T,g.fill,g.opacity,g.border.color,g.border.width.toString()),I=this.legendSelectionCollection.length,this.legendSelectionCollection[I-1].ShapeCollection.Elements.push(T)}}else xe(this.legendSelectionCollection),m&&(m.shapeTarget="highlight"),this.legendSelect=!0,this.legendSelectId=""}},e.prototype.selectTreemapItem=function(e,t){if(t){for(var i=void 0,r=0;r<this.treemap.layout.renderItems.length;r++)if(e===this.treemap.layout.renderItems[r].levelOrderName){i=this.treemap.layout.renderItems[r];break}var o,l=this.treemap.selectionSettings,n=[],a=void 0,s=void 0,h=[];this.treemap.levelSelection=[];for(var d=this.treemap.element.id+"_TreeMap_"+this.treemap.layoutType+"_Layout",p=document.getElementById(d),c=F(i,[],l.mode,this.treemap),g=0;g<p.childElementCount;g++)a=p.childNodes[g],i=this.treemap.layout.renderItems[a.id.split("_")[6]],c.indexOf(i.levelOrderName)>-1&&(n.push(a),this.treemap.levelSelection.push(a.id),h.push(i));if(this.treemap.legendSettings.visible)for(var m=0;m<h.length;m++){this.shapeSelect=!1;var u=this.treemap.treeMapLegendModule.legendCollections.length,f=this.treemap.treeMapLegendModule.legendCollections;this.shapeElement=void 0,be(this.shapeSelectionCollection),s=Ie(u,h[m],this.treemap),this.shapeElement="Default"===this.treemap.legendSettings.mode?document.getElementById("container_Legend_Shape_Index_"+s):document.getElementById("container_Legend_Index_"+s),null!==this.shapeElement&&(this.shapeSelectId=this.shapeElement.getAttribute("id"),this.treemap.legendId.push(this.shapeSelectId),this.shapeSelectionCollection.push({legendEle:this.shapeElement,oldFill:f[s].legendFill,oldOpacity:f[s].opacity,oldBorderColor:f[s].borderColor,oldBorderWidth:f[s].borderWidth}),we(this.shapeElement,l.fill,l.opacity,l.border.color,l.border.width.toString()))}ne(document.getElementsByClassName("treeMapSelection"),"treeMapSelection",this.treemap),o=document.getElementById(this.treemap.levelSelection[0]),this.treemap.selectionId=o.childNodes[0].id;for(var y=document.getElementsByClassName("treeMapHighLight"),v=0;v<n.length;v++)if(a=n[v],y.length>0)for(var b=0;b<y.length;b++)y[b].id===a.id&&y[b].classList.remove("treeMapHighLight"),ae(a.childNodes[0],{border:l.border,fill:l.fill,opacity:l.opacity}),a.classList.add("treeMapSelection");else l.fill="null"===l.fill?this.treemap.layout.renderItems[parseInt(a.id.split("Item_Index_")[1],10)].options.fill:l.fill,ae(a.childNodes[0],{border:l.border,fill:l.fill,opacity:l.opacity}),a.classList.add("treeMapSelection")}else be(this.shapeSelectionCollection),this.shapeElement=void 0,this.treemap.levelSelection=[],this.shapeSelect=!0,this.shapeSelectId="",this.treemap.legendId=[],ne(document.getElementsByClassName("treeMapSelection"),"treeMapSelection",this.treemap),this.treemap.selectionId=""},e.prototype.addEventListener=function(){this.treemap.isDestroyed||this.treemap.on(sf.base.Browser.touchStartEvent,this.mouseDown,this)},e.prototype.removeEventListener=function(){this.treemap.isDestroyed||this.treemap.off(sf.base.Browser.touchStartEvent,this.mouseDown)},e.prototype.getModuleName=function(){return"treeMapSelection"},e.prototype.destroy=function(e){this.removeEventListener()},e}(),Ve=function(e,t){var i={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(i[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)t.indexOf(r[o])<0&&(i[r[o]]=e[r[o]])}return i},We=function(){function e(e){this.treemap=e,this.tooltipSettings=this.treemap.tooltipSettings,this.tooltipId=this.treemap.element.id+"_TreeMapTooltip",this.addEventListener()}return e.prototype.renderTooltip=function(e){var t,i,r,o,l,n,a=this;-1!==e.type.indexOf("touch")?(this.isTouch=!0,t=(o=e).changedTouches[0].pageX,i=o.changedTouches[0].pageY,r=o.target):(this.isTouch="touch"===e.pointerType,t=e.pageX,i=e.pageY,r=e.target);var s,h,d,p=r.id,c={},g={},m=[];if(p.indexOf("_Item_Index")>-1){if(c=this.treemap.layout.renderItems[parseFloat(p.split("_")[6])],!sf.base.isNullOrUndefined(c))if(c.name,n=c.weight,g=c.data,d=c.options.fill,m=this.treemap.enableRtl?[se(this.tooltipSettings.format,g,this.treemap)||he(n,this.treemap)+" : "+this.treemap.weightValuePath.toString()]:[se(this.tooltipSettings.format,g,this.treemap)||this.treemap.weightValuePath.toString()+" : "+he(n,this.treemap)],document.getElementById(this.tooltipId)?s=document.getElementById(this.tooltipId):(s=sf.base.createElement("div",{id:this.treemap.element.id+"_TreeMapTooltip",className:"EJ2-TreeMap-Tooltip",styles:"position: absolute;pointer-events:none;"}),document.getElementById(this.treemap.element.id+"_Secondary_Element").appendChild(s)),(h=W(t,i,this.treemap.svgObject)).y=this.tooltipSettings.template?h.y+10:h.y,this.tooltipSettings.textStyle.fontFamily=this.treemap.themeStyle.fontFamily,this.tooltipSettings.textStyle.color=this.treemap.themeStyle.tooltipFontColor||this.tooltipSettings.textStyle.color,this.tooltipSettings.textStyle.opacity=this.treemap.themeStyle.tooltipTextOpacity||this.tooltipSettings.textStyle.opacity,l={cancel:!1,name:"tooltipRendering",item:c,options:{location:h,text:m,data:g,textStyle:this.tooltipSettings.textStyle,template:this.tooltipSettings.template},treemap:this.treemap,element:r,eventArgs:e},this.treemap.isBlazor){var u={cancel:!1,location:l.options.location,text:l.options.text,textStyle:l.options.textStyle,data:l.options.data,template:l.options.template,name:"tooltipRendering"};this.treemap.trigger("tooltipRendering",u,(function(e){a.addTooltip(null,d,s,u)}))}else this.treemap.trigger("tooltipRendering",l,(function(e){a.addTooltip(l,d,s)}))}else this.removeTooltip()},e.prototype.addTooltip=function(e,t,i,r){var o,l;sf.base.isNullOrUndefined(e)?(o=r.cancel,l=r):(o=e.cancel,l=Ve(e,["cancel"]).options);o?this.removeTooltip():(this.svgTooltip=new sf.svgbase.Tooltip({enable:!0,header:"",data:l.data,template:l.template,content:l.text,shapes:[],location:l.location,palette:[t],areaBounds:this.treemap.areaRect,textStyle:l.textStyle,blazorTemplate:{name:"TooltipTemplate",parent:this.treemap.tooltipSettings}}),this.svgTooltip.opacity=this.treemap.themeStyle.tooltipFillOpacity||this.svgTooltip.opacity,this.svgTooltip.appendTo(i))},e.prototype.mouseUpHandler=function(e){this.renderTooltip(e),clearTimeout(this.clearTimeout),this.clearTimeout=setTimeout(this.removeTooltip.bind(this),2e3)},e.prototype.removeTooltip=function(){if(document.getElementsByClassName("EJ2-TreeMap-Tooltip").length>0){var e=document.getElementsByClassName("EJ2-TreeMap-Tooltip")[0];e.parentNode.removeChild(e)}},e.prototype.addEventListener=function(){this.treemap.isDestroyed||(this.treemap.on(sf.base.Browser.touchMoveEvent,this.renderTooltip,this),this.treemap.on(sf.base.Browser.touchEndEvent,this.mouseUpHandler,this))},e.prototype.removeEventListener=function(){this.treemap.isDestroyed||(this.treemap.off(sf.base.Browser.touchMoveEvent,this.renderTooltip),this.treemap.off(sf.base.Browser.touchEndEvent,this.mouseUpHandler))},e.prototype.getModuleName=function(){return"treeMapTooltip"},e.prototype.destroy=function(e){this.removeEventListener()},e}();return He.Inject(We,Ae,je,Ge,Ee,_e,De),e.TreeMap=He,e.LevelsData=ze,e.Border=n,e.Margin=a,e.Font=s,e.CommonTitleSettings=h,e.SubTitleSettings=d,e.TitleSettings=p,e.ColorMapping=c,e.LegendSettings=g,e.InitialDrillSettings=m,e.LeafItemSettings=u,e.TooltipSettings=f,e.SelectionSettings=y,e.HighlightSettings=v,e.LevelSettings=b,e.load="load",e.loaded="loaded",e.beforePrint="beforePrint",e.itemRendering="itemRendering",e.drillStart="drillStart",e.drillEnd="drillEnd",e.itemSelected="itemSelected",e.itemHighlight="itemHighlight",e.tooltipRendering="tooltipRendering",e.itemClick="itemClick",e.itemMove="itemMove",e.click="click",e.doubleClick="doubleClick",e.rightClick="rightClick",e.mouseMove="mouseMove",e.legendItemRendering="legendItemRendering",e.legendRendering="legendRendering",e.resize="resize",e.defaultFont=i,e.getThemeStyle=Ne,e.Size=x,e.stringToNumber=w,e.Rect=S,e.RectOption=I,e.PathOption=O,e.measureText=C,e.TextOption=L,e.textTrim=P,e.Location=M,e.findPosition=N,e.createTextStyle=T,e.renderTextElement=E,e.getElement=D,e.itemsToOrder=_,e.isContainsData=B,e.findChildren=R,e.findHightLightItems=F,e.getTemplateFunction=H,e.convertElement=z,e.findLabelLocation=U,e.measureElement=A,e.getArea=k,e.getShortestEdge=j,e.convertToContainer=G,e.convertToRect=V,e.getMousePosition=W,e.colorMap=q,e.deSaturationColor=J,e.colorCollections=X,e.rgbToHex=Y,e.getColorByValue=Z,e.getGradientColor=Q,e.getPercentageColor=$,e.getPercentage=K,e.wordWrap=ee,e.textWrap=te,e.hide=ie,e.orderByArea=re,e.maintainSelection=oe,e.legendMaintain=le,e.removeClassNames=ne,e.applyOptions=ae,e.textFormatter=se,e.formatValue=he,e.ColorValue=de,e.convertToHexCode=pe,e.componentToHex=ce,e.convertHexToColor=ge,e.colorNameToHex=me,e.drawSymbol=ue,e.renderLegendShape=fe,e.isParentItem=ye,e.TreeMapAjax=ve,e.removeShape=be,e.removeLegend=xe,e.setColor=we,e.removeSelectionWithHighlight=Se,e.getLegendIndex=Ie,e.pushCollection=Oe,e.triggerDownload=Ce,e.removeElement=Le,e.TreeMapLegend=Ae,e.LayoutPanel=Me,e.TreeMapHighlight=je,e.TreeMapSelection=Ge,e.TreeMapTooltip=We,e.ImageExport=De,e.PdfExport=_e,e.Print=Ee,e}({}))}))}}]);