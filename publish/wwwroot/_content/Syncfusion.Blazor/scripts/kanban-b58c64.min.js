(window.webpackJsonp=window.webpackJsonp||[]).push([[43],{"./bundles/kanban.js":function(e,t,a){"use strict";a.r(t);var n=a("../node_modules/@babel/runtime/helpers/typeof.js"),r=a.n(n);window.sf=window.sf||{};sfBlazor.modules.kanban="kanban.Kanban",sfBlazor.loadDependencies(sfBlazor.dependencyJson.kanban,(function(){var e,t,a,n,s,i,o,l,d,c,p,h,u,f,g,m,y,b,v,C,w,S,E,k,O,D,A,x,M,R,j,T,F,q,P,L,B,H,N,_,I,z,U,K,W;sf.kanban=sf.base.extend({},sf.kanban,(e={},c="content-ready",p="data-ready",h=function(){function e(e){this.parent=e,this.initDataManager(e.dataSource,e.query),this.refreshDataManager()}return e.prototype.initDataManager=function(e,t){this.dataManager=e instanceof sf.data.DataManager?e:new sf.data.DataManager(e),this.query=t instanceof sf.data.Query?t:new sf.data.Query},e.prototype.generateQuery=function(){return this.query.clone()},e.prototype.getData=function(e){return this.dataManager.executeQuery(e)},e.prototype.refreshDataManager=function(){var e=this;this.getData(this.generateQuery()).then((function(t){return e.dataManagerSuccess(t)})).catch((function(t){return e.dataManagerFailure(t)}))},e.prototype.dataManagerSuccess=function(e){var t=this;this.parent.isDestroyed||this.parent.trigger("dataBinding",e,(function(e){var a=sf.base.extend([],e.result,null,!0);t.parent.kanbanData=a,t.parent.notify(p,{processedData:a}),t.parent.trigger("dataBound",null,(function(){return t.parent.hideSpinner()}))}))},e.prototype.dataManagerFailure=function(e){var t=this;this.parent.isDestroyed||this.parent.trigger("actionFailure",{error:e},(function(){return t.parent.hideSpinner()}))},e}(),t=function(e,a){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])})(e,a)},u=function(e,a){function n(){this.constructor=e}t(e,a),e.prototype=null===a?Object.create(a):(n.prototype=a.prototype,new n)},f=function(e,t,a,n){var s,i=arguments.length,o=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"===("undefined"==typeof Reflect?"undefined":r()(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,a,n);else for(var l=e.length-1;l>=0;l--)(s=e[l])&&(o=(i<3?s(o):i>3?s(t,a,o):s(t,a))||o);return i>3&&o&&Object.defineProperty(t,a,o),o},g=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return u(t,e),f([sf.base.Property()],t.prototype,"keyField",void 0),f([sf.base.Property()],t.prototype,"textField",void 0),f([sf.base.Property(!1)],t.prototype,"showEmptyRow",void 0),f([sf.base.Property(!0)],t.prototype,"showItemCount",void 0),f([sf.base.Property(!1)],t.prototype,"allowDragAndDrop",void 0),f([sf.base.Property()],t.prototype,"template",void 0),f([sf.base.Property("Ascending")],t.prototype,"sortDirection",void 0),t}(sf.base.ChildProperty),a=function(e,t){return(a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])})(e,t)},m=function(e,t){function n(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},y=function(e,t,a,n){var s,i=arguments.length,o=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"===("undefined"==typeof Reflect?"undefined":r()(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,a,n);else for(var l=e.length-1;l>=0;l--)(s=e[l])&&(o=(i<3?s(o):i>3?s(t,a,o):s(t,a))||o);return i>3&&o&&Object.defineProperty(t,a,o),o},b=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return m(t,e),y([sf.base.Property(!0)],t.prototype,"showHeader",void 0),y([sf.base.Property()],t.prototype,"headerField",void 0),y([sf.base.Property()],t.prototype,"contentField",void 0),y([sf.base.Property()],t.prototype,"tagsField",void 0),y([sf.base.Property()],t.prototype,"grabberField",void 0),y([sf.base.Property()],t.prototype,"footerCssField",void 0),y([sf.base.Property()],t.prototype,"template",void 0),y([sf.base.Property("Single")],t.prototype,"selectionType",void 0),t}(sf.base.ChildProperty),n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])})(e,t)},v=function(e,t){function a(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)},C=function(e,t,a,n){var s,i=arguments.length,o=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"===("undefined"==typeof Reflect?"undefined":r()(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,a,n);else for(var l=e.length-1;l>=0;l--)(s=e[l])&&(o=(i<3?s(o):i>3?s(t,a,o):s(t,a))||o);return i>3&&o&&Object.defineProperty(t,a,o),o},w=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return v(t,e),C([sf.base.Property()],t.prototype,"template",void 0),C([sf.base.Property([])],t.prototype,"fields",void 0),C([sf.base.Property(null)],t.prototype,"model",void 0),t}(sf.base.ChildProperty),s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])})(e,t)},S=function(e,t){function a(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)},E=function(e,t,a,n){var s,i=arguments.length,o=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"===("undefined"==typeof Reflect?"undefined":r()(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,a,n);else for(var l=e.length-1;l>=0;l--)(s=e[l])&&(o=(i<3?s(o):i>3?s(t,a,o):s(t,a))||o);return i>3&&o&&Object.defineProperty(t,a,o),o},k=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return S(t,e),E([sf.base.Property()],t.prototype,"keyField",void 0),E([sf.base.Property()],t.prototype,"headerText",void 0),E([sf.base.Property()],t.prototype,"template",void 0),E([sf.base.Property(!1)],t.prototype,"allowToggle",void 0),E([sf.base.Property(!0)],t.prototype,"isExpanded",void 0),E([sf.base.Property()],t.prototype,"minCount",void 0),E([sf.base.Property()],t.prototype,"maxCount",void 0),E([sf.base.Property(!0)],t.prototype,"showItemCount",void 0),E([sf.base.Property(!1)],t.prototype,"showAddButton",void 0),t}(sf.base.ChildProperty),i=function(e,t){return(i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])})(e,t)},O=function(e,t){function a(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)},D=function(e,t,a,n){var s,i=arguments.length,o=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"===("undefined"==typeof Reflect?"undefined":r()(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,a,n);else for(var l=e.length-1;l>=0;l--)(s=e[l])&&(o=(i<3?s(o):i>3?s(t,a,o):s(t,a))||o);return i>3&&o&&Object.defineProperty(t,a,o),o},A=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return O(t,e),D([sf.base.Property()],t.prototype,"text",void 0),D([sf.base.Property()],t.prototype,"keyFields",void 0),t}(sf.base.ChildProperty),x="e-kanban-content",M="e-show-add-button",R=function(){function e(e){this.parent=e,this.columnToggleArray=[],this.selectionArray=[],this.lastCardSelection=null,this.lastSelectionRow=null,this.lastCard=null,this.selectedCardsElement=[],this.selectedCardsData=[],this.hideColumnKeys=[]}return e.prototype.clickHandler=function(e){var t=sf.base.closest(e.target,".e-card,.e-header-icon,.e-content-row.e-swimlane-row,.e-show-add-button,.e-content-row:not(.e-swimlane-row) .e-content-cells");t&&(t.classList.contains("e-card")?(this.parent.allowKeyboard&&this.parent.keyboardModule.cardTabIndexRemove(),this.cardClick(e)):t.classList.contains("e-header-icon")?this.columnExpandCollapse(e):t.classList.contains("e-content-row")&&t.classList.contains("e-swimlane-row")?this.rowExpandCollapse(e):t.classList.contains(M)&&this.addButtonClick(t))},e.prototype.addButtonClick=function(e){var t=this,a={};if(0===this.parent.kanbanData.length?a[this.parent.cardSettings.headerField]=1:"number"==typeof this.parent.kanbanData[0][this.parent.cardSettings.headerField]&&(a[this.parent.cardSettings.headerField]=Math.max.apply(Math,this.parent.kanbanData.map((function(e){return parseInt(e[t.parent.cardSettings.headerField],10)})))+1),a[this.parent.keyField]=sf.base.closest(e,".e-content-cells").getAttribute("data-key"),"Index"===this.parent.sortSettings.sortBy&&(a[this.parent.sortSettings.field]=1,sf.base.closest(e,".e-content-cells").querySelector(".e-card"))){var n="Ascending"===this.parent.sortSettings.direction?e.nextElementSibling.lastElementChild:e.nextElementSibling.firstElementChild,r=this.parent.getCardDetails(n);a[this.parent.sortSettings.field]=r[this.parent.sortSettings.field]+1}0!==this.parent.kanbanData.length&&this.parent.swimlaneSettings.keyField&&sf.base.closest(e,".e-content-row").previousElementSibling&&(a[this.parent.swimlaneSettings.keyField]=sf.base.closest(e,".e-content-row").previousElementSibling.getAttribute("data-key")),this.parent.openDialog("Add",a)},e.prototype.doubleClickHandler=function(e){sf.base.closest(e.target,".e-card")&&this.cardDoubleClick(e)},e.prototype.cardClick=function(e,t){var a=this,n=sf.base.closest(t||e.target,".e-card"),r=this.parent.getCardDetails(n);this.parent.activeCardData={data:r,element:n};var s={data:r,element:n,cancel:!1,event:e};this.parent.trigger("cardClick",s,(function(t){if(!t.cancel){if(n.classList.contains("e-selection")&&"click"===e.type)sf.base.removeClass([n],"e-selection"),a.parent.layoutModule.disableAttributeSelection(n);else{var r=e.ctrlKey;a.parent.isAdaptive&&a.parent.touchModule&&(r=a.parent.touchModule.mobilePopup&&a.parent.touchModule.tabHold||r),a.cardSelection(n,r,e.shiftKey)}a.parent.isAdaptive&&a.parent.touchModule&&a.parent.touchModule.updatePopupContent();var s=sf.base.closest(n,".e-content-cells");a.parent.allowKeyboard&&([].slice.call(s.querySelectorAll(".e-card")).forEach((function(e){e.setAttribute("tabindex","0")})),a.parent.keyboardModule.addRemoveTabIndex("Remove"))}}))},e.prototype.cardDoubleClick=function(e){var t=this,a=sf.base.closest(e.target,".e-card"),n=this.parent.getCardDetails(a);this.parent.activeCardData={data:n,element:a};var r={data:n,element:a,cancel:!1,event:e};this.parent.trigger("cardDoubleClick",r,(function(e){e.cancel||(t.parent.isBlazorRender()?t.parent.interopAdaptor.invokeMethodAsync("OpenDialog","Edit",r.data):t.parent.dialogModule.openDialog("Edit",r.data))}))},e.prototype.rowExpandCollapse=function(e){var t=this,a=e instanceof HTMLElement?e:e.target,n={cancel:!1,target:a,requestType:"rowExpandCollapse"};this.parent.trigger("actionBegin",n,(function(e){if(!e.cancel){var n,r=sf.base.closest(a,".e-swimlane-row"),s=r.getAttribute("data-key"),i=t.parent.element.querySelector(".e-content-row:nth-child("+(r.rowIndex+2)+")"),o=r.querySelector(".e-swimlane-row-expand,.e-swimlane-row-collapse"),l=!!r.classList.contains("e-collapsed");l?(sf.base.removeClass([i,r],"e-collapsed"),sf.base.classList(o,["e-swimlane-row-expand"],["e-swimlane-row-collapse"]),t.parent.swimlaneToggleArray.splice(t.parent.swimlaneToggleArray.indexOf(s),1),n="0"):(sf.base.addClass([i,r],"e-collapsed"),sf.base.classList(o,["e-swimlane-row-collapse"],["e-swimlane-row-expand"]),t.parent.swimlaneToggleArray.push(s),n="-1"),o.setAttribute("aria-label",l?s+" Expand":s+" Collapse"),r.setAttribute("aria-expanded",l.toString()),i.setAttribute("aria-expanded",l.toString()),[].slice.call(i.querySelectorAll(".e-content-cells")).forEach((function(e){e.setAttribute("tabindex",n)})),t.parent.notify(c,{}),t.parent.trigger("actionComplete",{target:a,requestType:"rowExpandCollapse"})}}))},e.prototype.columnExpandCollapse=function(e){var t=this,a=e instanceof HTMLElement?e:e.target,n={cancel:!1,target:a,requestType:"columnExpandCollapse"};this.parent.trigger("actionBegin",n,(function(e){if(!e.cancel){var n=sf.base.closest(a,".e-header-cells"),r=n.cellIndex;t.columnToggle(n);var s=t.parent.element.querySelectorAll(".e-header-cells.e-collapsed").length;if(s===t.parent.columns.length-t.hideColumnKeys.length){var i=".e-header-cells:not(.e-stacked-header-cell):nth-child("+(r+1===s?1:r+2)+")",o=t.parent.element.querySelector(i);sf.base.addClass([o],"e-collapsed"),t.columnToggle(o)}t.parent.notify(c,{}),t.parent.trigger("actionComplete",{target:a,requestType:"columnExpandCollapse"})}}))},e.prototype.columnToggle=function(e){var t=this,a=e.cellIndex,n=[].slice.call(this.parent.element.querySelectorAll(".e-content-row:not(.e-swimlane-row)")),r=".e-kanban-table col:nth-child("+(a+1)+")",s=e.querySelector(".e-column-expand,.e-column-collapse"),i=[].slice.call(this.parent.element.querySelectorAll(r));if(e.classList.contains("e-collapsed")){sf.base.removeClass(i,"e-collapsed"),this.parent.isAdaptive&&i.forEach((function(e){return e.style.width=sf.base.formatUnit(t.parent.layoutModule.getWidth())})),sf.base.classList(s,["e-column-expand"],["e-column-collapse"]);for(var o=0,l=n;o<l.length;o++){var d=l[o].querySelector(".e-content-cells:nth-child("+(a+1)+")");sf.base.removeClass([d,e],"e-collapsed"),sf.base.remove(d.querySelector(".e-collapse-header-text")),e.setAttribute("aria-expanded","true"),d.setAttribute("aria-expanded","true")}this.columnToggleArray.splice(this.columnToggleArray.indexOf(e.getAttribute("data-key")),1),this.parent.columns[a].setProperties({isExpanded:!0},!0),e.querySelector(".e-header-icon").setAttribute("aria-label",e.getAttribute("data-key")+" Expand")}else{sf.base.addClass(i,"e-collapsed"),this.parent.isAdaptive&&i.forEach((function(e){return e.style.width=sf.base.formatUnit(50)})),sf.base.classList(s,["e-column-collapse"],["e-column-expand"]);for(var c=e.getAttribute("data-key"),p=0,h=n;p<h.length;p++){var u=(d=h[p].querySelector('.e-content-cells[data-key="'+c+'"]')).cellIndex,f=(this.parent.columns[u].showItemCount?"["+d.querySelectorAll(".e-card").length+"] ":"")+this.parent.columns[u].headerText;d.appendChild(sf.base.createElement("div",{className:"e-collapse-header-text",innerHTML:f})),sf.base.addClass([d,e],"e-collapsed"),e.setAttribute("aria-expanded","false"),d.setAttribute("aria-expanded","false")}this.columnToggleArray.push(e.getAttribute("data-key")),this.parent.columns[a].setProperties({isExpanded:!1},!0),e.querySelector(".e-header-icon").setAttribute("aria-label",c+" Collapse")}},e.prototype.cardSelection=function(e,t,a){var n=this;if(e){var r=this.parent.getSelectedCards();if("None"!==this.parent.cardSettings.selectionType){var s=sf.base.closest(e,".e-content-row");if((sf.base.isNullOrUndefined(this.lastSelectionRow)?s.rowIndex:this.lastSelectionRow.rowIndex)!==s.rowIndex&&(t||a)&&"Multiple"===this.parent.cardSettings.selectionType)return;if(0===r.length||t&&"Single"!==this.parent.cardSettings.selectionType||(sf.base.removeClass(r,"e-selection"),this.parent.layoutModule.disableAttributeSelection(r),r.forEach((function(e){n.selectionArray.splice(n.selectionArray.indexOf(e.getAttribute("data-id")),1),n.selectedCardsElement.splice(n.selectedCardsElement.indexOf(e),1),n.selectedCardsData.splice(n.selectedCardsData.indexOf(n.parent.getCardDetails(e),1))}))),r.length>0&&a&&"Multiple"===this.parent.cardSettings.selectionType){var i=[],o=void 0,l=void 0,d=void 0,c=[].slice.call(s.querySelectorAll(".e-card"));c.forEach((function(e){return i.push(e.getAttribute("data-id"))}));var p=e.getAttribute("data-id"),h=this.lastCard.getAttribute("data-id"),u=l=i.indexOf(p),f=o=i.indexOf(h),g=u>f?"next":"prev";for("prev"===g&&(o=u,l=f),d=o;d<=l;d++){var m=c[d];sf.base.addClass([m],"e-selection"),m.setAttribute("aria-selected","true"),m.setAttribute("tabindex","0"),this.selectionArray.push(m.getAttribute("data-id")),this.selectedCardsElement.push(m),this.selectedCardsData.push(this.parent.getCardDetails(m)),this.lastCardSelection=m,"prev"===g&&(this.lastCardSelection=c[o])}}else if(sf.base.addClass([e],"e-selection"),e.setAttribute("aria-selected","true"),e.setAttribute("tabindex","0"),this.selectionArray.push(e.getAttribute("data-id")),this.selectedCardsElement.push(e),this.selectedCardsData.push(this.parent.getCardDetails(e)),this.lastCard=this.lastCardSelection=e,this.lastSelectionRow=sf.base.closest(e,".e-content-row"),this.lastSelectionRow.previousElementSibling){var y=this.lastSelectionRow.previousElementSibling.querySelector(".e-swimlane-row-expand,.e-swimlane-row-collapse");y&&y.classList.contains("e-swimlane-row-collapse")&&this.rowExpandCollapse(y)}}}},e.prototype.addColumn=function(e,t){this.parent.columns.splice(t,0,e),this.parent.notify(p,{processedData:this.parent.kanbanData})},e.prototype.deleteColumn=function(e){var t=this.parent.element.querySelectorAll(".e-header-cells").item(e);t&&t.classList.contains("e-toggle-header")&&this.columnToggleArray.splice(this.columnToggleArray.indexOf(t.getAttribute("data-key"),0)),this.parent.columns.splice(e,1),0===this.parent.columns.length?this.parent.destroy():this.parent.notify(p,{processedData:this.parent.kanbanData})},e.prototype.showColumn=function(e){var t=this.hideColumnKeys.indexOf(e);-1!==t&&(this.hideColumnKeys.splice(t,1),this.parent.notify(p,{processedData:this.parent.kanbanData}))},e.prototype.hideColumn=function(e){this.hideColumnKeys.push(e),this.parent.notify(p,{processedData:this.parent.kanbanData})},e}(),j=function(){function e(e){this.parent=e,this.keyField=this.parent.cardSettings.headerField}return e.prototype.getQuery=function(){return this.parent.dataModule.generateQuery()},e.prototype.getTable=function(){return this.parent.query?this.parent.query.clone().fromTable:null},e.prototype.refreshData=function(e){var t=this,a={requestType:e.requestType,cancel:!1,addedRecords:e.addedRecords,changedRecords:e.changedRecords,deletedRecords:e.deletedRecords};this.parent.dataModule.dataManager.dataSource.offline?this.parent.trigger("actionComplete",a,(function(e){e.cancel||t.parent.dataModule.refreshDataManager()})):e.promise.then((function(e){t.parent.isDestroyed||t.parent.trigger("actionComplete",a,(function(e){e.cancel||t.parent.dataModule.refreshDataManager()}))})).catch((function(e){t.parent.isDestroyed||t.parent.trigger("actionFailure",{error:e})}))},e.prototype.addCard=function(e){var t=this,a={cancel:!1,requestType:"cardCreate",addedRecords:e instanceof Array?e:[e],changedRecords:[],deletedRecords:[]};this.parent.trigger("actionBegin",a,(function(a){if(!a.cancel){t.parent.showSpinner();var n=null,r=[];t.parent.sortSettings.field&&"Index"===t.parent.sortSettings.sortBy&&(e instanceof Array?r=e:r.push(e),t.parent.isBlazorRender()||(r=t.priorityOrder(r,a)));var s=e instanceof Array?e:[e],i=t.parent.sortSettings.field&&"Index"===t.parent.sortSettings.sortBy?r:[],o={addedRecords:s,changedRecords:i,deletedRecords:[]};if(e instanceof Array||r.length>0?t.parent.isBlazorRender()?t.parent.interopAdaptor.invokeMethodAsync("AddCards",{AddedRecords:s,ChangedRecords:i},t.keyField):n=t.parent.dataModule.dataManager.saveChanges(o,t.keyField,t.getTable(),t.getQuery()):t.parent.isBlazorRender()?t.parent.interopAdaptor.invokeMethodAsync("AddCard",{Record:e}):n=t.parent.dataModule.dataManager.insert(e,t.getTable(),t.getQuery()),!t.parent.isBlazorRender()){var l={requestType:"cardCreated",cancel:!1,promise:n,addedRecords:o.addedRecords,changedRecords:o.changedRecords,deletedRecords:o.deletedRecords};t.refreshData(l)}}}))},e.prototype.updateCard=function(e){var t=this,a={requestType:"cardChange",cancel:!1,addedRecords:[],changedRecords:e instanceof Array?e:[e],deletedRecords:[]};this.parent.trigger("actionBegin",a,(function(a){if(!a.cancel){t.parent.showSpinner();var n=null;if(t.parent.sortSettings.field&&"Index"===t.parent.sortSettings.sortBy){var r=[];e instanceof Array?r=e:r.push(e),t.parent.isBlazorRender()||(e=t.priorityOrder(r,a))}var s={addedRecords:[],changedRecords:e instanceof Array?e:[e],deletedRecords:[]};if(e instanceof Array?t.parent.isBlazorRender()?t.parent.interopAdaptor.invokeMethodAsync("UpdateCards",{ChangedRecords:e},t.keyField):n=t.parent.dataModule.dataManager.saveChanges(s,t.keyField,t.getTable(),t.getQuery()):t.parent.isBlazorRender()?t.parent.interopAdaptor.invokeMethodAsync("UpdateCard",t.keyField,{Record:e}):n=t.parent.dataModule.dataManager.update(t.keyField,e,t.getTable(),t.getQuery()),!t.parent.isBlazorRender()){var i={requestType:"cardChanged",cancel:!1,promise:n,addedRecords:s.addedRecords,changedRecords:s.changedRecords,deletedRecords:s.deletedRecords};t.refreshData(i)}}}))},e.prototype.deleteCard=function(e){var t=this,a={addedRecords:[],changedRecords:[],deletedRecords:[]};a.deletedRecords="string"==typeof e||"number"==typeof e?this.parent.kanbanData.filter((function(a){return a[t.keyField]===e})):e instanceof Array?e:[e];var n={requestType:"cardRemove",cancel:!1,addedRecords:[],changedRecords:[],deletedRecords:a.deletedRecords};this.parent.trigger("actionBegin",n,(function(n){if(!n.cancel){t.parent.showSpinner();var r=null;if(a.deletedRecords.length>1?t.parent.isBlazorRender()?t.parent.interopAdaptor.invokeMethodAsync("DeleteCards",{DeletedRecords:e},t.keyField):r=t.parent.dataModule.dataManager.saveChanges(a,t.keyField,t.getTable(),t.getQuery()):t.parent.isBlazorRender()?t.parent.interopAdaptor.invokeMethodAsync("DeleteCard",t.keyField,{Record:e}):r=t.parent.dataModule.dataManager.remove(t.keyField,a.deletedRecords[0],t.getTable(),t.getQuery()),!t.parent.isBlazorRender()){var s={requestType:"cardRemoved",cancel:!1,promise:r,addedRecords:a.addedRecords,changedRecords:a.changedRecords,deletedRecords:a.deletedRecords};t.refreshData(s)}}}))},e.prototype.priorityOrder=function(e,t){for(var a,n=this,r=e.map((function(e){return e[n.parent.cardSettings.headerField]})),s=e.map((function(e){return e[n.parent.keyField]})),i=s.filter((function(e,t){return s.indexOf(e)===t})).sort(),o=[],l=function(s){var i=e.filter((function(e){return e[n.parent.keyField]===s}));a=d.parent.getColumnData(s),"Descending"===d.parent.sortSettings.direction&&(a=d.removeData(a,i));for(var l=1,c=void 0,p=0,h=i;p<h.length;p++){var u=h[p],f=void 0;if(u[d.parent.sortSettings.field]?f=u[d.parent.sortSettings.field]:(1===l&&(c=a.slice(-1)[0][d.parent.sortSettings.field]),f=u[d.parent.sortSettings.field]=(l>1?c:a.slice(-1)[0][d.parent.sortSettings.field])+l,l++),d.parent.swimlaneSettings.keyField){var g=d.parent.getSwimlaneData(u[d.parent.swimlaneSettings.keyField]);a=d.parent.getColumnData(s,g),"Descending"===d.parent.sortSettings.direction&&(a=d.removeData(a,i))}for(var m=[],y=0;y<a.length;y++)if(a[y][d.parent.sortSettings.field]===f){m.push(y+1);break}"cardChange"===t.requestType&&o.push(u);var b=o.map((function(e){return e[n.parent.cardSettings.headerField]}));if("Ascending"===d.parent.sortSettings.direction)for(var v=m[0];v<=a.length;v++){var C=a[v-1];if(-1===r.indexOf(C[d.parent.cardSettings.headerField])&&f>=C[d.parent.sortSettings.field]){C[d.parent.sortSettings.field]=++f;var w=b.indexOf(C[d.parent.cardSettings.headerField]);-1===w?o.push(C):o[w]=C}}else for(v=m[0];v>0;v--)(C=a[v-1])[d.parent.sortSettings.field]=++f,o.push(C)}},d=this,c=0,p=i;c<p.length;c++)l(p[c]);return o},e.prototype.removeData=function(e,t){return t.map((function(t){-1!==e.indexOf(t)&&e.splice(e.indexOf(t),1)})),e},e}(),T=function(){function e(e){this.parent=e,this.dragObj={element:null,cloneElement:null,instance:null,targetClone:null,draggedClone:null,targetCloneMulti:null,selectedCards:[],pageX:0,pageY:0,navigationInterval:null,cardDetails:[],modifiedData:[]},this.dragEdges={left:!1,right:!1,top:!1,bottom:!1},this.isDragging=!1}return e.prototype.wireDragEvents=function(e){this.dragObj.instance=new sf.base.Draggable(e,{clone:!0,enableTapHold:this.parent.isAdaptive,enableTailMode:!0,cursorAt:{top:-10,left:-10},dragArea:this.parent.element.querySelector("."+x),dragStart:this.dragStart.bind(this),drag:this.drag.bind(this),dragStop:this.dragStop.bind(this),enableAutoScroll:!1,helper:this.dragHelper.bind(this)}),this.dragObj.instance.enableTapHold&&sf.base.Browser.isDevice&&sf.base.Browser.isTouch||sf.base.EventHandler.remove(e,"touchstart",this.dragObj.instance.initialize)},e.prototype.dragHelper=function(e){if(this.parent.isAdaptive&&this.parent.touchModule.mobilePopup&&this.parent.touchModule.mobilePopup.element.classList.contains("e-popup-open")&&this.parent.touchModule.mobilePopup.hide(),this.dragObj.element=sf.base.closest(e.sender.target,".e-card"),sf.base.isNullOrUndefined(this.dragObj.element))return null;this.dragObj.element.style.width=sf.base.formatUnit(this.dragObj.element.offsetWidth);var t=sf.base.createElement("div",{innerHTML:this.dragObj.element.outerHTML});return this.dragObj.cloneElement=t.children.item(0),sf.base.addClass([this.dragObj.cloneElement],"e-cloned-card"),this.dragObj.element.parentElement.appendChild(this.dragObj.cloneElement),this.dragObj.targetCloneMulti=sf.base.createElement("div",{className:"e-target-multi-clone"}),this.dragObj.targetClone=sf.base.createElement("div",{className:"e-target-dropped-clone",styles:"width:"+sf.base.formatUnit(this.dragObj.element.offsetWidth)+";height:"+sf.base.formatUnit(this.dragObj.element.offsetHeight)}),this.dragObj.modifiedData=[],this.dragObj.cloneElement},e.prototype.dragStart=function(e){var t=this;if(this.dragObj.selectedCards=this.dragObj.element,this.dragObj.element.classList.contains("e-selection")){var a=sf.base.closest(this.dragObj.element,".e-content-row");this.dragObj.selectedCards=[].slice.call(a.querySelectorAll(".e-card.e-selection:not(.e-cloned-card)")),this.dragObj.selectedCards.forEach((function(e){t.dragObj.cardDetails.push(t.parent.getCardDetails(e))}))}else this.dragObj.cardDetails=[this.parent.getCardDetails(this.dragObj.element)];var n={cancel:!1,data:this.dragObj.cardDetails,event:e,element:this.dragObj.selectedCards};this.parent.trigger("dragStart",n,(function(a){if(a.cancel)return t.removeElement(t.dragObj.cloneElement),t.dragObj.instance.intDestroy(e),t.dragObj.element=null,t.dragObj.targetClone=null,t.dragObj.draggedClone=null,t.dragObj.cloneElement=null,void(t.dragObj.targetCloneMulti=null);if(t.parent.isBlazorRender()&&e.bindEvents(e.dragElement),t.dragObj.element.classList.contains("e-selection")){if(t.dragObj.selectedCards.forEach((function(e){t.draggedClone(e)})),t.dragObj.selectedCards.length>1){t.dragObj.cloneElement.innerHTML="";var n=sf.base.createElement("div",{className:"e-multi-card-text",innerHTML:t.dragObj.selectedCards.length+" Cards"});t.dragObj.cloneElement.appendChild(n),sf.base.classList(t.dragObj.cloneElement,["e-multi-card-clone"],["e-selection"]),t.parent.layoutModule.disableAttributeSelection(t.dragObj.cloneElement),t.dragObj.cloneElement.style.width="90px"}}else t.draggedClone(t.dragObj.element);t.parent.notify(c,{})}))},e.prototype.draggedClone=function(e){this.dragObj.draggedClone=sf.base.createElement("div",{className:"e-target-dragged-clone",styles:"width:"+sf.base.formatUnit(e.offsetWidth-1)+";height:"+sf.base.formatUnit(e.offsetHeight)}),e.insertAdjacentElement("afterend",this.dragObj.draggedClone),sf.base.addClass([e],"e-kanban-dragged-card")},e.prototype.drag=function(e){var t=this;if(e.target){var a=sf.base.closest(e.target,".e-card")||e.target,n=sf.base.closest(a,".e-content-row:not(.e-swimlane-row) .e-content-cells");if(this.calculateArgs(e),n){var r=this.getColumnKey(n),s=r.split(",");this.multiCloneRemove();var i=r===this.getColumnKey(sf.base.closest(this.dragObj.draggedClone,".e-content-cells"));if(1===s.length||i)if(a.classList.contains("e-card")||a.classList.contains("e-target-dragged-clone")){var o=a.classList.contains("e-target-dragged-clone")&&a.previousElementSibling.classList.contains("e-kanban-dragged-card")?null:a.previousElementSibling,l="afterend";if(sf.base.isNullOrUndefined(o)){var d=a.classList.contains("e-target-dragged-clone")?this.dragObj.pageY/2:this.dragObj.pageY,p=a.classList.contains("e-target-dragged-clone")?a.offsetHeight:a.offsetHeight/2;d-(this.parent.element.getBoundingClientRect().top+a.offsetTop)<p&&(l="beforebegin")}a.insertAdjacentElement(l,this.dragObj.targetClone)}else a.classList.contains("e-content-cells")&&!sf.base.closest(a,".e-swimlane-row")?a.querySelector(".e-card-wrapper").appendChild(this.dragObj.targetClone):a.classList.contains("e-card-wrapper")&&!sf.base.closest(a,".e-swimlane-row")&&0===n.querySelectorAll(".e-card").length&&a.appendChild(this.dragObj.targetClone);else s.length>1&&this.multiCloneCreate(s,n);this.parent.notify(c,{})}this.addDropping();var h=!1;n&&(h=n.classList.contains("e-collapsed")&&n.classList.contains("e-dropping")),h&&(this.toggleVisible(a,void 0),sf.base.addClass([n],"e-toggle-visible"));var u=[].slice.call(this.parent.element.querySelectorAll(".e-toggle-visible"));u.length>0&&!a.classList.contains("e-toggle-visible")&&!sf.base.closest(a,".e-toggle-visible")&&(this.toggleVisible(a,u.slice(-1)[0]),sf.base.removeClass(u,"e-toggle-visible")),this.parent.notify(c,{});var f=sf.base.closest(a,".e-content-cells:not(.e-collapsed)");f&&(this.dragObj.targetClone.style.width=sf.base.formatUnit(f.offsetWidth-2-16));var g=sf.base.closest(a,".e-column-key");if(g){var m=[].slice.call(this.parent.element.querySelectorAll(".e-column-key")).filter((function(e){return t.getColumnKey(e)===t.getColumnKey(g)}));m.length>0&&(sf.base.addClass(m,"e-multi-active"),m[0].previousElementSibling&&sf.base.addClass([m[0].previousElementSibling],"e-multi-bottom-border"))}if(document.body.style.cursor=n?"":"not-allowed",this.parent.swimlaneSettings.keyField&&!this.parent.swimlaneSettings.allowDragAndDrop){var y=sf.base.closest(this.dragObj.element,".e-content-row"),b=sf.base.closest(a,".e-content-row:not(.e-swimlane-row)");y&&b&&y.rowIndex!==b.rowIndex&&(document.body.style.cursor="not-allowed")}"not-allowed"===document.body.style.cursor&&(this.removeElement(this.dragObj.targetClone),this.multiCloneRemove()),this.updateScrollPosition(e);var v={data:this.dragObj.cardDetails,event:e,element:this.dragObj.selectedCards};this.parent.trigger("drag",v)}},e.prototype.removeElement=function(e){this.parent.element.getElementsByClassName(e.className).length>0&&sf.base.remove(e)},e.prototype.multiCloneCreate=function(e,t){var a=t.offsetHeight,n=t.querySelector(".e-limits");n&&(a-=n.offsetHeight),this.dragObj.targetCloneMulti.style.height=sf.base.formatUnit(a),t.querySelector("."+M)&&sf.base.addClass([t.querySelector("."+M)],"e-multi-card-wrapper"),sf.base.addClass([t.querySelector(".e-card-wrapper")],"e-multi-card-wrapper"),t.querySelector(".e-card-wrapper").style.height="auto",t.style.borderStyle="none",this.removeElement(this.dragObj.targetClone);for(var r=0,s=e;r<s.length;r++){var i=s[r],o=sf.base.createElement("div",{className:"e-column-key",attrs:{"data-key":i.trim()}}),l=sf.base.createElement("div",{className:"e-text",innerHTML:i.trim()});t.appendChild(this.dragObj.targetCloneMulti).appendChild(o).appendChild(l),o.style.lineHeight=o.style.height=sf.base.formatUnit(a/e.length),l.style.top=sf.base.formatUnit(a/2-l.offsetHeight/2)}},e.prototype.addDropping=function(){if(this.parent.swimlaneSettings.keyField&&this.parent.swimlaneSettings.allowDragAndDrop)[].slice.call(this.parent.element.querySelectorAll(".e-content-row:not(.e-swimlane-row):not(.e-collapsed) .e-content-cells")).forEach((function(e){return sf.base.addClass([e],"e-dropping")}));else{var e=sf.base.closest(this.dragObj.draggedClone,".e-content-row");e&&[].slice.call(e.children).forEach((function(e){return sf.base.addClass([e],"e-dropping")}))}var t=sf.base.closest(this.dragObj.draggedClone,".e-content-cells");t&&sf.base.removeClass([t],"e-dropping")},e.prototype.dragStop=function(e){var t,a,n=this,r=sf.base.closest(this.dragObj.targetClone,".e-content-cells");this.parent.element.querySelector(".e-target-multi-clone")&&(t=sf.base.closest(e.target,".e-column-key")),(r||t)&&(r?a=this.getColumnKey(r):(a=this.getColumnKey(t),r=sf.base.closest(t,".e-content-cells")),this.dragObj.selectedCards instanceof HTMLElement?this.updateDroppedData(this.dragObj.selectedCards,a,r):this.dragObj.selectedCards.forEach((function(e){n.updateDroppedData(e,a,r)})),this.parent.sortSettings.field&&"Index"===this.parent.sortSettings.sortBy&&this.changeOrder(this.dragObj.modifiedData));var s={cancel:!1,data:this.dragObj.modifiedData,event:e,element:this.dragObj.selectedCards};this.parent.trigger("dragStop",s,(function(e){e.cancel||(r||t)&&n.parent.crudModule.updateCard(n.dragObj.modifiedData),n.removeElement(n.dragObj.draggedClone),n.removeElement(n.dragObj.targetClone),n.removeElement(n.dragObj.cloneElement),[].slice.call(n.parent.element.querySelectorAll(".e-target-dragged-clone")).forEach((function(e){return sf.base.remove(e)})),n.parent.isBlazorRender()&&(n.dragObj.element.style.removeProperty("width"),n.multiCloneRemove()),sf.base.removeClass([n.dragObj.element],"e-kanban-dragged-card"),clearInterval(n.dragObj.navigationInterval),n.dragObj.navigationInterval=null,"not-allowed"===document.body.style.cursor&&(document.body.style.cursor=""),[].slice.call(n.parent.element.querySelectorAll(".e-content-row:not(.e-swimlane-row) .e-content-cells")).forEach((function(e){return sf.base.removeClass([e],"e-dropping")})),n.parent.isAdaptive&&(n.parent.touchModule.tabHold=!1),n.dragObj.cardDetails=n.dragObj.modifiedData=[],n.isDragging=!1}))},e.prototype.updateDroppedData=function(e,t,a){var n=this.parent.getCardDetails(e);if(1===t.split(",").length&&(n[this.parent.keyField]=t),this.parent.swimlaneSettings.keyField&&this.parent.swimlaneSettings.allowDragAndDrop){var r=sf.base.closest(a,".e-content-row").previousElementSibling;if(this.parent.isAdaptive){var s=this.parent.layoutModule.kanbanRows[this.parent.layoutModule.swimlaneIndex].keyField;n[this.parent.swimlaneSettings.keyField]=s}else n[this.parent.swimlaneSettings.keyField]=this.getColumnKey(r)}this.dragObj.modifiedData.push(n)},e.prototype.changeOrder=function(e){var t=this,a=!1,n="Ascending"===this.parent.sortSettings.direction?this.dragObj.targetClone.previousElementSibling:this.dragObj.targetClone.nextElementSibling;if(!n||n.classList.contains("e-kanban-dragged-card")||n.classList.contains("e-cloned-card")||n.classList.contains("e-target-dragged-clone"))if(this.dragObj.targetClone.nextElementSibling&&"Ascending"===this.parent.sortSettings.direction)n=this.dragObj.targetClone.nextElementSibling;else{if(!this.dragObj.targetClone.previousElementSibling||"Descending"!==this.parent.sortSettings.direction)return;n=this.dragObj.targetClone.previousElementSibling}else a=!0;var r=this.parent.getCardDetails(n)[this.parent.sortSettings.field];e.length>1&&"Descending"===this.parent.sortSettings.direction&&(e=e.reverse()),e.forEach((function(e,n){a?e[t.parent.sortSettings.field]=++r:1!==r&&n<=e[t.parent.sortSettings.field]?e[t.parent.sortSettings.field]=--r:1===r&&(e[t.parent.sortSettings.field]=n+1)}))},e.prototype.toggleVisible=function(e,t){var a=this;[].slice.call(this.parent.element.querySelectorAll(".e-header-cells:not(.e-stacked-header-cell)")).forEach((function(n){a.getColumnKey(n)===a.getColumnKey(t||e)&&a.parent.actionModule.columnToggle(n)}));var n=sf.base.closest(this.dragObj.draggedClone,".e-content-cells");if(n){var r=sf.base.formatUnit(n.offsetWidth-16);this.dragObj.draggedClone.style.width=r,this.dragObj.cloneElement.style.width=r}},e.prototype.multiCloneRemove=function(){var e=[].slice.call(this.parent.element.querySelectorAll(".e-target-multi-clone"));e.length>0&&([].slice.call(this.parent.element.querySelectorAll(".e-column-key")).forEach((function(e){return sf.base.remove(e)})),e.forEach((function(e){var t=sf.base.closest(e,".e-content-cells");t&&(t.style.borderStyle="",t.querySelector("."+M)&&sf.base.removeClass([t.querySelector("."+M)],"e-multi-card-wrapper"),sf.base.removeClass([t.querySelector(".e-card-wrapper")],"e-multi-card-wrapper"))})),this.removeElement(this.dragObj.targetCloneMulti))},e.prototype.calculateArgs=function(e){var t=this.getPageCoordinates(e);this.dragObj.pageY=t.pageY,this.dragObj.pageX=t.pageX,this.isDragging=!0,this.parent.isAdaptive&&this.parent.tooltipModule&&this.parent.tooltipModule.tooltipObj.close()},e.prototype.getPageCoordinates=function(e){var t=e.event;return t&&t.changedTouches?t.changedTouches[0]:e.changedTouches?e.changedTouches[0]:t||e},e.prototype.getColumnKey=function(e){return e&&e.getAttribute("data-key")?e.getAttribute("data-key").trim():""},e.prototype.updateScrollPosition=function(e){var t=this;sf.base.isNullOrUndefined(this.dragObj.navigationInterval)&&(this.dragObj.navigationInterval=window.setInterval((function(){t.autoScrollValidation(e)&&t.autoScroll()}),100))},e.prototype.autoScrollValidation=function(e){var t=this.dragObj.pageY,a=this.dragObj.pageX,n={left:!1,right:!1,top:!1,bottom:!1};return this.dragObj.pageY-window.scrollY<66&&(n.top=!0),t>window.innerHeight-30+window.pageYOffset&&t<window.innerHeight+window.pageYOffset&&(n.bottom=!0),a<30+window.pageXOffset&&a>0+window.pageXOffset&&(n.left=!0),a>window.innerWidth-30+window.pageXOffset&&a<window.innerWidth+window.pageXOffset&&(n.right=!0),this.dragEdges=n,n.bottom||n.top||n.left||n.right},e.prototype.autoScroll=function(){var e;if(this.parent.isAdaptive){if(this.dragEdges.top||this.dragEdges.bottom?e=this.dragObj.targetClone?sf.base.closest(this.dragObj.targetClone,".e-card-wrapper"):sf.base.closest(this.dragObj.draggedClone,".e-card-wrapper"):(this.dragEdges.right||this.dragEdges.left)&&(e=this.parent.element.querySelector("."+x)),e){var t=e.offsetHeight<=e.scrollHeight,a=e.offsetWidth<=e.scrollWidth,n=e.scrollTop>=0&&e.scrollTop+e.offsetHeight<=e.scrollHeight,r=e.scrollLeft>=0&&e.scrollLeft+e.offsetWidth<=e.scrollWidth;t&&n&&(this.dragEdges.top||this.dragEdges.bottom)&&(e.scrollTop+=this.dragEdges.top?-66:30),a&&r&&(this.dragEdges.left||this.dragEdges.right)&&(this.parent.layoutModule.getWidth()*(this.parent.columns.length-1)>e.scrollLeft||this.dragEdges.left)&&(e.scrollLeft+=this.dragEdges.left?-30:30)}}else this.dragObj.pageY-window.scrollY<30?window.scrollTo(window.scrollX,window.scrollY-30):window.innerHeight-(this.dragObj.pageY-window.scrollY)<30&&window.scrollTo(window.scrollX,window.scrollY+30)},e.prototype.unWireDragEvents=function(e){var t=e.ej2_instances[0];t&&!t.isDestroyed&&t.destroy()},e}(),F=function(){function e(e){this.parent=e}return e.prototype.openDialog=function(e,t){this.action=e,this.parent.activeCardData.data=t,this.renderDialog(t,e),this.dialogObj.show()},e.prototype.closeDialog=function(){this.dialogObj.hide()},e.prototype.renderDialog=function(e,t){this.element=sf.base.createElement("div",{id:this.parent.element.id+"_dialog_wrapper"}),this.parent.element.appendChild(this.element);var a={buttons:this.getDialogButtons(t),content:this.getDialogContent(e,t),cssClass:"e-kanban-dialog",enableRtl:this.parent.enableRtl,header:this.parent.localeObj.getConstant("Add"===t?"addTitle":"Edit"===t?"editTitle":"deleteTitle"),height:"auto",isModal:!0,showCloseIcon:!0,width:"Delete"===t?400:350,visible:!1,beforeOpen:this.onBeforeDialogOpen.bind(this),beforeClose:this.onBeforeDialogClose.bind(this)};this.dialogObj=new sf.popups.Dialog(sf.base.extend(a,"Delete"!==t&&this.parent.dialogSettings.model||{}),this.element),"Delete"!==t&&this.applyFormValidation(),this.dialogObj.element.querySelector(".e-dlg-closeicon-btn").title=this.parent.localeObj.getConstant("close")},e.prototype.getDialogContent=function(e,t){if("Delete"===t)return this.parent.localeObj.getConstant("deleteContent");var a=sf.base.createElement("div",{className:"e-kanban-form-wrapper"}),n=sf.base.createElement("form",{id:this.parent.element.id+"EditForm",className:"e-kanban-form",attrs:{onsubmit:"return false;"}});if(this.parent.dialogSettings.template)e&&(this.destroyComponents(),[].slice.call(n.childNodes).forEach((function(e){return sf.base.remove(e)}))),sf.base.append(this.parent.templateParser(this.parent.dialogSettings.template)(e),n);else{var r=sf.base.createElement("div",{className:"e-kanban-dialog-content"});n.appendChild(r);var s=sf.base.createElement("table");r.appendChild(s);for(var i=0,o=this.getDialogFields();i<o.length;i++){var l=o[i],d=sf.base.createElement("tr");s.appendChild(d),d.appendChild(sf.base.createElement("td",{className:"e-label",innerHTML:l.text?l.text:l.key}));var c=sf.base.createElement("td");d.appendChild(c),c.appendChild(this.renderComponents(l))}}return a.appendChild(n),a},e.prototype.getDialogFields=function(){var e=this.parent.dialogSettings.fields;return 0===e.length&&(e=[{text:"ID",key:this.parent.cardSettings.headerField,type:"TextBox"},{key:this.parent.keyField,type:"DropDown"},{key:this.parent.cardSettings.contentField,type:"TextArea"}],"DataSourceOrder"!==this.parent.sortSettings.sortBy&&e.splice(e.length-1,0,{key:this.parent.sortSettings.field,type:"TextBox"}),this.parent.swimlaneSettings.keyField&&e.splice(e.length-1,0,{key:this.parent.swimlaneSettings.keyField,type:"DropDown"})),e},e.prototype.getDialogButtons=function(e){var t="Delete"===e?"e-dialog-no":"e-dialog-cancel",a=[{buttonModel:{cssClass:"e-flat "+("Delete"===e?"e-dialog-yes":"Add"===e?"e-dialog-add":"e-dialog-edit"),isPrimary:!0,content:this.parent.localeObj.getConstant("Add"===e||"Edit"===e?"save":"yes")},click:this.dialogButtonClick.bind(this)},{buttonModel:{cssClass:"e-flat "+t,isPrimary:!1,content:this.parent.localeObj.getConstant("Add"===e||"Edit"===e?"cancel":"no")},click:this.dialogButtonClick.bind(this)}];if("Edit"===e){var n={buttonModel:{cssClass:"e-flat e-dialog-delete",isPrimary:!1,content:this.parent.localeObj.getConstant("delete")},click:this.dialogButtonClick.bind(this)};a.splice(0,0,n)}return a},e.prototype.renderComponents=function(e){var t,a=sf.base.createElement("div",{className:e.key+"_wrapper"}),n=sf.base.createElement("input",{className:"e-field",attrs:{name:e.key}});a.appendChild(n);var r=this.parent.activeCardData.data?this.parent.activeCardData.data[e.key]:null;switch(e.type){case"DropDown":var s=void 0;e.key===this.parent.keyField?s={dataSource:this.parent.layoutModule.columnKeys,value:r}:e.key===this.parent.swimlaneSettings.keyField&&(s={dataSource:[].slice.call(this.parent.layoutModule.kanbanRows),fields:{text:"textField",value:"keyField"},value:r}),t=new sf.dropdowns.DropDownList(s);break;case"Numeric":t=new sf.inputs.NumericTextBox({value:r});break;case"TextBox":t=new sf.inputs.TextBox({value:r}),r&&this.parent.cardSettings.headerField===e.key&&(t.enabled=!1);break;case"TextArea":sf.base.remove(n);var i=sf.base.createElement("div");n=sf.base.createElement("textarea",{className:"e-field",attrs:{name:e.key,rows:"3"},innerHTML:r}),a.appendChild(i).appendChild(n)}return t&&t.appendTo(n),a},e.prototype.onBeforeDialogOpen=function(e){var t={data:this.parent.activeCardData.data,cancel:!1,element:this.element,target:this.parent.activeCardData.element,requestType:this.action};this.storeElement=document.activeElement,parseInt(e.maxHeight,10)<=250&&(e.maxHeight="250px"),this.parent.trigger("dialogOpen",t,(function(t){return e.cancel=t.cancel}))},e.prototype.onBeforeDialogClose=function(e){for(var t=this,a={},n=0,r=this.getFormElements();n<r.length;n++){var s=r[n],i=s.name||this.getColumnName(s);if(!sf.base.isNullOrUndefined(i)&&""!==i){var o=this.getValueFromElement(s);i===this.parent.cardSettings.headerField&&(o="string"===this.getIDType()?o:parseInt(o,10)),a[i]=o}}var l={data:a,cancel:!1,element:this.element,requestType:this.action};this.parent.trigger("dialogClose",l,(function(a){e.cancel=a.cancel,a.cancel||(t.cardData=l.data,t.destroy())}))},e.prototype.getIDType=function(){return 0!==this.parent.kanbanData.length?r()(this.parent.kanbanData[0][this.parent.cardSettings.headerField]):"string"},e.prototype.applyFormValidation=function(){for(var e=this,t=this.element.querySelector(".e-kanban-form"),a={},n=0,r=this.parent.dialogSettings.fields;n<r.length;n++){var s=r[n];a[s.key]=s.validationRules&&Object.keys(s.validationRules).length>0?s.validationRules:null}this.formObj=new sf.inputs.FormValidator(t,{rules:a,customPlacement:function(t,a){var n=a.getAttribute("for");e.element.querySelector("#"+n+"_Error")||e.createTooltip(t,a,n,"")},validationComplete:function(t){var a=e.element.querySelector("#"+t.inputName+"_Error");a&&(a.style.display="failure"===t.status?"":"none")}})},e.prototype.createTooltip=function(e,t,a,n){var r,s,i=e.parentElement.getBoundingClientRect();this.element.classList.contains("e-kanban-dialog")?(r=this.element,s=this.element.getBoundingClientRect()):s=(r=this.element.querySelector(".e-kanban-dialog .e-dlg-content")).getBoundingClientRect();var o=sf.base.createElement("div",{className:"e-tooltip-wrap e-popup e-kanban-error",id:a+"_Error",styles:"display:"+n+";top:"+(i.bottom-s.top+r.scrollTop+9)+"px;left:"+(i.left-s.left+r.scrollLeft+i.width/2)+"px;"}),l=sf.base.createElement("div",{className:"e-tip-content"});l.appendChild(t);var d=sf.base.createElement("div",{className:"e-arrow-tip e-tip-top"});d.appendChild(sf.base.createElement("div",{className:"e-arrow-tip-outer e-tip-top"})),d.appendChild(sf.base.createElement("div",{className:"e-arrow-tip-inner e-tip-top"})),o.appendChild(l),o.appendChild(d),r.appendChild(o),o.style.left=parseInt(o.style.left,10)-o.offsetWidth/2+"px"},e.prototype.destroyToolTip=function(){this.element&&this.element.querySelectorAll(".e-kanban-error").forEach((function(e){return sf.base.remove(e)})),this.formObj&&this.formObj.element&&this.formObj.reset()},e.prototype.dialogButtonClick=function(e){var t=e.target.cloneNode(!0),a=this.formObj.element.id;document.getElementById(a)&&this.formObj.validate()&&(t.classList.contains("e-dialog-edit")||t.classList.contains("e-dialog-add"))&&(this.dialogObj.hide(),t.classList.contains("e-dialog-edit")&&this.parent.crudModule.updateCard(this.cardData),t.classList.contains("e-dialog-add")&&this.parent.crudModule.addCard(this.cardData),this.cardData=null),t.classList.contains("e-dialog-edit")||t.classList.contains("e-dialog-add")||(this.dialogObj.hide(),t.classList.contains("e-dialog-yes")?this.parent.crudModule.deleteCard(this.parent.activeCardData.data):t.classList.contains("e-dialog-no")?this.openDialog("Edit",this.parent.activeCardData.data):t.classList.contains("e-dialog-delete")&&this.openDialog("Delete",this.parent.activeCardData.data))},e.prototype.getFormElements=function(){for(var e=[],t=0,a=[].slice.call(this.element.querySelectorAll(".e-field"));t<a.length;t++){var n=a[t];n.classList.contains("e-control")?e.push(n):n.querySelector(".e-control")?e.push(n.querySelector(".e-control")):e.push(n)}return e},e.prototype.getColumnName=function(e){var t=e.getAttribute("data-name")||"";if(""===t){var a=!1,n="";e.classList.contains("e-dropdownlist")||e.classList.contains("e-multiselect")?(n=e.classList.contains("e-dropdownlist")?"e-ddl":"e-multiselect",a=!0):e.classList.contains("e-numerictextbox")&&(n="e-numeric");var r=a?"."+n+":not(.e-control)":"."+n,s=sf.base.closest(e,r)||e.querySelector("."+n);if(s){var i=s.querySelector("[name]");i&&(t=i.name)}}return t},e.prototype.getValueFromElement=function(e){var t=e.ej2_instances;return t&&t.length>0?t[0].value||t[0].checked:e.value},e.prototype.destroyComponents=function(){for(var e=0,t=this.getFormElements();e<t.length;e++){var a=t[e].ej2_instances;a&&a.length>0&&a.forEach((function(e){return e.destroy()}))}},e.prototype.destroy=function(){this.destroyToolTip(),this.destroyComponents(),this.dialogObj&&(this.dialogObj.destroy(),this.storeElement.focus(),this.dialogObj=null,sf.base.remove(this.element),this.element=null)},e}(),q=function(){function e(e){this.keyConfigs={firstCardSelection:"36",lastCardSelection:"35",upArrow:"38",downArrow:"40",rightArrow:"39",leftArrow:"37",multiSelectionEnter:"ctrl+13",multiSelectionSpace:"ctrl+32",multiSelectionByUpArrow:"shift+38",multiSelectionByDownArrow:"shift+40",shiftTab:"shift+tab",enter:"13",tab:"tab",delete:"46",escape:"27",space:"32"},this.parent=e,this.parent.element.tabIndex=-1===this.parent.element.tabIndex?0:this.parent.element.tabIndex,this.keyboardModule=new sf.base.KeyboardEvents(this.parent.element,{keyAction:this.keyActionHandler.bind(this),keyConfigs:this.keyConfigs,eventName:"keydown"}),this.multiSelection=!1}return e.prototype.keyActionHandler=function(e){var t=this,a=this.parent.element.querySelectorAll(".e-card.e-selection").item(0);if(a||sf.base.closest(document.activeElement,".e-kanban"))switch(e.action){case"upArrow":case"downArrow":case"multiSelectionByUpArrow":case"multiSelectionByDownArrow":this.processUpDownArrow(e.action,a);break;case"rightArrow":case"leftArrow":this.processLeftRightArrow(e);break;case"firstCardSelection":case"lastCardSelection":this.processCardSelection(e.action,a);break;case"multiSelectionEnter":case"multiSelectionSpace":document.activeElement&&this.parent.actionModule.cardSelection(document.activeElement,!0,!1);break;case"space":case"enter":this.processEnter(e,a);break;case"escape":if(document.activeElement.classList.contains("e-card")||document.activeElement.classList.contains(M))if(document.activeElement.classList.contains("e-selection"))sf.base.removeClass([document.activeElement],"e-selection"),document.activeElement.focus();else{var n=sf.base.closest(document.activeElement,".e-content-cells"),r=[].slice.call(n.querySelectorAll(".e-card"));sf.base.removeClass(r,"e-selection"),n.focus(),this.cardTabIndexRemove(),this.addRemoveTabIndex("Add")}break;case"tab":case"shiftTab":var s=sf.base.closest(document.activeElement,".e-content-cells");document.activeElement.classList.contains("e-card")&&(document.activeElement.nextElementSibling||"tab"!==e.action||e.preventDefault(),!document.activeElement.previousElementSibling&&s.querySelector("."+M)&&"tab"===e.action&&sf.base.addClass([s.querySelector("."+M)],"e-show-add-focus")),document.activeElement.classList.contains(M)&&(!s.querySelector(".e-card")&&"tab"===e.action||"shiftTab"===e.action)&&e.preventDefault(),document.activeElement.classList.contains("e-kanban")&&(this.cardTabIndexRemove(),this.parent.keyboardModule.addRemoveTabIndex("Add"));break;case"delete":var i=[].slice.call(this.parent.element.querySelectorAll(".e-card.e-selection")),o=[];i.forEach((function(e){o.push(t.parent.getCardDetails(e))})),this.parent.crudModule.deleteCard(o)}},e.prototype.processCardSelection=function(e,t){if(t){sf.base.removeClass([t],"e-selection"),this.parent.layoutModule.disableAttributeSelection(t);var a=this.parent.actionModule.selectionArray;a.splice(a.indexOf(t.getAttribute("data-id")),1)}this.cardTabIndexRemove();var n=[].slice.call(this.parent.element.querySelectorAll(".e-card")),r="firstCardSelection"===e?n[0]:n[n.length-1];this.parent.actionModule.cardSelection(r,!1,!1),this.addRemoveTabIndex("Remove"),r.focus(),[].slice.call(sf.base.closest(r,".e-content-cells").querySelectorAll(".e-card")).forEach((function(e){e.setAttribute("tabindex","0")}))},e.prototype.processLeftRightArrow=function(e){document.activeElement.classList.contains("e-content-cells")&&("rightArrow"===e.action&&document.activeElement.nextElementSibling?document.activeElement.nextElementSibling.focus():"leftArrow"===e.action&&document.activeElement.previousElementSibling&&document.activeElement.previousElementSibling.focus())},e.prototype.processUpDownArrow=function(e,t){if("upArrow"===e&&document.activeElement){if(document.activeElement.classList.contains("e-card")&&document.activeElement.previousElementSibling)document.activeElement.previousElementSibling.focus();else if(document.activeElement.classList.contains(M)){document.activeElement.setAttribute("tabindex","-1"),sf.base.removeClass([document.activeElement],"e-show-add-focus");var a=sf.base.closest(document.activeElement,".e-content-cells");a.querySelectorAll(".e-card").length>0&&[].slice.call(a.querySelectorAll(".e-card")).slice(-1)[0].focus()}this.removeSelection()}else if("downArrow"===e&&document.activeElement&&document.activeElement.classList.contains("e-card")){if(document.activeElement.nextElementSibling)document.activeElement.nextElementSibling.focus();else if(sf.base.closest(document.activeElement,".e-card-wrapper").nextElementSibling){var n=sf.base.closest(document.activeElement,".e-card-wrapper").nextElementSibling;n.setAttribute("tabindex","0"),sf.base.addClass([n],"e-show-add-focus"),n.focus()}this.removeSelection()}if(("multiSelectionByUpArrow"===e||"multiSelectionByDownArrow"===e)&&t&&"Multiple"===this.parent.cardSettings.selectionType){var r=void 0;(r="multiSelectionByUpArrow"===e?document.activeElement.previousElementSibling:document.activeElement.nextElementSibling)&&(this.parent.actionModule.cardSelection(r,!1,!0),r.focus(),this.multiSelection=!0)}},e.prototype.removeSelection=function(){if(this.multiSelection){var e=this.parent.getSelectedCards();e.length>0&&(sf.base.removeClass(e,"e-selection"),this.parent.layoutModule.disableAttributeSelection(e)),this.multiSelection=!1}},e.prototype.cardTabIndexRemove=function(){[].slice.call(this.parent.element.querySelectorAll(".e-card")).forEach((function(e){e.setAttribute("tabindex","-1")})),[].slice.call(this.parent.element.querySelectorAll("."+M)).forEach((function(e){e.setAttribute("tabindex","-1"),sf.base.removeClass([e],"e-show-add-focus")}))},e.prototype.processEnter=function(e,t){var a=e.target;if(a.classList.contains("e-header-icon")&&this.parent.actionModule.columnExpandCollapse(e),(a.classList.contains("e-swimlane-row-expand")||a.classList.contains("e-swimlane-row-collapse"))&&this.parent.actionModule.rowExpandCollapse(e),document.activeElement.classList.contains("e-card")&&this.parent.actionModule.cardSelection(document.activeElement,!1,!1),document.activeElement.classList.contains(M)&&(this.parent.dialogModule.dialogObj||this.parent.actionModule.addButtonClick(document.activeElement),document.activeElement.focus()),a.classList.contains("e-content-cells")){var n=[].slice.call(a.querySelectorAll(".e-card"));this.addRemoveTabIndex("Remove"),n.length>0&&(a.querySelector(".e-card").focus(),n.forEach((function(e){e.setAttribute("tabindex","0")}))),a.querySelector("."+M)&&(a.querySelector("."+M).setAttribute("tabindex","0"),a.querySelector("."+M).focus())}t===document.activeElement&&1===this.parent.element.querySelectorAll(".e-selection").length&&(this.parent.activeCardData={data:this.parent.getCardDetails(t),element:t},this.parent.dialogModule.dialogObj||this.parent.dialogModule.openDialog("Edit",this.parent.getCardDetails(t)),t.focus())},e.prototype.addRemoveTabIndex=function(e){var t="Add"===e?"0":"-1",a=[].slice.call(this.parent.element.querySelectorAll(".e-header-icon"));a.length>0&&a.forEach((function(e){e.setAttribute("tabindex",t)}));var n=[].slice.call(this.parent.element.querySelectorAll(".e-swimlane-row-expand"));n.length>0&&n.forEach((function(e){e.setAttribute("tabindex",t)})),[].slice.call(this.parent.element.querySelectorAll(".e-content-row:not(.e-swimlane-row) .e-content-cells")).forEach((function(e){e.setAttribute("tabindex",t)}))},e.prototype.getModuleName=function(){return"keyboard"},e.prototype.destroy=function(){this.keyboardModule.destroy()},e}(),P=function(){function e(e){this.parent=e,this.renderTooltip()}return e.prototype.renderTooltip=function(){this.tooltipObj=new sf.popups.Tooltip({cssClass:this.parent.cssClass+" e-kanban-tooltip",enableRtl:this.parent.enableRtl,mouseTrail:!this.parent.isAdaptive,offsetY:5,position:"BottomCenter",showTipPointer:!0,target:".e-tooltip-text",beforeRender:this.onBeforeRender.bind(this)}),this.tooltipObj.appendTo(this.parent.element),this.tooltipObj.isStringTemplate=!0},e.prototype.onBeforeRender=function(e){if(this.parent.dragAndDropModule.isDragging)e.cancel=!0;else{var t;if(this.parent.tooltipTemplate){t=sf.base.createElement("div");var a=sf.base.closest(e.target,".e-card"),n=this.parent.getCardDetails(a),r=this.parent.templateParser(this.parent.tooltipTemplate)(n);sf.base.append(r,t)}else t='<div class="e-card-header-caption">'+e.target.innerText+"</div>";this.tooltipObj.setProperties({content:t},!0)}},e.prototype.destroy=function(){this.tooltipObj.destroy(),sf.base.addClass([this.parent.element],"e-control"),this.tooltipObj=null},e}(),L=function(){function e(e){this.parent=e,this.tabHold=!1}return e.prototype.wireTouchEvents=function(){this.element=this.parent.element.querySelector("."+x),this.touchObj=new sf.base.Touch(this.element,{tapHold:this.tapHoldHandler.bind(this)})},e.prototype.tapHoldHandler=function(e){this.tabHold=!0;var t=sf.base.closest(e.originalEvent.target,".e-card");t&&"Multiple"===this.parent.cardSettings.selectionType&&(this.parent.actionModule.cardSelection(t,!0,!1),this.mobilePopup||(this.renderMobilePopup(),this.mobilePopup.show()),this.updatePopupContent())},e.prototype.renderMobilePopup=function(){if("Multiple"===this.parent.cardSettings.selectionType){var e=sf.base.createElement("div",{className:"e-mobile-popup-wrapper e-popup-close",innerHTML:'<div class="e-popup-header"><button class="e-close"></button></div><div class="e-popup-content"></div>'});document.body.appendChild(e),sf.base.addClass([e],"e-device"),this.mobilePopup=new sf.popups.Popup(e,{targetType:"container",enableRtl:this.parent.enableRtl,hideAnimation:{name:"ZoomOut"},showAnimation:{name:"ZoomIn"},collision:{X:"fit",Y:"fit"},position:{X:"left",Y:"top"},viewPortElement:document.body,zIndex:1004,close:this.popupClose.bind(this)});var t=this.mobilePopup.element.querySelector(".e-close"),a=new sf.buttons.Button({cssClass:"e-flat e-round e-small",enableRtl:this.parent.enableRtl,iconCss:"e-icons e-close-icon"});a.appendTo(t),a.isStringTemplate=!0,sf.base.EventHandler.add(t,"click",this.closeClick,this)}},e.prototype.getPopupContent=function(){var e,t=this.parent.getSelectedCards();return t.length>1?e="("+t.length+") "+this.parent.localeObj.getConstant("cardsSelected"):1===t.length&&(e=" "+this.parent.getCardDetails(t[0])[this.parent.cardSettings.headerField]),e},e.prototype.updatePopupContent=function(){if(this.mobilePopup){var e=this.getPopupContent();e?this.mobilePopup.element.querySelector(".e-popup-content").textContent=e:this.mobilePopup.hide()}},e.prototype.closeClick=function(){this.parent.touchModule.mobilePopup.hide()},e.prototype.popupClose=function(){this.popupDestroy()},e.prototype.popupDestroy=function(){if(this.mobilePopup&&this.mobilePopup.element){var e=this.mobilePopup.element.querySelector(".e-control.e-btn").ej2_instances[0];e&&e.destroy(),this.mobilePopup.destroy(),sf.base.remove(this.mobilePopup.element),this.mobilePopup=null}},e.prototype.unWireTouchEvents=function(){this.touchObj&&this.touchObj.destroy(),this.touchObj=null,this.element=null},e.prototype.destroy=function(){this.popupDestroy(),this.unWireTouchEvents(),this.tabHold=!1},e}(),B=function(){function e(e){this.parent=e}return e.prototype.renderSwimlaneHeader=function(){var e;this.parent.isBlazorRender()?e=this.parent.element.querySelector(".e-swimlane-header"):((e=sf.base.createElement("div",{className:"e-swimlane-header"})).innerHTML='<div class="e-swimlane-header-toolbar"><div class="e-toolbar-menu"><div class="e-icons e-icon-menu"></div></div><div class="e-toolbar-level-title"><div class="e-toolbar-swimlane-name"></div></div></div>',this.parent.element.appendChild(e)),sf.base.EventHandler.add(e.querySelector(".e-icon-menu"),"click",this.menuClick,this)},e.prototype.renderSwimlaneTree=function(){var e,t=this.parent.element.querySelector(".e-swimlane-header").offsetHeight,a=window.innerHeight-t;if(this.parent.isBlazorRender())this.popupOverlay=this.parent.element.querySelector(".e-swimlane-content .e-swimlane-overlay"),sf.base.setStyleAttribute(this.parent.element.querySelector(".e-swimlane-overlay"),{height:a+"px"}),sf.base.setStyleAttribute(this.parent.element.querySelector(".e-swimlane-content"),{top:t+"px"}),e=this.parent.element.querySelector(".e-swimlane-resource"),sf.base.setStyleAttribute(e,{height:a+"px"});else{this.popupOverlay=sf.base.createElement("div",{className:"e-swimlane-overlay",styles:"height: "+a+"px;"});var n=sf.base.createElement("div",{className:"e-swimlane-content",styles:"top:"+t+"px;"});e=sf.base.createElement("div",{className:"e-swimlane-resource e-popup-close",styles:"height: "+a+"px;"}),n.appendChild(e),n.appendChild(this.popupOverlay),this.parent.element.appendChild(n);var r=sf.base.createElement("div",{className:"e-swimlane-tree"});e.appendChild(r),this.treeViewObj=new sf.navigations.TreeView({cssClass:this.parent.cssClass,enableRtl:this.parent.enableRtl,fields:{dataSource:this.parent.layoutModule.kanbanRows,id:"keyField",text:"textField"},nodeTemplate:this.parent.swimlaneSettings.template,nodeClicked:this.treeSwimlaneClick.bind(this)}),this.treeViewObj.appendTo(r)}var s={targetType:"relative",actionOnScroll:"none",enableRtl:this.parent.enableRtl,zIndex:10,hideAnimation:{name:"SlideLeftOut",duration:500},showAnimation:{name:"SlideLeftIn",duration:500},viewPortElement:this.parent.element.querySelector("."+x)};this.parent.isBlazorRender()||(s.content=this.treeViewObj.element),this.treePopup=new sf.popups.Popup(e,s)},e.prototype.menuClick=function(e){if(this.parent.element.querySelector(".e-swimlane-resource").classList.contains("e-popup-open"))this.treePopup.hide(),sf.base.removeClass([this.popupOverlay],"e-enable");else{if(!this.parent.isBlazorRender()){var t=[].slice.call(this.treeViewObj.element.querySelectorAll(".e-list-item"));sf.base.removeClass(t,"e-active"),sf.base.addClass([t[this.parent.layoutModule.swimlaneIndex]],"e-active")}this.treePopup.show(),sf.base.addClass([this.popupOverlay],"e-enable")}},e.prototype.treeSwimlaneClick=function(e){this.treePopup.hide();var t=[].slice.call(this.treeViewObj.element.querySelectorAll(".e-list-item"));this.parent.layoutModule.swimlaneIndex=t.indexOf(e.node),this.parent.layoutModule.scrollLeft=0,this.parent.notify(p,{processedData:this.parent.kanbanData}),e.event.preventDefault()},e.prototype.hidePopup=function(){this.treePopup.hide(),sf.base.removeClass([this.popupOverlay],"e-enable")},e.prototype.getWidth=function(){return 80*window.innerWidth/100},e}(),o=function(e,t){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])})(e,t)},H=function(e,t){function a(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)},N=function(e){function t(t){var a=e.call(this,t)||this;return a.kanbanRows=[],a.parent=t,a.columnKeys=[],a.swimlaneIndex=0,a.swimlaneData={},a.scrollLeft=0,a.parent.on(p,a.initRender,a),a.parent.on(c,a.scrollUiUpdate,a),a}return H(t,e),t.prototype.initRender=function(){if(!this.parent.isBlazorRender()){if(0===this.parent.columns.length)return;this.columnData=this.getColumnCards(),this.kanbanRows=this.getRows(),this.swimlaneData=this.getSwimlaneCards()}if(this.parent.isAdaptive){var e=this.parent.element.querySelector("."+x);e&&(this.scrollLeft=e.scrollLeft)}if(this.parent.isBlazorRender()||(this.destroy(),this.parent.on(p,this.initRender,this),this.parent.on(c,this.scrollUiUpdate,this)),this.parent.isAdaptive&&this.parent.swimlaneSettings.keyField&&0!==this.parent.kanbanData.length&&this.renderSwimlaneHeader(),this.parent.isBlazorRender())this.initializeSwimlaneTree();else{var t=sf.base.createElement("div",{className:"e-kanban-header"});this.parent.element.appendChild(t),this.renderHeader(t),this.renderContent(),this.renderCards(),this.renderValidation()}this.parent.notify(c,{}),this.wireEvents()},t.prototype.renderHeader=function(e){var t=sf.base.createElement("div",{className:this.parent.swimlaneSettings.keyField?"e-swimlane":""});e.appendChild(t);var a=sf.base.createElement("table",{className:"e-kanban-table e-header-table",attrs:{role:"presentation"}});t.appendChild(a),this.renderColGroup(a);var n=sf.base.createElement("thead");a.appendChild(n),this.parent.stackedHeaders.length>0&&n.appendChild(this.createStackedRow(this.parent.stackedHeaders));var r=sf.base.createElement("tr",{className:"e-header-row"});n.appendChild(r);for(var s=function(e){if(i.isColumnVisible(e)){var t=i.parent.actionModule.columnToggleArray.indexOf(e.keyField),a=sf.base.createElement("th",{className:-1===t?"e-header-cells":"e-header-cells e-collapsed",attrs:{"data-role":"kanban-column","data-key":e.keyField}}),n=[];e.allowToggle&&(n.push("e-toggle-header"),e.isExpanded||n.push("e-collapsed")),sf.base.addClass([a],n);var s=sf.base.createElement("div",{className:"e-header-wrap"});a.appendChild(s);var o=i.columnData[e.keyField].length,l=sf.base.createElement("div",{className:"e-header-title"});if(s.appendChild(l),e.template){var d={keyField:e.keyField,headerText:e.headerText,minCount:e.minCount,maxCount:e.maxCount,allowToggle:e.allowToggle,isExpanded:e.isExpanded,showItemCount:e.showItemCount,count:o};sf.base.addClass([a],"e-template");var c=i.parent.templateParser(e.template)(d);sf.base.append(c,l)}else{var p=sf.base.createElement("div",{className:"e-header-text",innerHTML:e.headerText});if(l.appendChild(p),e.showItemCount){var h=sf.base.createElement("div",{className:"e-item-count",innerHTML:"- "+o.toString()+" "+i.parent.localeObj.getConstant("items")});l.appendChild(h)}}if(e.allowToggle){var u=!(!e.isExpanded||-1!==t),f=u?"e-column-expand":"e-column-collapse",g=sf.base.createElement("div",{className:"e-header-icon e-icons "+f,attrs:{tabindex:"0"}});g.setAttribute("aria-label",u?e.keyField+" Expand":e.keyField+" Collapse"),a.setAttribute("aria-expanded",u.toString()),s.appendChild(g)}var m={data:[{keyField:e.keyField,textField:e.headerText,count:o}],element:r,cancel:!1,requestType:"headerRow"};i.parent.trigger("queryCellInfo",m,(function(e){e.cancel||r.appendChild(a)}))}},i=this,o=0,l=this.parent.columns;o<l.length;o++)s(l[o])},t.prototype.renderContent=function(){var e=sf.base.createElement("div",{className:x});this.parent.element.appendChild(e);var t=sf.base.createElement("div",{className:this.parent.swimlaneSettings.keyField?"e-swimlane":""});e.appendChild(t);var a=sf.base.createElement("table",{className:"e-kanban-table e-content-table",attrs:{role:"presentation"}});t.appendChild(a),this.renderColGroup(a);var n,r=sf.base.createElement("tbody");a.appendChild(r);var s=!1;this.swimlaneRow=this.kanbanRows,this.initializeSwimlaneTree();for(var i=function(e){if(o.parent.swimlaneSettings.keyField&&0!==o.parent.swimlaneToggleArray.length){var t=o.parent.swimlaneToggleArray.indexOf(e.keyField);s=-1!==t}n=s?"e-content-row e-collapsed":"e-content-row";var a=sf.base.createElement("tr",{className:n,attrs:{"aria-expanded":"true"}});o.parent.swimlaneSettings.keyField&&!o.parent.isAdaptive&&""!==e.keyField&&o.renderSwimlaneRow(r,e,s);for(var i=0,l=o.parent.columns;i<l.length;i++){var d=l[i];if(o.isColumnVisible(d)){var c=-1===(t=o.parent.actionModule.columnToggleArray.indexOf(d.keyField))?"e-content-cells":"e-content-cells e-collapsed",p=sf.base.createElement("td",{className:c,attrs:{"data-role":"kanban-column","data-key":d.keyField,"aria-expanded":"true",tabindex:"0"}});if(d.allowToggle&&!d.isExpanded||-1!==t){sf.base.addClass([p],"e-collapsed");var h=(d.showItemCount?"["+o.getColumnData(d.keyField,o.swimlaneData[e.keyField]).length+"] ":"")+d.headerText;p.appendChild(sf.base.createElement("div",{className:"e-collapse-header-text",innerHTML:h})),p.setAttribute("aria-expanded","false")}if(d.showAddButton){var u=sf.base.createElement("div",{className:M,attrs:{tabindex:"-1"}});u.appendChild(sf.base.createElement("div",{className:"e-show-add-icon e-icons"})),p.appendChild(u)}a.appendChild(p)}}var f={data:[{keyField:e.keyField,textField:e.textField,count:e.count}],element:a,cancel:!1,requestType:"contentRow"};o.parent.trigger("queryCellInfo",f,(function(e){e.cancel||r.appendChild(a)}))},o=this,l=0,d=this.swimlaneRow;l<d.length;l++)i(d[l])},t.prototype.initializeSwimlaneTree=function(){this.parent.swimlaneSettings.keyField&&this.parent.isAdaptive&&0!==this.parent.kanbanData.length&&(this.parent.isBlazorRender()?this.renderSwimlaneTree():(this.swimlaneRow=[this.kanbanRows[this.swimlaneIndex]],this.renderSwimlaneTree(),this.parent.element.querySelector(".e-toolbar-swimlane-name").innerHTML=this.swimlaneRow[0].textField))},t.prototype.renderSwimlaneRow=function(e,t,a){var n=a?" e-collapsed":"",r=sf.base.createElement("tr",{className:"e-content-row e-swimlane-row"+n,attrs:{"data-key":t.keyField,"aria-expanded":(!a).toString()}}),s=this.parent.columns.length-this.parent.actionModule.hideColumnKeys.length,i=sf.base.createElement("td",{className:"e-content-cells",attrs:{"data-role":"kanban-column",colspan:s.toString()}}),o=sf.base.createElement("div",{className:"e-swimlane-header"});i.appendChild(o);var l=a?"e-swimlane-row-collapse":"e-swimlane-row-expand",d=sf.base.createElement("div",{className:"e-icons "+l,attrs:{tabindex:"0","aria-label":a?t.keyField+" Collapse":t.keyField+" Expand"}});o.appendChild(d);var c=sf.base.createElement("div",{className:"e-header-wrap"});o.appendChild(c);var p=this.swimlaneData[t.keyField].length;if(this.parent.swimlaneSettings.template){var h=sf.base.extend({},t,{count:p},!0);sf.base.addClass([i],"e-template");var u=this.parent.templateParser(this.parent.swimlaneSettings.template)(h);sf.base.append(u,c)}else c.appendChild(sf.base.createElement("div",{className:"e-swimlane-text",innerHTML:t.textField,attrs:{"data-role":t.textField}}));this.parent.swimlaneSettings.showItemCount&&o.appendChild(sf.base.createElement("div",{className:"e-item-count",innerHTML:"- "+p.toString()+" "+this.parent.localeObj.getConstant("items")})),r.appendChild(i);var f={data:[{keyField:t.keyField,textField:t.textField,count:t.count}],element:r,cancel:!1,requestType:"swimlaneRow"};this.parent.trigger("queryCellInfo",f,(function(t){t.cancel||e.appendChild(r)}))},t.prototype.renderCards=function(){var e=this,t=this.swimlaneRow,a=[].slice.call(this.parent.element.querySelectorAll(".e-content-row:not(.e-swimlane-row)")),n=[].slice.call(this.parent.element.querySelectorAll(".e-content-row.e-swimlane-row")),r=[];a.forEach((function(a,s){for(var i=0,o=function(n){if(e.isColumnVisible(n)){var r=e.parent.swimlaneSettings.keyField?e.getColumnData(n.keyField,e.swimlaneData[t[s].keyField]):e.columnData[n.keyField];i+=r.length;var o=a.querySelector('[data-key="'+n.keyField+'"]'),l=sf.base.createElement("div",{className:"e-card-wrapper"});o.appendChild(l);for(var d=function(t){var a=t[e.parent.cardSettings.headerField],n=e.parent.actionModule.selectionArray.indexOf(a),r=-1===n?"":" e-selection",s=sf.base.createElement("div",{className:"e-card"+r,attrs:{"data-id":t[e.parent.cardSettings.headerField],"data-key":t[e.parent.keyField],"aria-selected":"false",tabindex:"-1"}});if(-1!==n&&s.setAttribute("aria-selected","true"),e.parent.cardSettings.template){sf.base.addClass([s],"e-template");var i=e.parent.templateParser(e.parent.cardSettings.template)(t);sf.base.append(i,s)}else{var o=e.parent.enableTooltip?" e-tooltip-text":"";if(e.parent.cardSettings.showHeader){var d=sf.base.createElement("div",{className:"e-card-header"}),c=sf.base.createElement("div",{className:"e-card-header-caption"}),p=sf.base.createElement("div",{className:"e-card-header-title"+o,innerHTML:t[e.parent.cardSettings.headerField]||""});d.appendChild(c),c.appendChild(p),s.appendChild(d)}var h=sf.base.createElement("div",{className:"e-card-content"+o,innerHTML:t[e.parent.cardSettings.contentField]||""});if(s.appendChild(h),e.parent.cardSettings.tagsField&&t[e.parent.cardSettings.tagsField]){for(var u=sf.base.createElement("div",{className:"e-card-tags"}),f=0,g=t[e.parent.cardSettings.tagsField].toString().split(",");f<g.length;f++){var m=g[f];u.appendChild(sf.base.createElement("div",{className:"e-card-tag e-card-label",innerHTML:m}))}s.appendChild(u)}if(e.parent.cardSettings.grabberField&&t[e.parent.cardSettings.grabberField]&&(sf.base.addClass([s],"e-card-color"),s.style.borderLeftColor=t[e.parent.cardSettings.grabberField]),e.parent.cardSettings.footerCssField){for(var y=sf.base.createElement("div",{className:"e-card-footer"}),b=0,v=t[e.parent.cardSettings.footerCssField].split(",");b<v.length;b++){var C=v[b];y.appendChild(sf.base.createElement("div",{className:C.trim()+" e-card-footer-css"}))}s.appendChild(y)}}var w={data:t,element:s,cancel:!1};e.parent.trigger("cardRendered",w,(function(e){e.cancel||l.appendChild(s)}))},c=0,p=r;c<p.length;c++)d(p[c])}},l=0,d=e.parent.columns;l<d.length;l++)o(d[l]);0===i&&(r.push(a),n.length>0&&r.push(n[s]))})),this.parent.swimlaneSettings.showEmptyRow||0!==this.parent.kanbanData.length||this.parent.showEmptyColumn||r.forEach((function(e){return sf.base.remove(e)}))},t.prototype.renderColGroup=function(e){var t=this,a=sf.base.createElement("colgroup");this.parent.columns.forEach((function(e){if(t.isColumnVisible(e)){var n=t.parent.actionModule.columnToggleArray.indexOf(e.keyField),r=e.allowToggle&&!e.isExpanded,s=-1===n?r?"e-collapsed":"":"e-collapsed",i=sf.base.createElement("col",{className:s,attrs:{"data-key":e.keyField},styles:t.parent.isAdaptive?"width: "+(r?sf.base.formatUnit(50):sf.base.formatUnit(t.getWidth())):""});a.appendChild(i)}})),e.appendChild(a)},t.prototype.getRows=function(){var e=this,t=[];return this.parent.swimlaneSettings.keyField?(this.parent.kanbanData.map((function(a){(e.parent.swimlaneSettings.showEmptyRow||-1!==e.columnKeys.indexOf(a[e.parent.keyField]))&&t.push({keyField:a[e.parent.swimlaneSettings.keyField],textField:a[e.parent.swimlaneSettings.textField]||a[e.parent.swimlaneSettings.keyField]})})),(t=t.filter((function(e,t,a){return t===a.map((function(e){return e.keyField})).indexOf(e.keyField)}))).sort((function(e,t){var a=e.textField.toLowerCase(),n=t.textField.toLowerCase();return a>n?1:n>a?-1:0})),"Descending"===this.parent.swimlaneSettings.sortDirection&&t.reverse(),t.forEach((function(t){t.count=e.parent.kanbanData.filter((function(a){return e.columnKeys.indexOf(a[e.parent.keyField])>-1&&a[e.parent.swimlaneSettings.keyField]===t.keyField})).length})),0===t.length&&t.push({keyField:"",textField:""})):t.push({keyField:"",textField:""}),t},t.prototype.createStackedRow=function(e){var t=sf.base.createElement("tr",{className:"e-header-row e-stacked-header-row"}),a=[];this.parent.columns.forEach((function(t){for(var n="",r=0,s=e;r<s.length;r++){var i=s[r];-1!==i.keyFields.indexOf(t.keyField)&&(n=i.text)}a.push(n)}));for(var n=0;n<a.length;n++){for(var r=1,s=n+1;s<a.length&&""!==a[n]&&""!==a[s]&&a[n]===a[s];s++)r++;var i=sf.base.createElement("div",{className:"e-header-text",innerHTML:a[n]}),o=sf.base.createElement("th",{className:"e-header-cells e-stacked-header-cell",attrs:{colspan:r.toString()}});t.appendChild(o).appendChild(i),n+=r-1}return t},t.prototype.scrollUiUpdate=function(){var e=this,t=this.parent.element.querySelector(".e-kanban-header"),a=this.parent.element.querySelector("."+x),n=this.parent.element.offsetHeight-t.offsetHeight;if(this.parent.isAdaptive){n=window.innerHeight-(t.offsetHeight+25);var r=this.parent.element.querySelector(".e-swimlane-header");r&&(n-=r.offsetHeight),[].slice.call(this.parent.element.querySelectorAll(".e-content-cells")).forEach((function(t){var a=t.querySelector(".e-card-wrapper");a.classList.contains("e-multi-card-wrapper")||(a.style.height=sf.base.formatUnit(n),sf.base.EventHandler.add(t,"touchmove",e.onAdaptiveScroll,e))}))}"auto"!==this.parent.height&&"100%"!==this.parent.height&&(a.style.height=sf.base.formatUnit(n)),[].slice.call(t.children).forEach((function(t){var n=0;a.offsetWidth-a.clientWidth>0&&(n=17,a.offsetHeight-a.clientHeight>0&&(t.style.width=sf.base.formatUnit(a.clientWidth))),e.parent.enableRtl?t.style.paddingLeft=sf.base.formatUnit(n):t.style.paddingRight=sf.base.formatUnit(n)}))},t.prototype.onContentScroll=function(e){this.parent.element.querySelector(".e-kanban-header div").scrollLeft=e.target.scrollLeft},t.prototype.onAdaptiveScroll=function(e){this.parent.touchModule.tabHold&&!this.parent.touchModule.mobilePopup&&e.preventDefault()},t.prototype.isColumnVisible=function(e){var t=this,a=!1;return e.keyField.split(",").forEach((function(e){a=-1===t.parent.actionModule.hideColumnKeys.indexOf(e)})),a},t.prototype.renderLimits=function(e,t){var a=sf.base.createElement("div",{className:"e-limits"});e.minCount&&a.appendChild(sf.base.createElement("div",{className:"e-min-count",innerHTML:this.parent.localeObj.getConstant("min")+": "+e.minCount.toString()})),e.maxCount&&a.appendChild(sf.base.createElement("div",{className:"e-max-count",innerHTML:this.parent.localeObj.getConstant("max")+": "+e.maxCount.toString()})),a.childElementCount>0&&(t.querySelector(".e-card-wrapper")?t.insertBefore(a,t.firstElementChild):t.appendChild(a))},t.prototype.renderValidation=function(){var e=this,t=function(e,t){var a;return e.maxCount&&t>e.maxCount?a="e-max-color":e.minCount&&t<e.minCount&&(a="e-min-color"),a};this.parent.columns.forEach((function(a){if(a.minCount||a.maxCount){var n=e.columnData[a.keyField],r='[data-key="'+a.keyField+'"]',s=e.parent.element.querySelector(".e-header-cells"+r),i=[].slice.call(e.parent.element.querySelectorAll(".e-content-cells"+r));if("Swimlane"===e.parent.constraintType&&e.parent.swimlaneSettings.keyField)e.swimlaneRow.forEach((function(r,s){e.renderLimits(a,i[s]);var o=n.filter((function(t){return t[e.parent.swimlaneSettings.keyField]===r.keyField})),l=t(a,o.length);l&&sf.base.addClass([i[s]],l)}));else{e.renderLimits(a,s);var o=t(a,n.length);o&&sf.base.addClass(i.concat(s),o)}}}))},t.prototype.getColumnData=function(e,t){var a=this;void 0===t&&(t=this.parent.kanbanData);for(var n=[],r=function(e){var r=t.filter((function(t){return t[a.parent.keyField]===e.trim()}));n=n.concat(r)},s=0,i=e.split(",");s<i.length;s++)r(i[s]);return this.sortCategory(n),n},t.prototype.sortCategory=function(e){var t,a=this.parent.sortSettings.direction;switch(this.parent.sortSettings.sortBy){case"DataSourceOrder":"Descending"===a&&e.reverse();break;case"Custom":case"Index":this.parent.sortSettings.field&&(t=this.parent.sortSettings.field,"Custom"===this.parent.sortSettings.sortBy&&(a=this.parent.sortSettings.direction),this.sortOrder(t,a,e))}return e},t.prototype.sortOrder=function(e,t,a){var n,r,s;return(n=!(this.parent.kanbanData.length>0)||"number"==typeof this.parent.kanbanData[0][e])||"Index"!==this.parent.sortSettings.sortBy?(a=a.sort((function(t,a){return n?(r=t[e],s=a[e]):(r=t[e].toLowerCase(),s=a[e].toLowerCase()),r>s?1:s>r?-1:0})),"Descending"===t&&a.reverse(),a):a},t.prototype.documentClick=function(e){if(e.target.classList.contains("e-swimlane-overlay")&&this.parent.element.querySelector(".e-swimlane-resource").classList.contains("e-popup-open")&&(this.treePopup.hide(),sf.base.removeClass([this.popupOverlay],"e-enable")),!sf.base.closest(e.target,".e-kanban")){var t=[].slice.call(this.parent.element.querySelectorAll(".e-card.e-selection"));sf.base.removeClass(t,"e-selection"),this.disableAttributeSelection(t)}},t.prototype.disableAttributeSelection=function(e){e instanceof Element?e.setAttribute("aria-selected","false"):e.forEach((function(e){e.setAttribute("aria-selected","false")}))},t.prototype.getColumnCards=function(e){var t=this,a={};return this.columnKeys=[],this.parent.columns.forEach((function(n){t.columnKeys=t.columnKeys.concat(n.keyField.split(",").map((function(e){return e.trim()})));var r=t.getColumnData(n.keyField,e);a[n.keyField]=r})),a},t.prototype.getSwimlaneCards=function(){var e=this,t={};return this.parent.swimlaneSettings.keyField&&this.kanbanRows.forEach((function(a){return t[a.keyField]=e.parent.kanbanData.filter((function(t){return e.columnKeys.indexOf(t[e.parent.keyField])>-1&&t[e.parent.swimlaneSettings.keyField]===a.keyField}))})),t},t.prototype.refreshHeaders=function(){var e=this.parent.element.querySelector(".e-kanban-header");[].slice.call(e.children).forEach((function(e){return sf.base.remove(e)})),this.renderHeader(e)},t.prototype.refreshCards=function(){[].slice.call(this.parent.element.querySelectorAll(".e-card-wrapper")).forEach((function(e){return sf.base.remove(e)})),this.renderCards()},t.prototype.wireEvents=function(){sf.base.EventHandler.add(this.parent.element,"click",this.parent.actionModule.clickHandler,this.parent.actionModule),sf.base.EventHandler.add(this.parent.element,"dblclick",this.parent.actionModule.doubleClickHandler,this.parent.actionModule),sf.base.EventHandler.add(document,sf.base.Browser.touchStartEvent,this.documentClick,this);var e=this.parent.element.querySelector("."+x);sf.base.EventHandler.add(e,"scroll",this.onContentScroll,this),this.parent.isAdaptive&&(this.parent.touchModule.wireTouchEvents(),e.scrollLeft=this.scrollLeft),this.wireDragEvent()},t.prototype.unWireEvents=function(){sf.base.EventHandler.remove(this.parent.element,"click",this.parent.actionModule.clickHandler),sf.base.EventHandler.remove(this.parent.element,"dblclick",this.parent.actionModule.doubleClickHandler),sf.base.EventHandler.remove(document,sf.base.Browser.touchStartEvent,this.documentClick);var e=this.parent.element.querySelector("."+x);e&&(sf.base.EventHandler.remove(e,"scroll",this.onContentScroll),this.parent.allowDragAndDrop&&this.unWireDragEvent()),this.parent.isAdaptive&&this.parent.touchModule.unWireTouchEvents()},t.prototype.wireDragEvent=function(){this.parent.allowDragAndDrop&&(sf.base.addClass(this.parent.element.querySelectorAll(".e-card"),"e-draggable"),this.parent.dragAndDropModule.wireDragEvents(this.parent.element.querySelector("."+x)))},t.prototype.unWireDragEvent=function(){this.parent.dragAndDropModule.unWireDragEvents(this.parent.element.querySelector("."+x))},t.prototype.destroy=function(){this.parent.off(p,this.initRender),this.parent.off(c,this.scrollUiUpdate),this.unWireEvents();var e=this.parent.element.querySelector(".e-kanban-header");e&&sf.base.remove(e);var t=this.parent.element.querySelector("."+x);t&&sf.base.remove(t),this.treeViewObj&&(this.treeViewObj.destroy(),this.treeViewObj=null),this.treePopup&&(this.treePopup.destroy(),this.treePopup=null);var a=this.parent.element.querySelector(".e-swimlane-header");a&&sf.base.remove(a);var n=this.parent.element.querySelector(".e-swimlane-content");n&&sf.base.remove(n)},t}(B),l=function(e,t){return(l=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])})(e,t)},_=function(e,t){function a(){this.constructor=e}l(e,t),e.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)},I=function(e,t,a,n){var s,i=arguments.length,o=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"===("undefined"==typeof Reflect?"undefined":r()(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,a,n);else for(var l=e.length-1;l>=0;l--)(s=e[l])&&(o=(i<3?s(o):i>3?s(t,a,o):s(t,a))||o);return i>3&&o&&Object.defineProperty(t,a,o),o},z=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return _(t,e),I([sf.base.Property("DataSourceOrder")],t.prototype,"sortBy",void 0),I([sf.base.Property()],t.prototype,"field",void 0),I([sf.base.Property("Ascending")],t.prototype,"direction",void 0),t}(sf.base.ChildProperty),d=function(e,t){return(d=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])})(e,t)},U=function(e,t){function a(){this.constructor=e}d(e,t),e.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)},K=function(e,t,a,n){var s,i=arguments.length,o=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,a):n;if("object"===("undefined"==typeof Reflect?"undefined":r()(Reflect))&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,a,n);else for(var l=e.length-1;l>=0;l--)(s=e[l])&&(o=(i<3?s(o):i>3?s(t,a,o):s(t,a))||o);return i>3&&o&&Object.defineProperty(t,a,o),o},W=function(e){function t(t,a){return e.call(this,t,a)||this}return U(t,e),t.prototype.preRender=function(){this.isAdaptive=sf.base.Browser.isDevice,this.kanbanData=[],this.enablePersistence&&this.swimlaneToggleArray||(this.swimlaneToggleArray=[]),this.activeCardData={data:null,element:null},this.isBlazorRender()||(this.localeObj=new sf.base.L10n(this.getModuleName(),{items:"items",min:"Min",max:"Max",cardsSelected:"Cards Selected",addTitle:"Add New Card",editTitle:"Edit Card Details",deleteTitle:"Delete Card",deleteContent:"Are you sure you want to delete this card?",save:"Save",delete:"Delete",cancel:"Cancel",yes:"Yes",no:"No",close:"Close"},this.locale))},t.prototype.requiredModules=function(){return[]},t.prototype.getPersistData=function(){return this.addOnPersist(["columns","dataSource","swimlaneToggleArray"])},t.prototype.getModuleName=function(){return"kanban"},t.prototype.render=function(){if(!this.isBlazorRender()){var e=["e-kanban"],t=[];this.enableRtl?e.push("e-rtl"):t.push("e-rtl"),this.isAdaptive?e.push("e-device"):t.push("e-device"),this.cssClass&&e.push(this.cssClass),this.element.setAttribute("role","main"),sf.base.classList(this.element,e,t)}this.element.style.width=sf.base.formatUnit(this.width),this.element.style.height=sf.base.formatUnit(this.height),sf.popups.createSpinner({target:this.element}),this.showSpinner(),this.initializeModules()},t.prototype.onPropertyChanged=function(e,t){for(var a=0,n=Object.keys(e);a<n.length;a++)switch(n[a]){case"cssClass":t.cssClass&&sf.base.removeClass([this.element],t.cssClass),e.cssClass&&sf.base.addClass([this.element],e.cssClass);break;case"enableRtl":case"locale":this.isBlazorRender()||this.refresh();break;case"width":this.element.style.width=sf.base.formatUnit(e.width),this.element.querySelector(".e-kanban-header").firstElementChild.style.width="auto",this.notify(c,{});break;case"height":this.element.style.height=sf.base.formatUnit(e.height),this.element.querySelector("."+x).style.height="auto",this.notify(c,{});break;case"dataSource":case"query":this.isBlazorRender()||(this.dataModule=new h(this));break;case"columns":case"constraintType":this.isBlazorRender()?this.notifyChange():this.notify(p,{processedData:this.kanbanData});break;case"swimlaneSettings":this.onSwimlaneSettingsPropertyChanged(e.swimlaneSettings,t.swimlaneSettings);break;case"cardSettings":this.onCardSettingsPropertyChanged(e.cardSettings,t.cardSettings);break;case"allowDragAndDrop":e.allowDragAndDrop?this.layoutModule.wireDragEvent():this.layoutModule.unWireDragEvent();break;case"enableTooltip":this.tooltipModule&&(this.tooltipModule.destroy(),this.tooltipModule=null),e.enableTooltip&&(this.tooltipModule=new P(this),this.isBlazorRender()||this.layoutModule.refreshCards());break;case"dialogSettings":e.dialogSettings&&(this.dialogModule=new F(this));break;case"allowKeyboard":this.keyboardModule&&(this.keyboardModule.destroy(),this.keyboardModule=null),e.allowKeyboard&&(this.keyboardModule=new q(this));break;case"stackedHeaders":this.isBlazorRender()?this.notifyChange():this.layoutModule.refreshHeaders();break;case"sortSettings":this.notify(p,{processedData:this.kanbanData})}},t.prototype.onSwimlaneSettingsPropertyChanged=function(e,t){for(var a=0,n=Object.keys(e);a<n.length;a++)switch(n[a]){case"keyField":case"textField":case"showEmptyRow":case"showItemCount":case"template":case"sortDirection":this.isBlazorRender()?this.notifyChange():this.notify(p,{processedData:this.kanbanData})}},t.prototype.onCardSettingsPropertyChanged=function(e,t){for(var a=0,n=Object.keys(e);a<n.length;a++)switch(n[a]){case"showHeader":case"headerField":case"contentField":case"template":case"tagsField":case"grabberField":case"footerCssField":this.isBlazorRender()?this.notifyChange():this.layoutModule.refreshCards();break;case"selectionType":var r=this.getSelectedCards();r.length>0&&(sf.base.removeClass(r,"e-selection"),this.layoutModule.disableAttributeSelection(r))}},t.prototype.initializeModules=function(){this.isBlazorRender()||(this.dataModule=new h(this)),this.layoutModule=new N(this),this.allowKeyboard&&(this.keyboardModule=new q(this)),this.actionModule=new R(this),this.crudModule=new j(this),this.dragAndDropModule=new T(this),this.dialogModule=new F(this),this.enableTooltip&&(this.tooltipModule=new P(this)),(sf.base.Browser.isDevice||sf.base.Browser.isTouch)&&(this.touchModule=new L(this))},t.prototype.notifyChange=function(){this.interopAdaptor.invokeMethodAsync("PropertyChanged")},t.prototype.isDevice=function(e){sf.base.Browser.isDevice&&sf.base.isBlazor()&&e&&e.invokeMethodAsync("IsDevice",!0,80*window.innerWidth/100)},t.prototype.isBlazorRender=function(){return sf.base.isBlazor()&&this.isServerRendered},t.prototype.updateDataSource=function(e){this.kanbanData=e.Result},t.prototype.hideDeviceMenu=function(){this.layoutModule.hidePopup()},t.prototype.dataReady=function(e){this.kanbanData=e.Result,this.hideSpinner(),this.notify(p,{processedData:{}})},t.prototype.destroyModules=function(){this.layoutModule&&(this.layoutModule.destroy(),this.layoutModule=null),this.keyboardModule&&(this.keyboardModule.destroy(),this.keyboardModule=null),this.touchModule&&(this.touchModule.destroy(),this.touchModule=null),this.dialogModule=null,this.actionModule=null,this.crudModule=null,this.dataModule=null,this.dragAndDropModule=null},t.prototype.templateParser=function(e){if(e)try{if(document.querySelectorAll(e).length)return sf.base.compile(document.querySelector(e).innerHTML.trim())}catch(t){return sf.base.compile(e)}},t.prototype.getCardDetails=function(e){var t=this,a="number"==typeof this.kanbanData[0][this.cardSettings.headerField]?parseInt(e.getAttribute("data-id"),10):e.getAttribute("data-id");return this.kanbanData.filter((function(e){return e[t.cardSettings.headerField]===a}))[0]},t.prototype.getColumnData=function(e,t){return this.layoutModule.getColumnCards(t)[e]||[]},t.prototype.getSwimlaneData=function(e){return this.layoutModule.getSwimlaneCards()[e]||[]},t.prototype.getSelectedCards=function(){return[].slice.call(this.element.querySelectorAll(".e-card.e-selection"))},t.prototype.showSpinner=function(){sf.popups.showSpinner(this.element)},t.prototype.hideSpinner=function(){sf.popups.hideSpinner(this.element)},t.prototype.openDialog=function(e,t){this.dialogModule.openDialog(e,t)},t.prototype.closeDialog=function(){this.dialogModule.closeDialog()},t.prototype.addCard=function(e){this.crudModule.addCard(e)},t.prototype.updateCard=function(e){this.crudModule.updateCard(e)},t.prototype.deleteCard=function(e){this.crudModule.deleteCard(e)},t.prototype.addColumn=function(e,t){this.actionModule.addColumn(e,t)},t.prototype.deleteColumn=function(e){this.actionModule.deleteColumn(e)},t.prototype.showColumn=function(e){this.actionModule.showColumn(e)},t.prototype.hideColumn=function(e){this.actionModule.hideColumn(e)},t.prototype.destroy=function(){this.destroyModules(),this.isBlazorRender()||[].slice.call(this.element.childNodes).forEach((function(e){return sf.base.detach(e)}));var t=["e-kanban"];this.cssClass&&(t=t.concat(this.cssClass.split(" "))),sf.base.removeClass([this.element],t),this.isBlazorRender()||e.prototype.destroy.call(this)},K([sf.base.Property()],t.prototype,"cssClass",void 0),K([sf.base.Property("auto")],t.prototype,"width",void 0),K([sf.base.Property("auto")],t.prototype,"height",void 0),K([sf.base.Property([])],t.prototype,"dataSource",void 0),K([sf.base.Property()],t.prototype,"query",void 0),K([sf.base.Property()],t.prototype,"keyField",void 0),K([sf.base.Property("Column")],t.prototype,"constraintType",void 0),K([sf.base.Collection([],k)],t.prototype,"columns",void 0),K([sf.base.Property(!0)],t.prototype,"allowKeyboard",void 0),K([sf.base.Collection([],A)],t.prototype,"stackedHeaders",void 0),K([sf.base.Complex({},g)],t.prototype,"swimlaneSettings",void 0),K([sf.base.Complex({},b)],t.prototype,"cardSettings",void 0),K([sf.base.Complex({},z)],t.prototype,"sortSettings",void 0),K([sf.base.Complex({},w)],t.prototype,"dialogSettings",void 0),K([sf.base.Property(!0)],t.prototype,"allowDragAndDrop",void 0),K([sf.base.Property(!1)],t.prototype,"enableTooltip",void 0),K([sf.base.Property(!1)],t.prototype,"showEmptyColumn",void 0),K([sf.base.Property(!1)],t.prototype,"enablePersistence",void 0),K([sf.base.Property()],t.prototype,"tooltipTemplate",void 0),K([sf.base.Event()],t.prototype,"actionBegin",void 0),K([sf.base.Event()],t.prototype,"actionComplete",void 0),K([sf.base.Event()],t.prototype,"actionFailure",void 0),K([sf.base.Event()],t.prototype,"created",void 0),K([sf.base.Event()],t.prototype,"dataBinding",void 0),K([sf.base.Event()],t.prototype,"dataBound",void 0),K([sf.base.Event()],t.prototype,"cardClick",void 0),K([sf.base.Event()],t.prototype,"cardDoubleClick",void 0),K([sf.base.Event()],t.prototype,"queryCellInfo",void 0),K([sf.base.Event()],t.prototype,"cardRendered",void 0),K([sf.base.Event()],t.prototype,"dragStart",void 0),K([sf.base.Event()],t.prototype,"drag",void 0),K([sf.base.Event()],t.prototype,"dragStop",void 0),K([sf.base.Event()],t.prototype,"dialogOpen",void 0),K([sf.base.Event()],t.prototype,"dialogClose",void 0),t=K([sf.base.NotifyPropertyChanges],t)}(sf.base.Component),e.Kanban=W,e.actionBegin="actionBegin",e.actionComplete="actionComplete",e.actionFailure="actionFailure",e.cardClick="cardClick",e.cardDoubleClick="cardDoubleClick",e.cardRendered="cardRendered",e.queryCellInfo="queryCellInfo",e.dataBinding="dataBinding",e.dataBound="dataBound",e.dragStart="dragStart",e.drag="drag",e.dragStop="dragStop",e.documentClick="document-click",e.dialogOpen="dialogOpen",e.dialogClose="dialogClose",e.contentReady=c,e.dataReady=p,e.bottomSpace=25,e.cardSpace=16,e.toggleWidth=50,e))}))}}]);